<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Ù…Ø³ØªÙ†Ø¯ Ø¹Ø±Ø¨ÙŠ Ø¨Ù†Ù…Ø· Word</title>
  <style>
    :root {
      --page-width: 210mm;
      --page-height: 297mm;
      --page-margin: 25mm;
      --font: "Times New Roman", "Amiri", serif;
    }

    html, body {
      height: 100%;
      margin: 0;
      background: #e0e0e0;
      font-family: var(--font);
    }

    .toolbar {
      background: #f3f3f3;
      padding: 10px 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.15);
      display: flex;
      justify-content: flex-start;
      gap: 8px;
      direction: ltr;
    }

    .btn {
      background: white;
      border: 1px solid #bbb;
      border-radius: 4px;
      padding: 6px 12px;
      cursor: pointer;
      font-size: 14px;
    }

    .workspace {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px;
    }

    .page {
      width: var(--page-width);
      height: var(--page-height);
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      padding: var(--page-margin);
      box-sizing: border-box;
      overflow: auto;
      direction: rtl;
      text-align: justify;
      line-height: 1.7;
    }

    .page h1 { font-size: 22px; margin-bottom: 10px; }
    .page h2 { font-size: 18px; margin-top: 20px; }
    .page p  { font-size: 16px; margin: 8px 0; }

    @media print {
      html, body { background: white; }
      .toolbar { display: none; }
      @page { size: A4; margin: 0; }
      .page { box-shadow: none; }
    }
  </style>
</head>
<body>
<div class="toolbar">
  <button class="btn" id="downloadDocx">ğŸ“„ ØªØ­Ù…ÙŠÙ„ ÙƒÙ€ DOCX</button>
</div>

<div class="workspace">
  <div class="page" id="docContent" contenteditable="true">
    <h1>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</h1>
    <p>Ù‡Ø°Ø§ Ù†Øµ Ø¹Ø±Ø¨ÙŠ ØªØ¬Ø±ÙŠØ¨ÙŠ ÙÙŠ ØµÙØ­Ø© Ø¨Ø­Ø¬Ù… A4 ØªØ­Ø§ÙƒÙŠ Ù…Ø¸Ù‡Ø± Ù…Ø³ØªÙ†Ø¯ ÙˆÙˆØ±Ø¯. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ø«Ù… Ø­ÙØ¸Ù‡ ÙƒÙ…Ù„Ù DOCX.</p>
    <h2>ÙÙ‚Ø±Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</h2>
    <p>ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© ÙÙ‚Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ù‚ÙˆØ§Ø¦Ù… Ù‡Ù†Ø§ Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ø±Ø¨ÙŠ ÙˆØ§Ù„Ø§ØªØ¬Ø§Ù‡ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±.</p>
  </div>
</div>

<!-- Use your local copies -->
<script src="../../plugins/html-docx-js/html-docx.js"></script>
<script src="../../plugins/FileSaver/FileSaver.min.js"></script>

<script>
  function wrapForDocx(inner) {
    return `
        <!DOCTYPE html>
        <html lang=\"ar\" dir=\"rtl\">
          <head>
            <meta charset=\"utf-8\">
            <style>
              body { font-family: 'Times New Roman', 'Amiri', serif; direction: rtl; text-align: justify; }
            </style>
          </head>
          <body>${inner}</body>
        </html>`;
  }

  document.getElementById('downloadDocx').addEventListener('click', function() {
    const content = document.getElementById('docContent').innerHTML;
    const fullHtml = wrapForDocx(content);

    // Convert HTML to .docx Blob
    const blob = window.htmlDocx.asBlob(fullHtml, { orientation: 'portrait' });

    // Save the file
    window.saveAs(blob, 'document.docx');
  });
</script>
</body>
</html>
