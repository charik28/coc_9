<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Coc BRQ Report</title>
  <link rel="stylesheet" href="../../dist/global.css">

</head>
<body>
<div class="toolbar">
  <button class="btn" id="downloadDocx">📄 تحميل كـ DOCX</button>
  <button class="btn" id="btnCopie">نسخ</button>
</div>

<div class="workspace">
  <div class="page" id="docContent" contenteditable="true">
    <div class='container'>
      <div style='text-align: center'>
        <h4>الجمهورية الجزائرية الديمقراطية الشعبية</h4>
        <h4>وزارة المالية</h4>
        <h4>المديرية العامة للجمارك</h4>
        <h4>مديرية الأمن والنشاط العملياتي للفرق</h4>
        <h3>كشف الاستعلامات اليومي</h3>
        <div style="text-align: left">

          <h5>الجزائر، في:

          </h5>

        </div>

        <div class='section'>
          <div >
           جاري التحميل، يرجى الانتظار...
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Use your local copies -->
<script src="../../dist/html-docx.js"></script>
<script src="../../dist/FileSaver.min.js"></script>
<script src="../../dist/rendre-report.js"></script>

<script>
  function wrapForDocx(inner) {
    return `
        <!DOCTYPE html>
        <html lang=\"ar\" dir=\"rtl\">
          <head>
            <meta charset=\"utf-8\">
            <style>
              body { font-family: 'Times New Roman', 'Amiri', serif; direction: rtl; text-align: justify; }
            </style>
          </head>
          <body>${inner}</body>
        </html>`;
  }

  document.getElementById('downloadDocx').addEventListener('click', function() {
    const content = document.getElementById('docContent').innerHTML;
    const fullHtml = wrapForDocx(content);

    // Convert HTML to .docx Blob
    const blob = window.htmlDocx.asBlob(fullHtml, { orientation: 'portrait' });

    // Save the file
    window.saveAs(blob, 'document.docx');
  });
</script>
</body>
</html>
