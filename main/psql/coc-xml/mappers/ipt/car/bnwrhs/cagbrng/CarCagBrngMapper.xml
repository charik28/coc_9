<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper">
  <!-- 보세구역 : 반입 /반출 업무  (By Haechul.shin on 14/10/2022) -->

  <!-- ###################### 0103, 0111 ####################### -->

  <!--
    [Rechercher] Consulter la liste des "Demande d'accord préalable de l'exploitation de la zone sous douane"
    !== TB_CARI_RLBR 반입 / 반출 (신청) 신고 목록 조회 ==!
    -->
	<select id="selectCarBnwrhsCagBrngRlbrList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
    /* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCarBnwrhsCagBrngRlbrList */
    <include refid="pagination.header" ></include>
		SELECT
	          A.RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
			, A.RLBR_TP_CD															/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
			, A.JRSD_ORGN_CD														/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			, (SELECT ORGN_NM    /** Service compétent !== 관할조직 ==! */
				 FROM TB_POTI_ORGN
				WHERE ORGN_CD = A.JRSD_ORGN_CD) AS JRSD_ORGN_NM
			, TO_CHAR(A.RLBR_DTTM, 'DD/MM/YYYY') AS RLBR_DTTM						/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
			, A.IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		    , (SELECT IBOBZ_NM  /* Nom de la zone sous douane !== 보세구역명 ==! */
			       FROM TB_CARI_IBOBZ
			      WHERE DEL_YN = 'N'
			        AND IBOBZ_CD = A.IBOBZ_CD) AS IBOBZ_NM
			, A.RLBR_PT_CD															/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
			, A.CAG_MGMT_NO															/**  Crn  										!== 화물관리번호 ==!  */
			, A.BL_NO																/**  N° De Bl 								 	!== BL번호 ==!  */
			, A.RLBR_PCKG_GCNT														/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			, A.RLBR_WGHT															/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
	        , A.DIVD_TP_CD															/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			, A.BRNG_ACDN_PT_CD														/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			, A.BRNG_ACDN_GCNT														/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
			, A.BRNG_ACDN_WGHT														/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			, TO_CHAR(A.trsn_dttm, 'DD/MM/YYYY') AS TRSN_DTTM			            /**  Date et heure de transmission  			!== 전송일시 ==!  */
			, A.TRSN_CO_CD															/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
			, A.DEL_YN																/**  Suppression On  							!== 삭제여부 ==!  */
			, A.FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
			, TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY') AS frst_rgsr_dttm	/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
			, A.LAST_CHPR_ID														/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
			, TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY') AS last_chg_dttm	/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
			, A.RELA_NO																/**  Numéro Concerné  							!== 관련번호 ==!  */
			, A.PCKG_UT_CD															/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			, A.CO_RQST_NO 															/**  N° de demande d'entreprise 			 	!== 업체신청번호 ==!  */

			, B.CNSI_NM  					/**  Nom de destinataire  		!== 수하인명 ==!  */
			, B.CNSI_ADDR  	 				/**  Adresse de destinataire  	!== 수하인주소 ==! */
			, B.PDLS_NM						/**  Nom De L'Article  							!== 품목명 ==!  */
			, B.CNSI_NIF                    /**  N° du registre du commerce de destinataire  !== 수하인납세자식별번호,사업자등록번호 ==!  */
			, B.RLBR_PRNG_NO				/**  N° Introduction/Sortie Prévue  			!== 반출입예정번호 ==!  */

			, BRKD.AUDT_EMP_ID 				/**  ID de l'insepcteur  					     !== 심사직원ID ==!  */
			,(SELECT DECODE(L.EMP_FMNM,NULL,L.EMP_NM,L.EMP_FMNM || ' ' ||L.EMP_NM )
	                  FROM TB_POTI_EMP L
	                 WHERE L.DEL_YN = 'N'
	                   AND L.PBSR_NO = BRKD.AUDT_EMP_ID)           AS AUDT_EMP_NM
			, TO_CHAR(BRKD.PRCS_DTTM,'DD/MM/YYYY') AS PRCS_DTTM	    /** DATE De Statut De Traitement   !==처리일시==! */
			, BRKD.PRCS_STTS_CD                       		        /** Code De Statut De Traitement  !==처리상태코드==! */

			, A.AUDT_DTTM    														/**  Date De L'Étude  						 	!== 심사일시 ==!  */
			, A.AUDT_PT_CD   														/**  Code De Type De Contrôle  				 	!== 심사유형코드 ==!  */
			, A.AUDT_RSLT_CN 														/**  Contenu Du Résultat De La Vérification  	!== 심사결과내용 ==!  */

		FROM ALPASSINT.TB_CARI_RLBR A
		   , ALPASSEXT.TB_CARE_RLBR_PRNG B
		   , ALPASSINT.TB_CARI_CAG_PRCS_BRKD BRKD
		   , ALPASSEXT.TB_CARE_RLBR D
		WHERE 1 = 1
		AND	  A.RLBR_RQST_NO = BRKD.CAG_RQST_NO
		AND   A.RLBR_RQST_NO = D.RLBR_RQST_NO
		AND   B.RLBR_PRNG_NO = D.RLBR_PRNG_NO
		AND   A.DEL_YN = 'N'
		AND	  BRKD.CAG_RQST_TP_CD  = #{cagRqstTpCd}		/**  Code de type de demande fret  !== 화물신청구분코드 ==!  */

		<if test="roleId != null and (roleId.equals('CAR073'.toString()) or roleId.equals('CAR111'.toString()))">
		/** 반입신고 관리자인경우 */
		AND A.JRSD_ORGN_CD LIKE SUBSTR(#{jrsdOrgnCd}, 1, 5) || '%'
		</if>

		<if test="roleId != null and (roleId.equals('CAR074'.toString()) or roleId.equals('CAR112'.toString()))">
		/** 반출입신고 심사자인경우 */
		AND BRKD.AUDT_EMP_ID = #{pbsrNo}
		</if>

		/**  Date et heure de transmission  !== 신청일자 ==!  */
        <if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
          AND (
            (
              A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
              AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
                AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

		/**  Date et heure de transmission  !== 반입일자 ==!  */
        <if test="(searchKeywordFrom2 != null and searchKeywordFrom2 != '') and (searchKeywordTo2 != null and searchKeywordTo2 != '')">
          AND (
            (
              A.RLBR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom2}, 'DD/MM/YYYY')
              AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.RLBR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom2}, 'DD/MM/YYYY')
                AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

        /**  Code De Statut De Traitement  !== 상태 ==!  */
        <if test="prcsSttsCd != null and prcsSttsCd != ''">
          AND  BRKD.PRCS_STTS_CD = #{prcsSttsCd}
        </if>

        /** Code de type d'introduction/sortie  !== 반출입유형코드 ==!  */
        <if test="rlbrPtCd != null and rlbrPtCd != ''">
          AND  A.RLBR_PT_CD = #{rlbrPtCd}
        </if>

         /**  Code De Statut De Traitement  				!== 반출입구분코드 ==!  */
        <if test="rlbrTpCd != null and rlbrTpCd != ''">
          AND  A.RLBR_TP_CD = #{rlbrTpCd}
        </if>

        /**  Code De Statut De Traitement  !== 반입신청번호 ==!  */
        <if test="rlbrRqstNo != null and rlbrRqstNo != ''">
          AND  A.RLBR_RQST_NO = #{rlbrRqstNo}
        </if>

         /**  Code De Statut De Traitement  !== 화물관리번호 ==!  */
        <if test="cagMgmtNo != null and cagMgmtNo != ''">
          AND  A.CAG_MGMT_NO LIKE #{cagMgmtNo} || '%'
        </if>
        ORDER BY A.FRST_RGSR_DTTM DESC
    <include refid="pagination.footer" ></include>
	</select>

  <!--
    [Rechercher] Consulter la liste des "Demande d'accord préalable de l'exploitation de la zone sous douane"
    !== TB_CARI_RLBR 반입 / 반출 (신청) 신고 상세 조회 ==!
    -->
	<select id="selectCagBrngRlbrDetailInfo" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCagBrngRlbrDetailInfo */
		SELECT
	          A.RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
			, A.RLBR_TP_CD															/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
			, A.JRSD_ORGN_CD														/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			, (SELECT ORGN_NM    /** Service compétent !== 관할조직 ==! */
				 FROM TB_POTI_ORGN
				WHERE ORGN_CD = A.JRSD_ORGN_CD) AS JRSD_ORGN_NM
			, TO_CHAR(A.RLBR_DTTM, 'DD/MM/YYYY HH24:mi') AS RLBR_DTTM				/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
			, A.IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		    , (SELECT IBOBZ_NM  /* Nom de la zone sous douane !== 보세구역명 ==! */
			       FROM TB_CARI_IBOBZ
			      WHERE DEL_YN = 'N'
			        AND IBOBZ_CD = A.IBOBZ_CD) AS IBOBZ_NM
			, A.RLBR_PT_CD															/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
			, A.CAG_MGMT_NO															/**  Crn  										!== 화물관리번호 ==!  */
			, A.BL_NO																/**  N° De Bl 								 	!== BL번호 ==!  */
			, A.RLBR_PCKG_GCNT														/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			, A.RLBR_WGHT															/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
	        , A.DIVD_TP_CD															/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			, A.BRNG_ACDN_PT_CD														/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			, A.BRNG_ACDN_GCNT														/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
			, A.BRNG_ACDN_WGHT														/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			, TO_CHAR(A.trsn_dttm, 'DD/MM/YYYY') AS TRSN_DTTM						/**  Date et heure de transmission  			!== 전송일시 ==!  */
			, A.TRSN_CO_CD															/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
			, A.DEL_YN																/**  Suppression On  							!== 삭제여부 ==!  */
			, A.FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
			, TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY') AS FRST_RGSR_DTTM				/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
			, A.LAST_CHPR_ID														/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
			, TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY') AS LAST_CHG_DTTM				/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
			, A.RELA_NO																/**  Numéro Concerné  							!== 관련번호 ==!  */
			, A.PCKG_UT_CD															/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			, A.TRSF_PRNG_DT														/**  Date D'Aliénation Prévue                   !== 양도예정일자 ==!  */
			, A.CO_RQST_NO 															/**  N° de demande d'entreprise 			 	!== 업체신청번호 ==!  */
			, A.ATCH_FILE_ID

			, B.CNSI_NM  					/**  Nom de destinataire  		!== 수하인명 ==!  */
			, B.CNSI_ADDR  	 				/**  Adresse de destinataire  	!== 수하인주소 ==! */
			, B.CNSI_NIF                    /**  N° du registre du commerce de destinataire  !== 수하인납세자식별번호,사업자등록번호 ==!  */
			, B.RLBR_PRNG_NO				/**  N° Introduction/Sortie Prévue  			!== 반출입예정번호 ==!  */
			, B.PDLS_NM						/**  Nom De L'Article  							!== 품목명 ==!  */
			, B.PCKG_GCNT    				/**  Nombre De Colis  						     !== 포장개수 ==!*/
			, B.WGHT    					/**  Poids  									 !== 중량 ==!*/
			, DECODE(NVL(BRKD.AUDT_EMP_ID,''), '', BRKD2.AUDT_EMP_ID, BRKD.AUDT_EMP_ID) AS AUDT_EMP_ID 						/** ID de la personne vérifiant !==심사직원ID==! */
			, (SELECT DECODE(L.EMP_FMNM,NULL,L.EMP_NM,L.EMP_FMNM || ' ' ||L.EMP_NM )
			   FROM TB_POTI_EMP L
			   WHERE L.DEL_YN = 'N'
			   AND L.PBSR_NO = DECODE(NVL(BRKD.AUDT_EMP_ID,''), '', BRKD2.AUDT_EMP_ID, BRKD.AUDT_EMP_ID)) AS AUDT_EMP_NM	/**  Nom du l'insepcteur  !== 심사직원명 ==!  */
			, TO_CHAR(DECODE(BRKD.PRCS_DTTM, NULL, BRKD2.PRCS_DTTM, BRKD.PRCS_DTTM),'DD/MM/YYYY') AS PRCS_DTTM				/** DATE De Statut De Traitement   !==처리일시==! */
			, DECODE(NVL(BRKD.PRCS_STTS_CD,''), '', BRKD2.PRCS_STTS_CD, BRKD.PRCS_STTS_CD) AS PRCS_STTS_CD					/** Code de statut de traitement !==처리상태코드==! */
			, A.AUDT_DTTM    														/**  Date De L'Étude  						 	!== 심사일시 ==!  */
			, A.AUDT_PT_CD   														/**  Code De Type De Contrôle  				 	!== 심사유형코드 ==!  */
			, A.AUDT_RSLT_CN 														/**  Contenu Du Résultat De La Vérification  	!== 심사결과내용 ==!  */
		    , B.EXP_CMDT_BRNG_RQNO
			, (SELECT CAG_CHRC_CD FROM ALPASSINT.TB_CARI_CAG_DCSH_BL WHERE CAG_MGMT_NO = A.CAG_MGMT_NO AND DEL_YN = 'N' ) AS CAG_CHRC_CD /** !== 화물특성코드 ==!*/
		FROM  ALPASSINT.TB_CARI_RLBR A
		    , ALPASSEXT.TB_CARE_RLBR_PRNG B
		    , ALPASSINT.TB_CARI_CAG_PRCS_BRKD BRKD
			, ALPASSEXT.TB_CARE_RLBR D
			, ALPASSINT.TB_CARI_CAG_PRCS_BRKD BRKD2
		WHERE 1 = 1
		AND   A.RLBR_RQST_NO = D.RLBR_RQST_NO
		AND   B.RLBR_PRNG_NO = D.RLBR_PRNG_NO
		AND	  A.RLBR_RQST_NO = BRKD.CAG_RQST_NO(+)
		AND   A.BNDL_RLBR_RQNO = BRKD2.CAG_RQST_NO(+)
		AND   0 = BRKD2.RQST_DGCNT(+)
		AND   A.DEL_YN = 'N'
		AND	  BRKD.CAG_RQST_TP_CD(+)  = #{cagRqstTpCd}		/**  Code de type de demande fret  !== 화물신청구분코드 ==!  */
		/**  Date et heure de transmission  !== 신청일자 ==!  */
        <if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
          AND (
            (
              A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
              AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
                AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

		/**  Date et heure de transmission  !== 반입일자 ==!  */
        <if test="(searchKeywordFrom2 != null and searchKeywordFrom2 != '') and (searchKeywordTo2 != null and searchKeywordTo2 != '')">
          AND (
            (
              A.RLBR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom2}, 'DD/MM/YYYY')
              AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.RLBR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom2}, 'DD/MM/YYYY')
                AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

        /**  Code De Statut De Traitement  		!== 상태 ==!  */
        <if test="prcsSttsCd != null and prcsSttsCd != ''">
          AND  BRKD.PRCS_STTS_CD = #{prcsSttsCd}
        </if>

        /** Code de type d'introduction/sortie  !== 반출입유형코드 ==!  */
        <if test="rlbrPtCd != null and rlbrPtCd != ''">
          AND  A.RLBR_PT_CD = #{rlbrPtCd}
        </if>

         /**  Code De Statut De Traitement  	!== 반출입구분코드 ==!  */
        <if test="rlbrTpCd != null and rlbrTpCd != ''">
          AND  A.RLBR_TP_CD = #{rlbrTpCd}
        </if>

        /**  Code De Statut De Traitement  		!== 반입신청번호 ==!  */
        <if test="rlbrRqstNo != null and rlbrRqstNo != ''">
          AND  A.RLBR_RQST_NO = #{rlbrRqstNo}
        </if>

         /**  Code De Statut De Traitement  	!== 화물관리번호 ==!  */
        <if test="cagMgmtNo != null and cagMgmtNo != ''">
          AND  A.CAG_MGMT_NO = #{cagMgmtNo}
        </if>
  </select>

    <!--
	 [Supprimer] Demande d’introduction
	 !== 반입 / 반출 신청 [심사완료] 저장한다. TO IPT==!
	 -->
	<update id="cagBrngIptConfirm" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.cagBrngIptConfirm */
	    UPDATE ALPASSINT.TB_CARI_RLBR
	       SET
		 	  LAST_CHPR_ID  = #{lastChprId}   /*last_chpr_idId Du Modificateur Final  				 !== 최종변경자ID ==!*/
		 	, LAST_CHG_DTTM  = SYSTIMESTAMP  /*last_chg_dttmDate Et Heure De Modification Finale      !== 최종변경일시 ==!*/
		 	<if test="audtEmpId != null and audtEmpId != ''">
	        , AUDT_EMP_ID   = #{audtEmpId}   /**  ID de l'insepcteur  					 !== 심사직원ID ==!  */
			, AUDT_DTTM     = SYSTIMESTAMP 	/**  Date De L'Étude  						 !== 심사일시 ==!  */
			</if>
			<if test="audtPtCd != null and audtPtCd != ''">
			, AUDT_PT_CD    = #{audtPtCd} 	/**  Code De Type De Contrôle  				 !== 심사유형코드 ==!  */
			</if>
			<if test="audtRsltCn != null and audtRsltCn != ''">
			, AUDT_RSLT_CN  = #{audtRsltCn} 	/**  Contenu Du Résultat De La Vérification  !== 심사결과내용 ==!  */
			</if>
		 	, BL_NO = #{blNo}
		WHERE RLBR_RQST_NO = #{rlbrRqstNo}  /**  Code De Statut De Traitement      		 !== 신청번호 ==!  */
    </update>

    <!-- TO IPT
	 !== 수출물품반입테이블의 blno정보를 수정한다==!
	 -->
	<update id="updateIptExpBlno" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateIptExpBlno */
	    UPDATE ALPASSINT.TB_CARI_EXP_CMDT_BRNG
	       SET
		 	  LAST_CHPR_ID  = #{lastChprId}   /*last_chpr_idId Du Modificateur Final  				 !== 최종변경자ID ==!*/
		 	, LAST_CHG_DTTM  = SYSTIMESTAMP  /*last_chg_dttmDate Et Heure De Modification Finale      !== 최종변경일시 ==!*/
		 	, BL_NO = #{blNo}
		WHERE EXP_CMDT_BRNG_RQNO = #{relaNo}  /**  Code De Statut De Traitement      		 !== 신청번호 ==!  */
    </update>
    <!-- TO EPT
	 !== 수출물품반입테이블의 blno정보를 수정한다==!
	 -->
	<update id="updateEptExpBlno" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateEptExpBlno */
	    UPDATE ALPASSEXT.TB_CARE_EXP_CMDT_BRNG
	       SET
		 	  LAST_CHPR_ID  = #{lastChprId}   /*last_chpr_idId Du Modificateur Final  				 !== 최종변경자ID ==!*/
		 	, LAST_CHG_DTTM  = SYSTIMESTAMP  /*last_chg_dttmDate Et Heure De Modification Finale      !== 최종변경일시 ==!*/
		 	, BL_NO = #{blNo}
		WHERE EXP_CMDT_BRNG_RQNO = #{relaNo}  /**  Code De Statut De Traitement      		 !== 신청번호 ==!  */
    </update>

	<!--
	 [Supprimer] Demande d’introduction
	 !== 반입 /반출 신청 [심사완료] 저장한다. TO EPT==!
	 -->
	<update id="cagBrngEptConfirm" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.cagBrngEptConfirm */
	    UPDATE ALPASSEXT.TB_CARE_RLBR
	       SET
		 	  LAST_CHPR_ID  = #{lastChprId}   /*last_chpr_idId Du Modificateur Final  				 !== 최종변경자ID ==!*/
		 	, LAST_CHG_DTTM  = SYSTIMESTAMP  /*last_chg_dttmDate Et Heure De Modification Finale      !== 최종변경일시 ==!*/
		 	<if test="prcsSttsCd != null and prcsSttsCd != ''">
	        , PRCS_STTS_CD   = #{prcsSttsCd}	 /**  Code De Statut De Traitement  !== 처리상태코드/ 심사유형코드 저장 ==!  */
	        , PRCS_DTTM     = SYSTIMESTAMP 		/**  Date Et Heure De Traitement  	!== 처리일시 ==!  */
		 	</if>
		 	, BL_NO = #{blNo}
		WHERE RLBR_RQST_NO = #{rlbrRqstNo}   /**  Code De Statut De Traitement  !== 신청번호 ==!  */
    </update>


   <!--
   [Enregistrer] Demande d’introduction TODO 번역 필요
   !== [정정차수] 생성 ==!
  -->
  <select id="getMdfyDgcnt" resultType="String">
    /*getMdfyDgcnt*/
    SELECT LPAD(COUNT(RLBR_RQST_NO)+1, 5,'0')  AS MDFY_DGCNT
	FROM ALPASSEXT.TB_CARE_RLBR_MDFY
	WHERE RLBR_RQST_NO = #{rlbrRqstNo}
  </select>

    <!--
   	   [Enregistrer] Demande d’introduction TODO 번역 필요
   	   !== 재고 테이블을 조회한다. ==!
    -->
    <select id="selectTbCariInvnData" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagCariInvnVo">
    /* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectTbCariInvnData */
      SELECT
          A.CAG_MGMT_NO															/**  Crn  										!== 화물관리번호 ==!  */
		, A.IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		, TO_CHAR(A.last_brng_dttm, 'DD/MM/YYYY HH24:mi') AS last_brng_dttm	/**  Date de dernière introduction  			!== 최종반입일시 ==!  */
		, A.INVN_PCKG_GCNT														/**  Nombre de colis du stock  					!== 재고포장개수 ==!  */
		, A.INVN_WGHT															/**  Poids Du Stock  							!== 재고중량 ==!  */
		, A.BRNG_PCKG_GCNT														/**  Nombre de colis introduits  				!== 반입포장개수 ==!  */
		, A.BRNG_WGHT															/**  Poids introduit  							!== 반입중량 ==!  */
		, A.RLSE_PCKG_GCNT														/**  Nombre de colis sortis  					!== 반출포장개수 ==!  */
		, A.RLSE_WGHT															/**  Poids sorti  								!== 반출중량 ==!  */
		, A.INVN_YN																/**  Stock On  									!== 재고여부 ==!  */
		, A.DEL_YN																/**  Suppression On  							!== 삭제여부 ==!  */
		, A.FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
		, TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY HH24:mi:ss') AS frst_rgsr_dttm	/**  Date Et Heure De Premier Enregistrement    !== 최초등록일시 ==!  */
		, A.LAST_CHPR_ID														/**  Id Du Modificateur Final  				    !== 최종변경자ID ==!  */
		, TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY HH24:mi:ss') AS last_chg_dttm	/**  Date Et Heure De Modification Finale  	    !== 최종변경일시 ==!  */

		FROM ALPASSINT.TB_CARI_INVN A
      	 WHERE 1 = 1
      	  	AND A.DEL_YN = 'N'

        /**  Code De Statut De Traitement  	!== 화물관리번호 ==!  */
        <if test="cagMgmtNo != null and cagMgmtNo != ''">
          AND  A.CAG_MGMT_NO LIKE #{cagMgmtNo} || '%'
        </if>

        /** Code de zone sous douane  		    !== 보세구역코드 ==!  */
        <if test="ibobzCd != null and ibobzCd != ''">
          AND  A.IBOBZ_CD = #{ibobzCd}
        </if>

    </select>



    <!-- ############################## 0105, 0113 ######################################-->

  <!--
   [Enregistrer] Enregistrer la TB_CARE_RLBR_MDFY
   !== TB_CARE_RLBR_MDFY 반입신청 정정 등록 ==!
   -->
	<insert id="insertRlbrMdfyEpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
  	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.insertRlbrMdfyEpt */
   INSERT INTO ALPASSEXT.TB_CARE_RLBR_MDFY (
          RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
		, MDFY_DGCNT														/**  Fréquence de rectification  				!== 정정차수 ==!  */
		, RLBR_TP_CD														/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
		, JRSD_ORGN_CD														/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
		, RLBR_DTTM															/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
		, IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		, RLBR_PT_CD														/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
		, CAG_MGMT_NO														/**  Crn  										!== 화물관리번호 ==!  */
		, BL_NO																/**  N° De Bl  									!== BL번호 ==!  */
		, PDLS_NM															/**  Nom De L'Article  							!== 품목명 ==!  */
		, RLBR_PCKG_GCNT													/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
		, RLBR_WGHT															/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
		, DIVD_TP_CD														/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
		, BRNG_ACDN_PT_CD													/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
		, BRNG_ACDN_GCNT													/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
		, BRNG_ACDN_WGHT													/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
		, TRSN_DTTM															/**  Date et heure de transmission  			!== 전송일시 ==!  */
		, TRSN_CO_CD														/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
		, PRCS_DTTM															/**  Date Et Heure De Traitement  				!== 처리일시 ==!  */
		, PRCS_STTS_CD														/**  Code De Statut De Traitement  				!== 처리상태코드 ==!  */
		, PRCS_RSLT_CN														/**  Résultat De Traitement  					!== 처리결과내용 ==!  */
		, DEL_YN															/**  Suppression On  							!== 삭제여부 ==!  */
		, FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
		, FRST_RGSR_DTTM 													/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
		, LAST_CHPR_ID														/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
		, LAST_CHG_DTTM														/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
		, RELA_NO															/**  Numéro Concerné  							!== 관련번호 ==!  */
		, PCKG_UT_CD														/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
		, RLBR_MDFY_TP_CD													/**  Code de catégorie de rectif. d'introduction/sortie	!== 반출입정정구분코드 ==!  */
		, ATCH_FILE_ID
     	)
    VALUES
        (
          #{rlbrRqstNo}			/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
		, #{mdfyDgcnt}			/**  Fréquence de rectification  				!== 정정차수 ==!  */
		, #{rlbrTpCd}			/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
		, #{jrsdOrgnCd}			/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
		, TO_DATE(#{rlbrDttm})	/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
		, #{ibobzCd}			/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		, #{rlbrPtCd}			/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
		, #{cagMgmtNo}			/**  Crn  										!== 화물관리번호 ==!  */
		, #{blNo}				/**  N° De Bl  									!== BL번호 ==!  */
		, #{pdlsNm}				/**  Nom De L'Article  							!== 품목명 ==!  */
		, #{rlbrPckgGcnt}		/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
		, #{rlbrWght}			/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
		, #{divdTpCd}			/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
		, #{brngAcdnPtCd}		/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
		, #{brngAcdnGcnt}		/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
		, #{brngAcdnWght}		/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
		, SYSTIMESTAMP 			/**  Date et heure de transmission  			!== 전송일시 ==!  */
		, #{trsnCoCd}			/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
		, SYSTIMESTAMP 			/**  Date Et Heure De Traitement  				!== 처리일시 ==!  */
		, #{prcsSttsCd}			/**  Code De Statut De Traitement  				!== 처리상태코드 ==!  */
		, #{prcsRsltCn}			/**  Résultat De Traitement  					!== 처리결과내용 ==!  */
		, #{delYn}				/**  Suppression On  							!== 삭제여부 ==!  */
		, #{frstRegstId}		/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
		, SYSTIMESTAMP 			/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
		, #{lastChprId}			/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
		, SYSTIMESTAMP 			/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
		, #{relaNo}				/**  Numéro Concerné  							!== 관련번호 ==!  */
		, #{pckgUtCd}			/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
		, #{rlbrMdfyTpCd}		/**  Code de catégorie de rectif. d'introduction/sortie	!== 반출입정정구분코드 ==!  */
		, #{atchFileId}
		)
	</insert>

  <!--
   [Enregistrer] Enregistrer la TB_CARI_RLBR_MDFY
   !== TB_CARI_RLBR_MDFY 반입신청 정정 등록 ==!
   -->
	<insert id="insertRlbrMdfyIpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
  	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.insertRlbrMdfyEpt */
   INSERT INTO ALPASSINT.TB_CARI_RLBR_MDFY (
          RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
		, MDFY_DGCNT														/**  Fréquence de rectification  				!== 정정차수 ==!  */
		, RLBR_TP_CD														/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
		, JRSD_ORGN_CD														/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
		, RLBR_DTTM															/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
		, RLBR_MDFY_TP_CD													/**  Code de catégorie de rectif. d'introduction/sortie	!== 반출입정정구분코드 ==!  */
		, MDFY_RSN_CN  														/**  Motif de rectification                       !== 정정사유내용 ==!  */
		, IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		, RLBR_PT_CD														/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
		, CAG_MGMT_NO														/**  Crn  										!== 화물관리번호 ==!  */
		, BL_NO																/**  N° De Bl  									!== BL번호 ==!  */
		, RELA_NO															/**  Numéro Concerné  							!== 관련번호 ==!  */
		, PDLS_NM															/**  Nom De L'Article  							!== 품목명 ==!  */
		, RLBR_PCKG_GCNT													/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
		, RLBR_WGHT															/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
		, DIVD_TP_CD														/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
		, BRNG_ACDN_PT_CD													/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
		, BRNG_ACDN_GCNT													/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
		, BRNG_ACDN_WGHT													/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
		, TRSN_DTTM															/**  Date et heure de transmission  			!== 전송일시 ==!  */
		, TRSN_CO_CD														/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
		, DEL_YN															/**  Suppression On  							!== 삭제여부 ==!  */
		, FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
		, FRST_RGSR_DTTM 													/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
		, LAST_CHPR_ID														/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
		, LAST_CHG_DTTM														/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
		, PCKG_UT_CD														/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
		, ATCH_FILE_ID
     	)
    VALUES
        (
          #{rlbrRqstNo}			/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
		, #{mdfyDgcnt}			/**  Fréquence de rectification  				!== 정정차수 ==!  */
		, #{rlbrTpCd}			/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
		, #{jrsdOrgnCd}			/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
		, TO_DATE(#{rlbrDttm})	/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
		, #{rlbrMdfyTpCd}		/**  Code de catégorie de rectif. d'introduction/sortie	!== 반출입정정구분코드 ==!  */
		, #{mdfyRsnCn}			/**  Motif de rectification                       !== 정정사유내용 ==!  */
		, #{ibobzCd}			/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		, #{rlbrPtCd}			/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
		, #{cagMgmtNo}			/**  Crn  										!== 화물관리번호 ==!  */
		, #{blNo}				/**  N° De Bl  									!== BL번호 ==!  */
		, #{relaNo}				/**  Numéro Concerné  							!== 관련번호 ==!  */
		, #{pdlsNm}				/**  Nom De L'Article  							!== 품목명 ==!  */
		, #{rlbrPckgGcnt}		/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
		, #{rlbrWght}			/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
		, #{divdTpCd}			/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
		, #{brngAcdnPtCd}		/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
		, #{brngAcdnGcnt}		/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
		, #{brngAcdnWght}		/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
		, SYSTIMESTAMP 			/**  Date et heure de transmission  			!== 전송일시 ==!  */
		, #{trsnCoCd}			/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
		, #{delYn}				/**  Suppression On  							!== 삭제여부 ==!  */
		, #{frstRegstId}		/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
		, SYSTIMESTAMP 			/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
		, #{lastChprId}			/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
		, SYSTIMESTAMP 			/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
		, #{pckgUtCd}			/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
		, #{atchFileId}
		)
	</insert>


    <!--
    [Rechercher] Consulter la liste des "Demande d'accord préalable de l'exploitation de la zone sous douane"
    !== TB_CARI_RLBR 반입 정정 목록 조회 ==!
    -->
	<select id="selectCarBnwrhsCagBrngRlbrMdfyList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCarBnwrhsCagBrngRlbrMdfyList */
    	<include refid="pagination.header" ></include>
		SELECT
	       	  A.RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
			, A.MDFY_DGCNT															/**  Fréquence de rectification  				!== 정정차수 ==!  */
			, A.RLBR_TP_CD															/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
			, A.JRSD_ORGN_CD														/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			, (SELECT ORGN_NM    /** Service compétent !== 관할조직 ==! */
				 FROM TB_POTI_ORGN
				WHERE ORGN_CD = A.JRSD_ORGN_CD) AS JRSD_ORGN_NM
			, TO_CHAR(A.RLBR_DTTM, 'DD/MM/YYYY') AS RLBR_DTTM						/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
			, A.MDFY_RSN_CN															/**  Motif de rectification  					!== 정정사유내용 ==!  */
			, A.IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
			, A.RLBR_PT_CD															/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
			, A.CAG_MGMT_NO															/**  Crn  										!== 화물관리번호 ==!  */
			, A.BL_NO																/**  N° De Bl  									!== BL번호 ==!  */
			, A.PDLS_NM																/**  Nom De L'Article  							!== 품목명 ==!  */
			, A.RLBR_PCKG_GCNT														/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			, A.RLBR_WGHT															/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
			, A.DIVD_TP_CD															/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			, A.BRNG_ACDN_PT_CD														/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			, A.BRNG_ACDN_GCNT														/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
			, A.BRNG_ACDN_WGHT														/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			, A.TRSN_CO_CD															/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
			, A.DEL_YN																/**  Suppression On  							!== 삭제여부 ==!  */
			, A.FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
			, TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY') AS FRST_RGSR_DTTM	/**  Date Et Heure De Premier Enregistrement  				!== 최초등록일시 ==!  */
			, A.LAST_CHPR_ID														/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
			, TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY') AS LAST_CHG_DTTM	/**  Date Et Heure De Modification Finale  					!== 최종변경일시 ==!  */
			, A.RELA_NO																/**  Numéro Concerné  							!== 관련번호 ==!  */
			, A.PCKG_UT_CD															/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			, A.RLBR_MDFY_TP_CD													    /**  Code de catégorie de rectif. d'introduction/sortie   !== 반출입정정구분코드 ==!  */

			, B.AUDT_EMP_ID 				/**  ID de l'insepcteur  					     !== 심사직원ID ==!  */
			,(SELECT DECODE(L.EMP_FMNM,NULL,L.EMP_NM,L.EMP_FMNM || ' ' ||L.EMP_NM )
	                  FROM TB_POTI_EMP L
	                 WHERE L.DEL_YN = 'N'
	                   AND L.PBSR_NO = B.AUDT_EMP_ID)           AS AUDT_EMP_NM
			, TO_CHAR(B.PRCS_DTTM,'DD/MM/YYYY') AS PRCS_DTTM	    /** DATE De Statut De Traitement   !==처리일시==! */
			, B.PRCS_STTS_CD

			, A.AUDT_DTTM    														/**  Date De L'Étude  						 	!== 심사일시 ==!  */
			, A.AUDT_PT_CD   														/**  Code De Type De Contrôle  				 	!== 심사유형코드 ==!  */
			, A.AUDT_RSLT_CN 														/**  Contenu Du Résultat De La Vérification  	!== 심사결과내용 ==!  */

			, D.CNSI_NM  															/**  Nom de destinataire  						!== 수하인명 ==!  */
			, D.CNSI_ADDR  	 														/**  Adresse de destinataire  					!== 수하인주소 ==! */
			, D.PDLS_NM  															/**  Nom De L'Article                          !== 품목명 ==!  */
			, D.CNSI_NIF                    										/**  N° du registre du commerce de destinataire !== 수하인납세자식별번호,사업자등록번호 ==!  */
		 	, D.PCKG_GCNT    														/** Nombre De Colis  						     !== 포장개수 ==!*/
		 	, D.WGHT    															/** Poids  										     !== 중량 ==!*/

		FROM ALPASSINT.TB_CARI_RLBR_MDFY A
		   , ALPASSINT.TB_CARI_CAG_PRCS_BRKD B
		   , ALPASSEXT.TB_CARE_RLBR_PRNG D
		WHERE 1 = 1
		AND	  A.RLBR_RQST_NO = B.CAG_RQST_NO
		AND   A.MDFY_DGCNT  = B.RQST_DGCNT
		AND   A.CAG_MGMT_NO = D.CAG_MGMT_NO
		AND   A.RLBR_TP_CD = D.RLBR_TP_CD
     	AND   A.DEL_YN = 'N'
     	AND   D.RLBR_PRNG_NO = (SELECT A1.RLBR_PRNG_NO
								FROM ALPASSEXT.TB_CARE_RLBR_PRNG A1
		     	                   , ALPASSEXT.TB_CARE_RLBR B1
								WHERE A1.RLBR_PRNG_NO = B1.RLBR_PRNG_NO
		     	                AND   B1.RLBR_RQST_NO = A.RLBR_RQST_NO
		     	                LIMIT 1)
     	AND   B.CAG_RQST_TP_CD = #{cagRqstTpCd}		/**  Code de type de demande fret  !== 화물신청구분코드 ==!  */
     	AND   A.MDFY_DGCNT != 0

		<if test="roleId != null and (roleId.equals('CAR075'.toString()) or roleId.equals('CAR113'.toString()))">
		/** 반입신고 관리자인경우 */
		AND A.JRSD_ORGN_CD LIKE SUBSTR(#{jrsdOrgnCd}, 1, 5) || '%'
		</if>

		<if test="roleId != null and (roleId.equals('CAR076'.toString()) or roleId.equals('CAR114'.toString()))">
		/** 반출입신고 심사자인경우 */
		AND B.AUDT_EMP_ID = #{pbsrNo}
		</if>

		/**  Date et heure de transmission  !== 신청일자 ==!  */
        <if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
          AND (
            (
              A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
              AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
                AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

		/**  Date et heure de transmission  !== 반입일자 ==!  */
        <if test="(searchKeywordFrom2 != null and searchKeywordFrom2 != '') and (searchKeywordTo2 != null and searchKeywordTo2 != '')">
          AND (
            (
              A.RLBR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom2}, 'DD/MM/YYYY')
              AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.RLBR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom2}, 'DD/MM/YYYY')
                AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

        /**  Code De Statut De Traitement  !== 상태 ==!  */
        <if test="prcsSttsCd != null and prcsSttsCd != ''">
          AND  B.PRCS_STTS_CD = #{prcsSttsCd}
        </if>

        /** Code de type d'introduction/sortie  !== 반출입유형코드 ==!  */
        <if test="rlbrPtCd != null and rlbrPtCd != ''">
          AND  A.RLBR_PT_CD = #{rlbrPtCd}
        </if>

        /**  Code De Statut De Traitement  	!== 반출입구분코드 ==!  */
        <if test="rlbrTpCd != null and rlbrTpCd != ''">
          AND  A.RLBR_TP_CD = #{rlbrTpCd}
        </if>

        /**  Code De Statut De Traitement  !== 반입신청번호 ==!  */
        <if test="rlbrRqstNo != null and rlbrRqstNo != ''">
          AND  A.RLBR_RQST_NO = #{rlbrRqstNo}
        </if>

         /**  Code De Statut De Traitement  !== 화물관리번호 ==!  */
        <if test="cagMgmtNo != null and cagMgmtNo != ''">
          AND  A.CAG_MGMT_NO LIKE #{cagMgmtNo} || '%'
        </if>

         /**  Code De Statut De Traitement  !== 정정차수 ==!  */
        <if test="mdfyDgcnt != null and mdfyDgcnt != ''">
          AND  A.MDFY_DGCNT = #{mdfyDgcnt}
        </if>
		ORDER BY A.FRST_RGSR_DTTM DESC
    <include refid="pagination.footer" ></include>
	</select>

	<!--
    [Rechercher] Consulter la liste des "Demande d'accord préalable de l'exploitation de la zone sous douane"
    !== TB_CARI_RLBR_MDFY 반입/반출 정정 상세 조회 (BEFORE DATA)==!
    -->
	<select id="selectCagBrngRlbrDetailMdfyInfoBefore" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCagBrngRlbrDetailMdfyInfoBefore */
		SELECT
	           A.RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
			 , A.MDFY_DGCNT															/**  Fréquence de rectification  				!== 정정차수 ==!  */
			 , A.RLBR_TP_CD															/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
			 , A.JRSD_ORGN_CD														/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			 , (SELECT ORGN_NM    /** Service compétent !== 관할조직 ==! */
			 	 FROM TB_POTI_ORGN
			 	WHERE ORGN_CD = A.JRSD_ORGN_CD) AS JRSD_ORGN_NM
			 , TO_CHAR(A.RLBR_DTTM, 'DD/MM/YYYY HH24:mi') AS RLBR_DTTM			/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
			 , A.MDFY_RSN_CN															/**  Motif de rectification  					!== 정정사유내용 ==!  */
			 , A.IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		     , (SELECT IBOBZ_NM  /* Nom de la zone sous douane !== 보세구역명 ==! */
			        FROM TB_CARI_IBOBZ
			       WHERE DEL_YN = 'N'
			         AND IBOBZ_CD = A.IBOBZ_CD) AS IBOBZ_NM
			 , A.RLBR_PT_CD															/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
			 , A.CAG_MGMT_NO															/**  Crn  										!== 화물관리번호 ==!  */
			 , A.BL_NO																/**  N° De Bl  									!== BL번호 ==!  */
			 , A.PDLS_NM																/**  Nom De L'Article  							!== 품목명 ==!  */
			 , A.RLBR_PCKG_GCNT														/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			 , A.RLBR_WGHT															/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
			 , A.DIVD_TP_CD															/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			 , A.BRNG_ACDN_PT_CD														/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			 , A.BRNG_ACDN_GCNT														/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
			 , A.BRNG_ACDN_WGHT														/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			 , A.DEL_YN																/**  Suppression On  							!== 삭제여부 ==!  */
			 , A.FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
			 , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY HH24:mi:ss') AS FRST_RGSR_DTTM	/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
			 , A.LAST_CHPR_ID														/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
			 , TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY HH24:mi:ss') AS LAST_CHG_DTTM	/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
			 , A.RELA_NO															/**  Numéro Concerné  							!== 관련번호 ==!  */
			 , A.PCKG_UT_CD															/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			 , A.RLBR_MDFY_TP_CD													/**  Code de catégorie de rectif. d'introduction/sortie	!== 반출입정정구분코드 ==!  */
			 , A.ATCH_FILE_ID
			 , (SELECT CAG_CHRC_CD FROM ALPASSINT.TB_CARI_CAG_DCSH_BL WHERE CAG_MGMT_NO = A.CAG_MGMT_NO AND DEL_YN = 'N' ) AS CAG_CHRC_CD /** !== 화물특성코드 ==!*/
		FROM ALPASSINT.TB_CARI_RLBR_MDFY A
		WHERE 1 = 1
		AND   A.DEL_YN = 'N'
		AND   A.MDFY_DGCNT = (
								SELECT NVL(MAX(A1.RQST_DGCNT), 0)
							    FROM ALPASSINT.TB_CARI_CAG_PRCS_BRKD A1
		 						WHERE A1.CAG_RQST_NO = A.RLBR_RQST_NO
								AND   A1.CAG_RQST_TP_CD = #{cagRqstTpCd}	/**  Code de type de demande fret  !== 화물신청구분코드 ==! */
								AND   A1.PRCS_STTS_CD = 'D08'
								AND   A1.RQST_DGCNT != #{mdfyDgcnt}
								AND   A1.RQST_DGCNT <![CDATA[ < ]]> #{mdfyDgcnt}
							 )

		/** Code de type d'introduction/sortie  !== 반출입유형코드 ==!  */
       	<if test="rlbrPtCd != null and rlbrPtCd != ''">
         	AND  A.rlbr_pt_cd = #{rlbrPtCd}
       	</if>

       	/**  Code De Statut De Traitement    !== 반입신청번호 ==!  */
       	<if test="rlbrRqstNo != null and rlbrRqstNo != ''">
			AND  A.rlbr_rqst_no = #{rlbrRqstNo}
       	</if>
   </select>

	<!--
    [Rechercher] Consulter la liste des "Demande d'accord préalable de l'exploitation de la zone sous douane"
    !== TB_CARI_RLBR 반입 정정 상세 조회 ==!
    -->
	<select id="selectCagBrngRlbrMdfyDetailInfo" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCagBrngRlbrMdfyDetailInfo */
		SELECT
	           A.RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
			 , A.MDFY_DGCNT															/**  Fréquence de rectification  				!== 정정차수 ==!  */
			 , A.RLBR_TP_CD															/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
			 , A.JRSD_ORGN_CD														/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			 , (SELECT ORGN_NM    /** Service compétent !== 관할조직 ==! */
			 	 FROM TB_POTI_ORGN
			 	WHERE ORGN_CD = A.JRSD_ORGN_CD) AS JRSD_ORGN_NM
			 , TO_CHAR(A.RLBR_DTTM, 'DD/MM/YYYY HH24:mi') AS RLBR_DTTM			/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
			 , A.MDFY_RSN_CN															/**  Motif de rectification  					!== 정정사유내용 ==!  */
			 , A.IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
		     , (SELECT IBOBZ_NM  /* Nom de la zone sous douane !== 보세구역명 ==! */
			        FROM TB_CARI_IBOBZ
			       WHERE DEL_YN = 'N'
			         AND IBOBZ_CD = A.IBOBZ_CD) AS IBOBZ_NM
			 , A.RLBR_PT_CD															/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
			 , A.CAG_MGMT_NO															/**  Crn  										!== 화물관리번호 ==!  */
			 , A.BL_NO																/**  N° De Bl  									!== BL번호 ==!  */
			 , A.PDLS_NM																/**  Nom De L'Article  							!== 품목명 ==!  */
			 , A.RLBR_PCKG_GCNT														/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			 , A.RLBR_WGHT															/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
			 , A.DIVD_TP_CD															/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			 , A.BRNG_ACDN_PT_CD														/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			 , A.BRNG_ACDN_GCNT														/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
			 , A.BRNG_ACDN_WGHT														/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			 , A.DEL_YN																/**  Suppression On  							!== 삭제여부 ==!  */
			 , A.FRST_REGST_ID														/**  Id Du Premier Enregistrant   				!== 최초등록자ID ==!  */
			 , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY HH24:mi:ss') AS FRST_RGSR_DTTM	/**  Date Et Heure De Premier Enregistrement  	!== 최초등록일시 ==!  */
			 , A.LAST_CHPR_ID														/**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
			 , TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY HH24:mi:ss') AS LAST_CHG_DTTM	/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
			 , A.RELA_NO															/**  Numéro Concerné  							!== 관련번호 ==!  */
			 , A.PCKG_UT_CD															/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			 , A.RLBR_MDFY_TP_CD													/**  Code de catégorie de rectif. d'introduction/sortie	!== 반출입정정구분코드 ==!  */
			 , A.AUDT_RSLT_CN 														/**  Contenu Du Résultat De La Vérification  	!== 심사결과내용 ==!  */
			 , A.ATCH_FILE_ID

			 , B.AUDT_EMP_ID 				/**  ID de l'insepcteur  					     !== 심사직원ID ==!  */
			 ,(SELECT DECODE(L.EMP_FMNM,NULL,L.EMP_NM,L.EMP_FMNM || ' ' ||L.EMP_NM )
	                  FROM TB_POTI_EMP L
	                 WHERE L.DEL_YN = 'N'
	                   AND L.PBSR_NO = B.AUDT_EMP_ID)           AS AUDT_EMP_NM
			, TO_CHAR(B.PRCS_DTTM,'DD/MM/YYYY') AS PRCS_DTTM	    /** DATE De Statut De Traitement   !==처리일시==! */
			, B.PRCS_STTS_CD
			, (	SELECT A1.EXP_CMDT_BRNG_RQNO
				FROM ALPASSEXT.TB_CARE_RLBR_PRNG A1
				   , ALPASSEXT.TB_CARE_RLBR B1
				WHERE A1.RLBR_PRNG_NO = B1.RLBR_PRNG_NO
				AND   B1.RLBR_RQST_NO = A.RLBR_RQST_NO
				AND   A1.DEL_YN = 'N' ) AS EXP_CMDT_BRNG_RQNO
			, (SELECT CAG_CHRC_CD FROM ALPASSINT.TB_CARI_CAG_DCSH_BL WHERE CAG_MGMT_NO = A.CAG_MGMT_NO AND DEL_YN = 'N' ) AS CAG_CHRC_CD /** !== 화물특성코드 ==!*/
		FROM ALPASSINT.TB_CARI_RLBR_MDFY A
		   , ALPASSINT.TB_CARI_CAG_PRCS_BRKD B
		WHERE 1 = 1
		AND A.RLBR_RQST_NO = B.CAG_RQST_NO
		AND A.MDFY_DGCNT = B.RQST_DGCNT
		AND B.CAG_RQST_TP_CD = #{cagRqstTpCd}	/**  Code de type de demande fret  !== 화물신청구분코드 ==! */
		AND A.DEL_YN = 'N'

		/**  Date et heure de transmission  !== 신청일자 ==!  */
        <if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
          AND (
            (
              A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
              AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
                AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

		/**  Date et heure de transmission  !== 반입일자 ==!  */
        <if test="(searchKeywordFrom2 != null and searchKeywordFrom2 != '') and (searchKeywordTo2 != null and searchKeywordTo2 != '')">
          AND (
            (
              A.RLBR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom2}, 'DD/MM/YYYY')
              AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            ) OR (
                A.RLBR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom2}, 'DD/MM/YYYY')
                AND A.RLBR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
            )
          )
        </if>

        /** Code de type d'introduction/sortie  !== 반출입유형코드 ==!  */
        <if test="rlbrPtCd != null and rlbrPtCd != ''">
          AND  A.RLBR_PT_CD = #{rlbrPtCd}
        </if>

        /**  Code De Statut De Traitement  	!== 반출입구분코드 ==!  */
        <if test="rlbrTpCd != null and rlbrTpCd != ''">
          AND  A.RLBR_TP_CD = #{rlbrTpCd}
        </if>

        /**  Code De Statut De Traitement  !== 반입신청번호 ==!  */
        <if test="rlbrRqstNo != null and rlbrRqstNo != ''">
          AND  A.RLBR_RQST_NO = #{rlbrRqstNo}
        </if>

         /**  Code De Statut De Traitement  !== 화물관리번호 ==!  */
        <if test="cagMgmtNo != null and cagMgmtNo != ''">
          AND  A.CAG_MGMT_NO = #{cagMgmtNo}
        </if>

         /**  Code De Statut De Traitement  !== 정정차수 ==!  */
        <if test="mdfyDgcnt != null and mdfyDgcnt != ''">
          AND  A.MDFY_DGCNT = #{mdfyDgcnt}
        </if>
	ORDER BY MDFY_DGCNT DESC
	LIMIT 1
    </select>
    <!--
	 [Supprimer] Demande d’introduction
	 !== 반입 정정 신청 심사 [임시] 저장한다. ==!
	 -->
	<update id="cagBrngMdfySave" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.cagBrngMdfySave */
	    UPDATE ALPASSINT.TB_CARI_RLBR_MDFY
	       SET
	          AUDT_EMP_ID   = #{audtEmpId}  /**  ID de l'insepcteur  				     	!== 심사직원ID ==!  */
			, AUDT_DTTM     = SYSTIMESTAMP 	/**  Date De L'Étude  						 	!== 심사일시 ==!  */
			, AUDT_PT_CD    = #{audtPtCd} 	/**  Code De Type De Contrôle  				 	!== 심사유형코드 ==!  */
			, AUDT_RSLT_CN  = #{audtRsltCn} /**  Contenu Du Résultat De La Vérification  	!== 심사결과내용 ==!  */
			, LAST_CHPR_ID  = #{lastChprId} /**  Id Du Modificateur Final  					!== 최종변경자ID ==!  */
			, LAST_CHG_DTTM = SYSTIMESTAMP 	/**  Date Et Heure De Modification Finale  	 	!== 최종변경일시 ==!  */
		WHERE RLBR_RQST_NO = #{rlbrRqstNo}  /**  Code De Statut De Traitement  	 		 	!== 신청번호 ==!  */
		AND   MDFY_DGCNT = #{mdfyDgcnt}		/**  Code De Statut De Traitement  				!== 정정차수 ==!  */
    </update>

   <!--
   [Supprimer] Demande d’introduction
   !== 반입 정정 신청 [심사완료] 저장한다. TO IPT==!
   -->
	<update id="cagBrngMdfyIptConfirm" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
   	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.cagBrngMdfyIptConfirm */
    UPDATE ALPASSINT.TB_CARI_RLBR_MDFY
       SET
          AUDT_EMP_ID   = #{audtEmpId}   /**  ID de l'insepcteur  					 	 !== 심사직원ID ==!  */
		, AUDT_DTTM     = SYSTIMESTAMP 	/**  Date De L'Étude  						 	 !== 심사일시 ==!  */
		, AUDT_PT_CD    = #{audtPtCd} 	/**  Code De Type De Contrôle  				 	 !== 심사유형코드 ==!  */
		, AUDT_RSLT_CN  = #{audtRsltCn} 	/**  Contenu Du Résultat De La Vérification  !== 심사결과내용 ==!  */
		, LAST_CHPR_ID  = #{lastChprId} 	/**  Id Du Modificateur Final  				 !== 최종변경자ID ==!  */
		, LAST_CHG_DTTM = SYSTIMESTAMP 	/**  Date Et Heure De Modification Finale  	 	 !== 최종변경일시 ==!  */
	WHERE RLBR_RQST_NO = #{rlbrRqstNo}  /**  Code De Statut De Traitement      		 	 !== 신청번호 ==!  */
	AND   MDFY_DGCNT = #{mdfyDgcnt}		/**  Code De Statut De Traitement  				!== 정정차수 ==!  */
   </update>

	<!--
	 [Supprimer] Demande d’introduction
	 !== 반입 정정 신청 [심사완료] 저장한다. TO EPT==!
	 -->
	<update id="cagBrngMdfyEptConfirm" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrMdfyVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.cagBrngMdfyEptConfirm */
	    UPDATE ALPASSEXT.TB_CARE_RLBR_MDFY
	       SET
	          PRCS_STTS_CD  = #{prcsSttsCd}	 /**  Code De Statut De Traitement  			 !== 처리상태코드/ 심사유형코드 저장 ==!  */
			, LAST_CHPR_ID  = #{lastChprId}  /**  Id Du Modificateur Final  				 !== 최종변경자ID ==!  */
			, LAST_CHG_DTTM = SYSTIMESTAMP 	 /**  Date Et Heure De Modification Finale  	 !== 최종변경일시 ==!  */
		WHERE RLBR_RQST_NO = #{rlbrRqstNo}   /**  Code De Statut De Traitement  			 !== 신청번호 ==!  */
		AND   MDFY_DGCNT = #{mdfyDgcnt}		/**  Code De Statut De Traitement  				!== 정정차수 ==!  */
    </update>

	<!--
	 Modifier la Entrée et Sortie -EPT
	 !== 반출입 데이터를 수정한다 -EPT==!
	 -->
	<update id="updateCagBrngRlbrEpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
   		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCagBrngRlbrEpt */
		UPDATE ALPASSEXT.TB_CARE_RLBR
       		SET
			    RLBR_DTTM 		= TO_TIMESTAMP(#{rlbrDttm}, 'YYYYMMDD HH24:MI:SS')  	/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!   	*/
			  , IBOBZ_CD 		= #{ibobzCd} 				/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
			  , RLBR_PCKG_GCNT  = #{rlbrPckgGcnt} 			/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			  , RLBR_WGHT       = #{rlbrWght} 				/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
			  , DIVD_TP_CD 		= #{divdTpCd} 				/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			  , BRNG_ACDN_PT_CD = #{brngAcdnPtCd} 			/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			  , BRNG_ACDN_GCNT 	= #{brngAcdnGcnt} 			/**  Nombre d'accident d'introduction 			!== 반입사고개수 ==!  */
			  , BRNG_ACDN_WGHT 	= #{brngAcdnWght} 			/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			  , PCKG_UT_CD      = #{pckgUtCd} 				/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			<if test="trsfPrngDt != null and trsfPrngDt != ''">
			  , TRSF_PRNG_DT    = #{trsfPrngDt}    			/**  Date D'Aliénation Prévue                   !== 양도예정일자 ==!  */
			</if>
			  , DEL_YN          = #{delYn}					/**  Suppression On  							!== 삭제여부 ==!  */
			  , BL_NO          = #{blNo}					/**  N° De Bl  									!== BL번호 ==!  */
			  , LAST_CHPR_ID    = #{lastChprId}  			/**  Id Du Modificateur Final  				 	!== 최종변경자ID ==!  */
			  , LAST_CHG_DTTM   = SYSTIMESTAMP 	 			/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
		WHERE CAG_MGMT_NO = #{cagMgmtNo}		/**  Crn  										!== 화물관리번호 ==!  */
		AND   RLBR_RQST_NO = #{rlbrRqstNo}		/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
    </update>

	<!--
	 Modifier la Entrée et Sortie -IPT
	 !== 반출입 데이터를 수정한다 -IPT==!
	 -->
	<update id="updateCagBrngRlbrIpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
   		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCagBrngRlbrIpt */
		UPDATE ALPASSINT.TB_CARI_RLBR
       		SET
			    RLBR_DTTM 		= TO_TIMESTAMP(#{rlbrDttm}, 'YYYYMMDD HH24:MI:SS')  	/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!   	*/
			  , IBOBZ_CD 		= #{ibobzCd} 				/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
			  , RLBR_PCKG_GCNT  = #{rlbrPckgGcnt} 			/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			  , RLBR_WGHT       = #{rlbrWght} 				/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
			  , DIVD_TP_CD 		= #{divdTpCd} 				/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			  , BRNG_ACDN_PT_CD = #{brngAcdnPtCd} 			/**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			  , BRNG_ACDN_GCNT 	= #{brngAcdnGcnt} 			/**  Nombre d'accident d'introduction 			!== 반입사고개수 ==!  */
			  , BRNG_ACDN_WGHT 	= #{brngAcdnWght} 			/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			  , PCKG_UT_CD      = #{pckgUtCd} 				/**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			<if test="trsfPrngDt != null and trsfPrngDt != ''">
			  , TRSF_PRNG_DT    = #{trsfPrngDt}			    /**  Date D'Aliénation Prévue                   !== 양도예정일자 ==!  */
			</if>
			  , DEL_YN          = #{delYn}					/**  Suppression On  							!== 삭제여부 ==!  */
			  , BL_NO          = #{blNo}					/**  N° De Bl  									!== BL번호 ==!  */
			  , LAST_CHPR_ID    = #{lastChprId}  			/**  Id Du Modificateur Final  				 	!== 최종변경자ID ==!  */
			  , LAST_CHG_DTTM   = SYSTIMESTAMP 	 			/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
		WHERE CAG_MGMT_NO = #{cagMgmtNo}		/**  Crn  										!== 화물관리번호 ==!  */
		AND   RLBR_RQST_NO = #{rlbrRqstNo}		/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
    </update>

	<!--
	 Modifier la Entrée et Sortie prévue -EPT
	 !== 반출입 예정 데이터를 수정한다 -EPT==!
	 -->
	<update id="updateCagBrngRlbrPrngEpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
   		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCagBrngRlbrPrngEpt */
		UPDATE ALPASSEXT.TB_CARE_RLBR_PRNG
       		SET RLBR_PCKG_GCNT = RLBR_PCKG_GCNT - TO_NUMBER(#{rlbrPckgGcnt})		/** Nombre de colis d'introduction/sortie    	!== 반출입포장개수 ==!*/
		      , RLBR_WGHT      = RLBR_WGHT - TO_NUMBER(#{rlbrWght})				/**Poids d'introduction/sortie  			    !== 반출입중량    ==!*/
		      , RLBR_CMPL_YN   = CASE WHEN RLBR_PCKG_GCNT - TO_NUMBER(#{rlbrPckgGcnt}) >= PCKG_GCNT AND RLBR_WGHT - TO_NUMBER(#{rlbrWght}) >= WGHT
		      						  THEN 'Y'
		      						  ELSE 'N'
		      					 END  /**  Fin d'introduction/sortie O/N  			!== 반출입완료여부 ==!*/
			  , LAST_CHPR_ID   = #{lastChprId}  			/**  Id Du Modificateur Final  				 	!== 최종변경자ID ==!  */
			  , LAST_CHG_DTTM  = SYSTIMESTAMP 	 			/**  Date Et Heure De Modification Finale  		!== 최종변경일시 ==!  */
		WHERE CAG_MGMT_NO = #{cagMgmtNo}		/**  Crn  										!== 화물관리번호 ==!  */
		<if test="relaNo != null and relaNo != ''">
		AND   RELA_NO = #{relaNo}
		</if>
		AND   RLBR_TP_CD  = #{rlbrTpCd}			/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
		AND   RLBR_PT_CD  = #{rlbrPtCd}			/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
    </update>

	<select id="selectRlbrReport" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo">
    /* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectRlbrReport */
		SELECT
	           A.RLBR_RQST_NO														/**  N° Demande D'Introduction/Sortie  			!== 반출입신청번호 ==!  */
			 , A.RLBR_PRNG_NO														/**  N° Introduction/Sortie Prévue  			!== 반출입예정번호 ==!  */
			 , A.BNDL_RLBR_RQNO														/**  N° demande d'introduction/sortie en bloc   !== 일괄반출입신청번호 ==! */
			 , A.RLBR_TP_CD															/**  Code de catégorie d'introduction/sortie  	!== 반출입구분코드 ==!  */
			 , (SELECT ARRAY_TO_STRING(ARRAY_AGG(A1.CNTR_NO),', ')
		        FROM ALPASSINT.TB_CARI_RLBR_FFMN A1
		       	WHERE 1=1
				AND A1.RLBR_FFMN_MGMT_NO = A.RLBR_RQST_NO
				AND A1.DEL_YN = 'N'
				AND A1.CNTR_NO IS NOT NULL ) AS CNTR_NO
			 , C.JRSD_ORGN_CD
			 , A.JRSD_ORGN_CD
			 , (SELECT C1.ORGN_NM || '(' || C1.ADMN_CD ||')'						/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			    FROM TB_POTI_ORGN C1
			   WHERE C1.DEL_YN = 'N'
			   AND C1.ORGN_MGMT_CD = (select upr_orgn_mgmt_cd from TB_POTI_ORGN where DEL_YN = 'N' and ORGN_CD = C.JRSD_ORGN_CD) ) AS JRSD_ORGN_NM
			 , (SELECT C1.ORGN_NM || '(' || C1.ADMN_CD ||')'						/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			    FROM TB_POTI_ORGN C1
			   WHERE C1.DEL_YN = 'N'
			   AND C1.ORGN_CD = C.JRSD_ORGN_CD ) AS JRSD_CSTM_NM
			 , (SELECT C1.ORGN_NM || '(' || C1.ADMN_CD ||')'
			    FROM TB_POTI_ORGN C1
			   WHERE C1.DEL_YN = 'N'
			   AND C1.ORGN_CD = A.JRSD_ORGN_CD ) AS JRSD_DEPT_NM
			 , TO_CHAR(A.RLBR_DTTM, 'DD/MM/YYYY HH24:MI:SS') AS RLBR_DTTM			/**  Date/Heure d'introduction/sortie  			!== 반출입일시 ==!  */
			 , A.IBOBZ_CD															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
			 , C.IBOBZ_NM															/**  Code de zone sous douane  					!== 보세구역코드 ==!  */
			 , CASE WHEN A.RLBR_TP_CD = 'I' THEN (SELECT CD_VDVAL||' | '||CD_VDVAL_NM FROM ALPASSINT.TB_COM_COMN_CD_D_LANG  WHERE COMN_CD = 'CAR_0006' AND LANG_CD  = 'FR' AND CD_VDVAL = A.RLBR_PT_CD)
			 		ELSE (SELECT CD_VDVAL||' | '||CD_VDVAL_NM FROM ALPASSINT.TB_COM_COMN_CD_D_LANG  WHERE COMN_CD = 'CAR_0007' AND LANG_CD  = 'FR' AND CD_VDVAL = A.RLBR_PT_CD)
			 		END AS RLBR_PT_CD												/**  Code de type d'introduction/sortie  		!== 반출입유형코드 ==!  */
			 , A.CAG_MGMT_NO														/**  Crn  										!== 화물관리번호 ==!  */
			 , A.BL_NO																/**  N° De Bl 								 	!== BL번호 ==!  */
			 , A.PDLS_NM															/**  Nom De L'Article  							!== 품목명 ==!  */
			 , A.RLBR_PCKG_GCNT														/**  Nombre de colis d'introduction/sortie  	!== 반출입포장개수 ==!  */
			 , TRUNC(A.RLBR_WGHT,3)	AS RLBR_WGHT									/**  Poids d'introduction/sortie  				!== 반출입중량 ==!  */
	         , A.DIVD_TP_CD															/**  Code De Type D'Éclatement  				!== 분할구분코드 ==!  */
			 , (SELECT CD_VDVAL||' | '||CD_VDVAL_NM FROM ALPASSINT.TB_COM_COMN_CD_D_LANG  WHERE COMN_CD = 'CAR_0009' AND LANG_CD  = 'FR' AND CD_VDVAL = A.BRNG_ACDN_PT_CD) AS BRNG_ACDN_PT_CD /**  Code de type d'accident de l'introduction  !== 반입사고유형코드 ==!  */
			 , A.BRNG_ACDN_GCNT														/**  Nombre d'accident d'introduction  			!== 반입사고개수 ==!  */
			 , TRUNC(A.BRNG_ACDN_WGHT,3) AS BRNG_ACDN_WGHT							/**  Poids d'accident d'introduction  			!== 반입사고중량 ==!  */
			 , TO_CHAR(A.TRSN_DTTM, 'DD/MM/YYYY') AS TRSN_DTTM						/**  Date et heure de transmission  			!== 전송일시 ==!  */
			 , A.TRSN_CO_CD															/**  Code d'entreprise transmettrice  			!== 전송업체코드 ==!  */
			 , CASE WHEN A.PRCS_STTS_CD IN ('D08','D09') THEN TO_CHAR(A.PRCS_DTTM, 'DD/MM/YYYY')
			        ELSE '' END AS PRCS_DTTM										/**  Date Et Heure De Traitement  				!== 처리일시 ==!  */
			 , A.PRCS_STTS_CD														/**  Code De Statut De Traitement  				!== 처리상태코드 ==!  */
			 , A.RELA_NO															/**  Numéro Concerné  							!== 관련번호 ==!  */
			 , (SELECT CD_VDVAL||' | '||CD_VDVAL_NM FROM ALPASSINT.TB_COM_COMN_CD_D_LANG  WHERE COMN_CD = 'CAR_0021' AND LANG_CD  = 'FR' AND CD_VDVAL = A.PCKG_UT_CD) AS PCKG_UT_CD /**  Code De L'Unité De Colis  					!== 포장단위코드 ==!  */
			 , B.PCKG_GCNT					/**  Nombre De Colis  							 !== 포장개수 ==!  */
			 , TRUNC(B.WGHT,3) AS WGHT  	/**  Poids  									 !== 중량 ==!  	*/
			 , B.CNSI_NM  					/**  Nom de destinataire  						 !== 수하인명 ==!  */
			 , B.CNSI_ADDR  	 			/**  Adresse de destinataire  					 !== 수하인주소 ==! */
			 , B.PDLS_NM  					/**  Nom De L'Article  							 !== 품목명 ==!  */
			 , B.CNSI_NIF                    /**  N° du registre du commerce de destinataire  !== 수하인납세자식별번호,사업자등록번호 ==!  */
		FROM ALPASSEXT.TB_CARE_RLBR A
		   , ALPASSEXT.TB_CARE_RLBR_PRNG B
		   , ALPASSINT.TB_CARI_IBOBZ C
		WHERE 1 = 1
		AND   A.RLBR_PRNG_NO = B.RLBR_PRNG_NO
		AND   A.IBOBZ_CD = C.IBOBZ_CD
		AND   B.DEL_YN = 'N'
		AND   A.DEL_YN = 'N'
	    /**  Code De Statut De Traitement  !== 반입신청번호 ==!  */
	    <if test="rlbrRqstNo != null and rlbrRqstNo != ''">
	    AND  A.RLBR_RQST_NO = #{rlbrRqstNo}
	    </if>
	    <if test="cagMgmtNo != null and cagMgmtNo != ''">
	    AND  A.CAG_MGMT_NO = #{cagMgmtNo}
	    </if>
	    <if test="ibobzCd != null and ibobzCd != ''">
	    AND  A.IBOBZ_CD = #{ibobzCd}
	    </if>

	    <if test="rlbrTpCd != null and rlbrTpCd != ''">
	    AND  A.RLBR_TP_CD = #{rlbrTpCd}
	    </if>

	    /**  N° demande d'introduction/sortie en bloc  !== 일괄반입신청번호 ==!  */
	    <if test="bndlRlbrRqno != null and bndlRlbrRqno != ''">
	    AND  A.BNDL_RLBR_RQNO = #{bndlRlbrRqno}
	    </if>
	</select>

	<!-- 화물통관인터페이스에 등록할 컨테이너정보를 조회한다.  -->
	<select id="selectCagDcshBlCntr" resultType="alpass.ipt.car.com.vo.CarCagCsclIntfCntrVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCagDcshBlCntr */
    	SELECT A.CNTR_NO
    	     , A.CNTR_TP_CD
    	FROM  ALPASSINT.TB_CARI_CAG_DCSH_BL_CNTR A
    	WHERE 1 = 1
    	AND   A.DEL_YN = 'N'
    	AND   A.CAG_MGMT_NO = #{cagMgmtNo}
	</select>

	<!-- 반출입 이행 테이블 조회 -->
	<select id="selectRlbrFfmnList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectRlbrFmnList */
		SELECT A.RLBR_FFMN_MGMT_NO
			 , A.RLBR_FFMN_SRNO
			 , A.CNTR_NO
			 , A.CNTR_TP_CD
			 , A.RLBR_PCKG_GCNT
			 , A.RLBR_WGHT
			 , A.BRNG_ACDN_PT_CD                         /** Code de type d'accident de l'introduction !== 반입사고유형코드 ==! */
			 , A.BRNG_ACDN_GCNT                          /** Nombre d'accident d'introduction !== 반입사고개수 ==! */
			 , A.BRNG_ACDN_WGHT                          /** Poids d'accident d'introduction !== 반입사고중량 ==! */
			 , A.RLBR_VHCL_NO                            /** N° d'immatriculation du véhicule de l'introduction/sortie !== 반출입차량번호 ==! */
			 , NVL(A.RLBR_CFRM_YN, 'N') AS RLBR_CFRM_YN  /** Sortie confirmée ou non !== 반출입확인여부 ==! */
			 , TO_CHAR(A.RLBR_CFRM_DTTM, 'DD/MM/YYYY HH24:MI:SS') AS RLBR_CFRM_DTTM  /** Date/Heure de vérification de l'introduction/sortie !== 반출입확인일시 ==! */
			 ,(	SELECT DECODE(L.EMP_FMNM,NULL,L.EMP_NM,L.EMP_FMNM || ' ' ||L.EMP_NM )
	           	FROM TB_POTI_EMP L
	           	WHERE L.DEL_YN = 'N'
	           	AND L.PBSR_NO = A.RLBR_CFMR_ID) AS RLBR_CFMR_ID
			 , B.CAG_MGMT_NO
			 , B.BL_NO
			 , A.RLSE_GATE_NM
		FROM   ALPASSINT.TB_CARI_RLBR_FFMN A
		   ,   ALPASSINT.TB_CARI_RLBR B
		WHERE  A.RLBR_FFMN_MGMT_NO = B.RLBR_RQST_NO(+)
		<if test="rlbrFfmnMgmtNo != null and rlbrFfmnMgmtNo != ''">
		AND    A.RLBR_FFMN_MGMT_NO = #{rlbrFfmnMgmtNo}
		</if>
		AND    A.DEL_YN = 'N'
		<if test="bndlRlbrRqno != null and bndlRlbrRqno != ''">
		AND    EXISTS ( SELECT 1
						FROM  ALPASSINT.TB_CARI_RLBR A1
						WHERE A1.DEL_YN = 'N'
						AND   A1.RLBR_RQST_NO = A.RLBR_FFMN_MGMT_NO
						AND   A1.BNDL_RLBR_RQNO = #{bndlRlbrRqno})
		</if>
    </select>

	<!--
		[Rechercher] Consulter la liste de contrôle et apurement de la sortie !== 반출 확인 및 이행완료 목록 조회 ==!
    -->
	<select id="selectCarRlbrFfmnList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
    /* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCarRlbrFfmnList */
    <include refid="pagination.header" ></include>
		SELECT
		      A1.FFMN_TP															/** Type d'apurement !== 이행구분 ==! */
			, A1.FFMN_TP_NM
			, A1.RLBR_FFMN_MGMT_NO													/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
			, A1.RLBR_FFMN_SRNO														/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
			, A1.CNTR_NO																/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
			, A1.CNTR_TP_CD															/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
			, A1.RLBR_PCKG_GCNT														/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
			, A1.RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
			, A1.BRNG_ACDN_PT_CD														/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
			, A1.BRNG_ACDN_GCNT														/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
			, A1.BRNG_ACDN_WGHT														/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
			, A1.RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
			, NVL(A1.RLBR_CFRM_YN, 'N') AS RLBR_CFRM_YN								/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
			, TO_CHAR(A1.RLBR_CFRM_DTTM, 'DD/MM/YYYY HH24:MI:SS') AS RLBR_CFRM_DTTM	/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
			, A1.DEL_YN																/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
			, A1.FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
			, TO_CHAR(A1.FRST_RGSR_DTTM, 'DD/MM/YYYY HH24:MI:SS') AS FRST_RGSR_DTTM	/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
			, A1.LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
			, TO_CHAR(A1.LAST_CHG_DTTM, 'DD/MM/YYYY HH24:MI:SS') AS LAST_CHG_DTTM	/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
			, A1.CAG_MGMT_NO														/**  CRN                                      !== 화물관리번호 ==!  */
			, A1.BL_NO
			, A1.RQST_NO
			, A1.MDFY_DGCNT
			, DECODE(B1.EMP_FMNM,NULL,B1.EMP_NM,B1.EMP_FMNM || ' ' ||B1.EMP_NM ) AS RLBR_CFMR_ID		/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
			, A1.RLSE_GATE_NM
			, A1.SEAL_NO
		FROM (
			/** 컨테이너 반출 정보*/
			SELECT
				  'RLSE' AS FFMN_TP														/** Type d'apurement !== 이행구분 ==! */
				, FN_GET_CD_VDVAL_NM('CAR_9020', 'RLSE', #{langCd}) AS FFMN_TP_NM
				, A.RLBR_FFMN_MGMT_NO													/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
				, A.RLBR_FFMN_SRNO														/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
				, A.CNTR_NO																/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
				, A.CNTR_TP_CD															/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
				, A.RLBR_PCKG_GCNT														/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
				, A.RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
				, A.BRNG_ACDN_PT_CD														/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
				, A.BRNG_ACDN_GCNT														/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
				, A.BRNG_ACDN_WGHT														/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
				, A.RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
				, NVL(A.RLBR_CFRM_YN, 'N') AS RLBR_CFRM_YN								/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
				, A.RLBR_CFRM_DTTM														/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
				, A.RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
				, A.DEL_YN																/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
				, A.FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
				, A.FRST_RGSR_DTTM														/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
				, A.LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
				, A.LAST_CHG_DTTM														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
				, B.CAG_MGMT_NO															/**  CRN                                      !== 화물관리번호 ==!  */
				, B.BL_NO
				, C.CNTR_RLBR_RQST_NO AS RQST_NO
				, 0 AS MDFY_DGCNT
				, A.RLSE_GATE_NM
				, '' AS SEAL_NO
			FROM  ALPASSINT.TB_CARI_RLBR_FFMN A
				, ALPASSINT.TB_CARI_CNTR_RLBR_BL B
				, ALPASSINT.TB_CARI_CNTR_RLBR C
				, ALPASSINT.TB_CARI_CAG_PRCS_BRKD D
	        WHERE C.CNTR_RLBR_RQST_NO = A.RLBR_FFMN_MGMT_NO
	        AND   A.RLBR_FFMN_MGMT_NO = B.RLBR_FFMN_MGMT_NO
	        AND   A.RLBR_FFMN_SRNO = B.RLBR_FFMN_SRNO
	        AND   D.CAG_RQST_NO = C.CNTR_RLBR_RQST_NO
			AND   D.PRCS_STTS_CD NOT IN ('D08','D09') /**기각 및 승인 건 제외*/
	        <!-- AND   (D.PRCS_STTS_CD NOT IN ('D08','D09')
	              OR EXISTS (SELECT 1 FROM ALPASSEXT.TB_CARE_TEMP WHERE  WORK_GB = '20240417_RLBR_FFMN' AND DATA1 = A.RLBR_FFMN_MGMT_NO) 
	              ) -->
	        AND   C.RLBR_TP_CD = 'O'
	        AND   D.CAG_RQST_TP_CD = 'CCO'
	        AND   C.DEL_YN = 'N'
	        AND   C.JRSD_ORGN_CD LIKE SUBSTR(#{jrsdOrgnCd}, 1, 5) || '%'
			<if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
				AND (
					(
						C.TRSN_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND C.TRSN_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					) OR (
						C.TRSN_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND C.TRSN_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					)
				)
			</if>
	        UNION
	        /** BL 반출 정보*/
			SELECT
				  'RLSE' AS FFMN_TP														/** Type d'apurement !== 이행구분 ==! */
				, FN_GET_CD_VDVAL_NM('CAR_9020', 'RLSE', #{langCd}) AS FFMN_TP_NM
				, A.RLBR_FFMN_MGMT_NO													/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
				, A.RLBR_FFMN_SRNO														/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
				, A.CNTR_NO																/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
				, A.CNTR_TP_CD															/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
				, A.RLBR_PCKG_GCNT														/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
				, A.RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
				, A.BRNG_ACDN_PT_CD														/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
				, A.BRNG_ACDN_GCNT														/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
				, A.BRNG_ACDN_WGHT														/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
				, A.RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
				, NVL(A.RLBR_CFRM_YN, 'N') AS RLBR_CFRM_YN								/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
				, A.RLBR_CFRM_DTTM														/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
				, A.RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
				, A.DEL_YN																/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
				, A.FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
				, A.FRST_RGSR_DTTM														/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
				, A.LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
				, A.LAST_CHG_DTTM														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
				, B.CAG_MGMT_NO															/**  CRN                                      !== 화물관리번호 ==!  */
				, B.BL_NO
				, B.RLBR_RQST_NO AS RQST_NO
				, 0 AS MDFY_DGCNT
				, A.RLSE_GATE_NM
				, '' AS SEAL_NO
			FROM  ALPASSINT.TB_CARI_RLBR_FFMN A
				, ALPASSINT.TB_CARI_RLBR B
				, ALPASSINT.TB_CARI_CAG_PRCS_BRKD C
	        WHERE A.RLBR_FFMN_MGMT_NO = B.RLBR_RQST_NO
	        AND   B.RLBR_TP_CD = 'O'
	        AND   B.DEL_YN = 'N'
	        AND   B.JRSD_ORGN_CD LIKE SUBSTR(#{jrsdOrgnCd}, 1, 5) || '%'
	        AND   C.CAG_RQST_TP_CD IN ('GCO' ,'DCO')
	        AND   C.CAG_RQST_NO = CASE WHEN B.BNDL_RLBR_RQNO IS NOT NULL THEN B.BNDL_RLBR_RQNO	/** 일괄반출의 경우 일괄반출입번호가 화물처리내역에 있음*/
	        						   ELSE B.RLBR_RQST_NO END
	        AND   C.PRCS_STTS_CD NOT IN ('D08','D09') /**기각 및 승인 건 제외*/
			<if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
				AND (
					(
						B.TRSN_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND B.TRSN_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					) OR (
						B.TRSN_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND B.TRSN_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					)
				)
			</if>
			UNION
			/** ----------------------------- 정정 -------------------------------------*/
			/** 컨테이너 반출 정보*/
			SELECT
				  'RLSE' AS FFMN_TP														/** Type d'apurement !== 이행구분 ==! */
				, FN_GET_CD_VDVAL_NM('CAR_9020', 'RLSE', #{langCd}) AS FFMN_TP_NM
				, A.RLBR_FFMN_MGMT_NO													/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
				, A.RLBR_FFMN_SRNO														/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
				, A.CNTR_NO																/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
				, A.CNTR_TP_CD															/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
				, A.RLBR_PCKG_GCNT														/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
				, A.RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
				, A.BRNG_ACDN_PT_CD														/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
				, A.BRNG_ACDN_GCNT														/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
				, A.BRNG_ACDN_WGHT														/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
				, A.RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
				, NVL(A.RLBR_CFRM_YN, 'N') AS RLBR_CFRM_YN								/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
				, A.RLBR_CFRM_DTTM														/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
				, A.RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
				, A.DEL_YN																/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
				, A.FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
				, A.FRST_RGSR_DTTM														/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
				, A.LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
				, A.LAST_CHG_DTTM														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
				, B.CAG_MGMT_NO															/**  CRN                                      !== 화물관리번호 ==!  */
				, B.BL_NO
				, C.CNTR_RLBR_RQST_NO AS RQST_NO
				, A.MDFY_DGCNT
				, A.RLSE_GATE_NM
				, '' AS SEAL_NO
			FROM  ALPASSINT.TB_CARI_RLBR_MDFY_FFMN A
				, ALPASSINT.TB_CARI_CNTR_RLBR_MDFY_BL B
				, ALPASSINT.TB_CARI_CNTR_RLBR_MDFY C
				, ALPASSINT.TB_CARI_CAG_PRCS_BRKD D
	        WHERE C.CNTR_RLBR_RQST_NO = A.RLBR_FFMN_MGMT_NO
	        AND   A.RLBR_FFMN_MGMT_NO = B.RLBR_FFMN_MGMT_NO
	        AND   A.RLBR_FFMN_SRNO = B.RLBR_FFMN_SRNO
	        AND   A.MDFY_DGCNT = B.MDFY_DGCNT
	        AND   A.MDFY_DGCNT = C.MDFY_DGCNT
      	    AND   A.MDFY_DGCNT = D.RQST_DGCNT
	        AND   D.CAG_RQST_NO = C.CNTR_RLBR_RQST_NO
	        AND   D.PRCS_STTS_CD NOT IN ('D08','D09') /**기각 및 승인 건 제외*/
	        AND   D.CAG_RQST_TP_CD = 'CMO'
	        AND   C.RLBR_TP_CD = 'O'
	        AND   C.DEL_YN = 'N'
	        AND   C.JRSD_ORGN_CD LIKE SUBSTR(#{jrsdOrgnCd}, 1, 5) || '%'
			<if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
				AND (
					(
						C.TRSN_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND C.TRSN_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					) OR (
						C.TRSN_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND C.TRSN_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					)
				)
			</if>
	        UNION
	        /** BL 반출 정보*/
			SELECT
			      'RLSE' AS FFMN_TP														/** Type d'apurement !== 이행구분 ==! */
				, FN_GET_CD_VDVAL_NM('CAR_9020', 'RLSE', #{langCd}) AS FFMN_TP_NM
				, A.RLBR_FFMN_MGMT_NO													/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
				, A.RLBR_FFMN_SRNO														/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
				, A.CNTR_NO																/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
				, A.CNTR_TP_CD															/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
				, A.RLBR_PCKG_GCNT														/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
				, A.RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
				, A.BRNG_ACDN_PT_CD														/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
				, A.BRNG_ACDN_GCNT														/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
				, A.BRNG_ACDN_WGHT														/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
				, A.RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
				, NVL(A.RLBR_CFRM_YN, 'N') AS RLBR_CFRM_YN								/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
				, A.RLBR_CFRM_DTTM														/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
				, A.RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
				, A.DEL_YN																/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
				, A.FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
				, A.FRST_RGSR_DTTM														/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
				, A.LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
				, A.LAST_CHG_DTTM														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
				, B.CAG_MGMT_NO															/**  CRN                                      !== 화물관리번호 ==!  */
				, B.BL_NO
				, B.RLBR_RQST_NO AS RQST_NO
				, A.MDFY_DGCNT
				, A.RLSE_GATE_NM
				, '' AS SEAL_NO
			FROM  ALPASSINT.TB_CARI_RLBR_MDFY_FFMN A
				, ALPASSINT.TB_CARI_RLBR_MDFY B
				, ALPASSINT.TB_CARI_CAG_PRCS_BRKD C
	        WHERE A.RLBR_FFMN_MGMT_NO = B.RLBR_RQST_NO
	        AND   C.CAG_RQST_NO = B.RLBR_RQST_NO
	        AND   A.MDFY_DGCNT = B.MDFY_DGCNT
	        AND   A.MDFY_DGCNT = C.RQST_DGCNT
	        AND   B.RLBR_TP_CD = 'O'
	        AND   B.DEL_YN = 'N'
	        AND   B.JRSD_ORGN_CD LIKE SUBSTR(#{jrsdOrgnCd}, 1, 5) || '%'
	        AND   C.CAG_RQST_TP_CD= 'GMO'
	        AND   C.PRCS_STTS_CD NOT IN ('D08','D09') /**기각 및 승인 건 제외*/
			<if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
				AND (
					(
						B.TRSN_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND B.TRSN_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					) OR (
						B.TRSN_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND B.TRSN_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					)
				)
			</if>
	        UNION
			/** 운송_반출입_이행 */
			SELECT
				  'TRNP' AS FFMN_TP														/** Type d'apurement !== 이행구분 ==! */
				, FN_GET_CD_VDVAL_NM('CAR_9020', 'TRNP', #{langCd}) AS FFMN_TP_NM
				, A.TRNP_RLBR_FFMN_MGMT_NO AS RLBR_FFMN_MGMT_NO							/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
				, A.TRNP_RLBR_FFMN_SRNO AS RLBR_FFMN_SRNO								/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
				, A.CNTR_NO																/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
				, A.CNTR_TP_CD															/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
				, A.RLBR_PCKG_GCNT														/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
				, A.RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
				, '' AS BRNG_ACDN_PT_CD														/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
				, 0 AS BRNG_ACDN_GCNT														/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
				, 0 AS BRNG_ACDN_WGHT														/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
				, A.RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
				, NVL(A.RLBR_CFRM_YN, 'N') AS RLBR_CFRM_YN								/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
				, A.RLBR_CFRM_DTTM														/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
				, A.RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
				, A.DEL_YN																/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
				, A.FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
				, A.FRST_RGSR_DTTM														/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
				, A.LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
				, A.LAST_CHG_DTTM														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
				, A.CAG_MGMT_NO															/**  CRN                                      !== 화물관리번호 ==!  */
				, A.BL_NO
				, A.TRNP_RLBR_FFMN_MGMT_NO AS RQST_NO
				, 0 AS MDFY_DGCNT
				, A.RLSE_GATE_NM
				, A.SEAL_NO
			FROM  ALPASSINT.TB_CARI_TRNP_RLBR_FFMN A	/* CARI_운송_반출입_이행 */
			    , ALPASSINT.TB_CARI_TRNP B				/* CARI_운송 */
	        WHERE A.TRNP_RLBR_FFMN_MGMT_NO = B.TRNP_RQST_NO
	        AND   B.DEL_YN = 'N'
			AND   B.JRSD_ORGN_CD LIKE SUBSTR(#{jrsdOrgnCd}, 1, 5) || '%'
			AND NOT EXISTS (
				SELECT 1
				FROM  ALPASSINT.TB_CARI_RLBR TCR
				   ,  ALPASSINT.TB_CARI_CAG_PRCS_BRKD TCCPB
				WHERE (TCR.RLBR_RQST_NO = TCCPB.CAG_RQST_NO OR TCR.BNDL_RLBR_RQNO = TCCPB.CAG_RQST_NO)
				AND   TCR.CAG_MGMT_NO = A.CAG_MGMT_NO
				AND   TCR.DEL_YN = 'N'
				AND   TCCPB.DEL_YN = 'N'
				AND   TCR.RLBR_TP_CD = 'I'
				AND   TCR.DIVD_TP_CD IN ('T', 'D')
				AND   TCCPB.PRCS_STTS_CD  = 'D08'
			)
			<if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
				AND (
					(
						A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					) OR (
						A.FRST_RGSR_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
						AND A.FRST_RGSR_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
					)
				)
			</if>
		) A1
		, ALPASSINT.TB_POTI_EMP B1
		WHERE 1 = 1
		AND   B1.DEL_YN(+) = 'N'
	    AND   B1.PBSR_NO(+) = A1.RLBR_CFMR_ID
		/**  Date de constatation de sortie !== 반출확인일자 ==! */
		<if test="(searchKeywordFrom2 != null and searchKeywordFrom2 != '') and (searchKeywordTo2 != null and searchKeywordTo2 != '')">
			AND (
				(
					A1.RLBR_CFRM_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom2}, 'DD/MM/YYYY')
					AND A1.RLBR_CFRM_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
				) OR (
					A1.RLBR_CFRM_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom2}, 'DD/MM/YYYY')
					AND A1.RLBR_CFRM_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo2}, 'DD/MM/YYYY')+0.9999
				)
			)
		</if>
		<if test="ffmnTp != null">/** Type d'apurement !== 이행구분 ==! */
			<if test='ffmnTp.equals("RLSE")'>
				AND A1.FFMN_TP = 'RLSE'
			</if>
			<if test='ffmnTp.equals("TRNP")'>
				AND A1.FFMN_TP = 'TRNP'
			</if>
		</if>
		<if test="rlbrVhclNo != null and rlbrVhclNo != ''">/** N° d'immatriculation du véhicule de l'introduction/sortie !== 반출입차량번호 ==! */
			AND A1.RLBR_VHCL_NO LIKE #{rlbrVhclNo} || '%'
		</if>
		<if test="cntrNo != null and cntrNo != ''">/** N° du conteneur  !== 컨테이너번호 ==! */
			AND A1.CNTR_NO  = #{cntrNo}
		</if>
		<if test="cagMgmtNo != null and cagMgmtNo != ''">/**  Crn                                      !== 화물관리번호 ==!  */
			AND A1.CAG_MGMT_NO LIKE #{cagMgmtNo} || '%'
		</if>
		<if test="blNo != null and blNo != ''">/**  N° de B/L !== BL번호 ==!  */
			AND A1.BL_NO = #{blNo}
		</if>
		<if test="rlbrCfrmYn != null and rlbrCfrmYn != ''">
			AND A1.RLBR_CFRM_YN = #{rlbrCfrmYn}
		</if>

		ORDER BY A1.FRST_RGSR_DTTM DESC
    <include refid="pagination.footer" ></include>
	</select>

	<!--
		Modifier l'état de vérification du contrôle et apurement de la sortie( TB_CARI_TRNP_RLBR_FFMN )
		!== 반출 확인 및 이행완료 확인상태를 변경( CARI_운송_반출입_이행 ) ==!
	-->
	<update id="updateCarTrnpRlbrFfmnCfrmYn" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCarTrnpRlbrFfmnCfrmYn */
		UPDATE TB_CARI_TRNP_RLBR_FFMN
		SET
		<choose>
			<when test='rlbrCfrmYn != null and rlbrCfrmYn.equals("Y")'>
				RLBR_CFRM_YN   = 'Y'
				, RLBR_CFRM_DTTM = SYSTIMESTAMP
				, RLBR_CFMR_ID   = #{lastChprId}
				, RLSE_GATE_NM   = #{rlseGateNm}
				, RLBR_VHCL_NO   = #{rlbrVhclNo}
				, SEAL_NO        = #{sealNo}
			</when>
			<otherwise>
				RLBR_CFRM_YN   = 'N'
				, RLBR_CFRM_DTTM = NULL
				, RLBR_CFMR_ID   = NULL
				, RLSE_GATE_NM   = NULL
				, RLBR_VHCL_NO   = NULL
				, SEAL_NO        = NULL
			</otherwise>
		</choose>
		, LAST_CHPR_ID = #{lastChprId}
		, LAST_CHG_DTTM = SYSTIMESTAMP
		WHERE DEL_YN = 'N'
		AND TRNP_RLBR_FFMN_MGMT_NO = #{rlbrFfmnMgmtNo}		/** N° gestion de l'apurement de l'introduction/sortie du transfert  !== 운송반출입이행관리번호 ==! */
		AND TRNP_RLBR_FFMN_SRNO = #{rlbrFfmnSrno}			/** N° série de l'apurement de l'introduction/sortie du transfert    !== 운송반출입이행일련번호 ==! */
	</update>

	<!--
		Modifier l'état de vérification du contrôle et apurement de la sortie
		!== 반출 확인 및 이행완료 확인상태를 변경 ==!
	-->
	<update id="updateCarRlbrFfmnCfrmYn" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCarRlbrFfmnCfrmYn */
		UPDATE TB_CARI_RLBR_FFMN
		SET
			<choose>
				<when test='rlbrCfrmYn != null and rlbrCfrmYn.equals("Y")'>
					  RLBR_CFRM_YN   = 'Y'
					, RLBR_CFRM_DTTM = SYSTIMESTAMP
					, RLBR_CFMR_ID   = #{lastChprId}
					, RLSE_GATE_NM   = #{rlseGateNm}
					, RLBR_VHCL_NO   = #{rlbrVhclNo}
				</when>
				<otherwise>
					  RLBR_CFRM_YN   = 'N'
					, RLBR_CFRM_DTTM = NULL
					, RLBR_CFMR_ID   = NULL
					, RLSE_GATE_NM   = NULL
					, RLBR_VHCL_NO   = NULL
				</otherwise>
			</choose>
		  , LAST_CHPR_ID = #{lastChprId}
		  , LAST_CHG_DTTM = SYSTIMESTAMP
		WHERE DEL_YN = 'N'
		  AND RLBR_FFMN_MGMT_NO = #{rlbrFfmnMgmtNo}		/** N° de gestion de l'apurement de l'introduction/sortie  !== 반출입이행관리번호 ==! */
		  AND RLBR_FFMN_SRNO = #{rlbrFfmnSrno}			/** N° de série de l'apurement de l'introduction/sortie    !== 반출입이행일련번호 ==! */
	</update>
	<!--
		Modifier l'état de vérification du contrôle et apurement de la sortie
		!== [정정] 반출 확인 및 이행완료 확인상태를 변경  ==!
	-->
	<update id="updateCarRlbrMdfyFfmnCfrmYn" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCarRlbrMdfyFfmnCfrmYn */
		UPDATE TB_CARI_RLBR_MDFY_FFMN
		SET
			<choose>
				<when test='rlbrCfrmYn != null and rlbrCfrmYn.equals("Y")'>
					  RLBR_CFRM_YN   = 'Y'
					, RLBR_CFRM_DTTM = SYSTIMESTAMP
					, RLBR_CFMR_ID   = #{lastChprId}
					, RLSE_GATE_NM   = #{rlseGateNm}
					, RLBR_VHCL_NO   = #{rlbrVhclNo}
				</when>
				<otherwise>
					  RLBR_CFRM_YN   = 'N'
					, RLBR_CFRM_DTTM = NULL
					, RLBR_CFMR_ID   = NULL
					, RLSE_GATE_NM   = NULL
					, RLBR_VHCL_NO   = NULL
				</otherwise>
			</choose>
		  , LAST_CHPR_ID = #{lastChprId}
		  , LAST_CHG_DTTM = SYSTIMESTAMP
		WHERE DEL_YN = 'N'
		  AND RLBR_FFMN_MGMT_NO = #{rlbrFfmnMgmtNo}		/** N° de gestion de l'apurement de l'introduction/sortie  !== 반출입이행관리번호 ==! */
		  AND RLBR_FFMN_SRNO = #{rlbrFfmnSrno}			/** N° de série de l'apurement de l'introduction/sortie    !== 반출입이행일련번호 ==! */
		  AND MDFY_DGCNT = #{mdfyDgcnt}
	</update>

  <!--
   [Enregistrer] Enregistrer la TB_CARE_RLBR_MDFY_FFMN
   !== TB_CARE_RLBR_MDFY_FFMN 반출입 이행 정정 등록 ==!
   -->
	<insert id="insertRlbrFfmnMdfyEpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
  	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.insertRlbrFfmnMdfyEpt */
   INSERT INTO ALPASSEXT.TB_CARE_RLBR_MDFY_FFMN (
		  RLBR_FFMN_MGMT_NO													/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
		, RLBR_FFMN_SRNO													/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
		, MDFY_DGCNT														/**  Fréquence de rectification  				!== 정정차수 ==!  */
		, CNTR_NO															/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
		, CNTR_TP_CD														/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
		, RLBR_PCKG_GCNT													/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
		, RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
		, BRNG_ACDN_PT_CD													/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
		, BRNG_ACDN_GCNT													/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
		, BRNG_ACDN_WGHT													/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
		, RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
		, RLBR_CFRM_YN														/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
		, RLBR_CFRM_DTTM													/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
		, RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
		, DEL_YN															/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
		, FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
		, FRST_RGSR_DTTM													/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
		, LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
		, LAST_CHG_DTTM														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
		, RLSE_GATE_NM
     	)
	SELECT RLBR_FFMN_MGMT_NO												/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
		 , RLBR_FFMN_SRNO													/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
		 , 0																/**  Fréquence de rectification  				!== 정정차수 ==!  */
		 , CNTR_NO															/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
		 , CNTR_TP_CD														/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
		 , RLBR_PCKG_GCNT													/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
		 , RLBR_WGHT														/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
		 , BRNG_ACDN_PT_CD													/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
		 , BRNG_ACDN_GCNT													/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
		 , BRNG_ACDN_WGHT													/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
		 , RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
		 , RLBR_CFRM_YN														/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
		 , RLBR_CFRM_DTTM													/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
		 , RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
		 , DEL_YN															/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
		 , FRST_REGST_ID													/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
		 , SYSTIMESTAMP														/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
		 , LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
		 , SYSTIMESTAMP														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
		 , RLSE_GATE_NM
	FROM  ALPASSINT.TB_CARI_RLBR_FFMN
	WHERE DEL_YN = 'N'
	AND   RLBR_FFMN_MGMT_NO = #{rlbrRqstNo}
	</insert>

  <!--
   [Enregistrer] Enregistrer la TB_CARI_RLBR_MDFY_FFMN
   !== TB_CARI_RLBR_MDFY_FFMN 반출입 이행 정정 등록 ==!
   -->
	<insert id="insertRlbrFfmnMdfyIpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
  	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.insertRlbrFfmnMdfyIpt */
   INSERT INTO ALPASSINT.TB_CARI_RLBR_MDFY_FFMN (
		  RLBR_FFMN_MGMT_NO													/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
		, RLBR_FFMN_SRNO													/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
		, MDFY_DGCNT														/**  Fréquence de rectification  				!== 정정차수 ==!  */
		, CNTR_NO															/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
		, CNTR_TP_CD														/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
		, RLBR_PCKG_GCNT													/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
		, RLBR_WGHT															/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
		, BRNG_ACDN_PT_CD													/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
		, BRNG_ACDN_GCNT													/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
		, BRNG_ACDN_WGHT													/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
		, RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
		, RLBR_CFRM_YN														/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
		, RLBR_CFRM_DTTM													/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
		, RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
		, DEL_YN															/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
		, FRST_REGST_ID														/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
		, FRST_RGSR_DTTM													/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
		, LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
		, LAST_CHG_DTTM														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
		, RLSE_GATE_NM
     	)
	SELECT RLBR_FFMN_MGMT_NO												/** N° DE GESTION DE L'APUREMENT DE L'INTRODUCTION/SORTIE  !== 반출입이행관리번호 ==! */
		 , RLBR_FFMN_SRNO													/** N° DE SÉRIE DE L'APUREMENT DE L'INTRODUCTION/SORTIE    !== 반출입이행일련번호 ==! */
		 , 0																/**  Fréquence de rectification  				!== 정정차수 ==!  */
		 , CNTR_NO															/** N° DU CONTENEUR  !== 컨테이너번호 ==! */
		 , CNTR_TP_CD														/** CODE DE TYPE DE CONTENEUR !== 컨테이너구분코드 ==! */
		 , RLBR_PCKG_GCNT													/** NOMBRE DE COLIS D'INTRODUCTION/SORTIE !== 반출입포장개수 ==! */
		 , RLBR_WGHT														/** POIDS D'INTRODUCTION/SORTIE !== 반출입중량 ==! */
		 , BRNG_ACDN_PT_CD													/** CODE DE TYPE D'ACCIDENT DE L'INTRODUCTION !== 반입사고유형코드 ==! */
		 , BRNG_ACDN_GCNT													/** NOMBRE D'ACCIDENT D'INTRODUCTION !== 반입사고개수 ==! */
		 , BRNG_ACDN_WGHT													/** POIDS D'ACCIDENT D'INTRODUCTION !== 반입사고중량 ==! */
		 , RLBR_VHCL_NO														/** N° D'IMMATRICULATION DU VÉHICULE DE L'INTRODUCTION/SORTIE !== 반출입차량번호 ==! */
		 , RLBR_CFRM_YN														/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
		 , RLBR_CFRM_DTTM													/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
		 , RLBR_CFMR_ID														/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
		 , DEL_YN															/**  SUPPRESSION ON                           !== 삭제여부 ==!  */
		 , FRST_REGST_ID													/**  ID DU PREMIER ENREGISTRANT   				!== 최초등록자ID ==!  */
		 , SYSTIMESTAMP														/**  DATE ET HEURE DE PREMIER ENREGISTREMENT  	!== 최초등록일시 ==!  */
		 , LAST_CHPR_ID														/**  ID DU MODIFICATEUR FINAL  					!== 최종변경자ID ==!  */
		 , SYSTIMESTAMP														/**  DATE ET HEURE DE MODIFICATION FINALE  		!== 최종변경일시 ==!  */
		 , RLSE_GATE_NM
	FROM  ALPASSINT.TB_CARI_RLBR_FFMN
	WHERE DEL_YN = 'N'
	AND   RLBR_FFMN_MGMT_NO = #{rlbrRqstNo}
	</insert>

	<!-- 반출입 이행 정정 테이블 조회 -->
	<select id="selectCarRlbrMdfyFfmnList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
    	/** alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCarRlbrMdfyFfmnList */
		SELECT A.RLBR_FFMN_MGMT_NO				/** N° de gestion de l'apurement de l'introduction/sortie  !== 반출입이행관리번호 ==! */
			 , A.RLBR_FFMN_SRNO					/** N° de série de l'apurement de l'introduction/sortie    !== 반출입이행일련번호 ==! */
			 , A.MDFY_DGCNT						/**  Fréquence de rectification  				!== 정정차수 ==!  */
			 , A.CNTR_NO                        /** N° du conteneur  !== 컨테이너번호 ==! */
			 , A.CNTR_TP_CD                     /** Code de type de conteneur !== 컨테이너구분코드 ==! */
			 , A.RLBR_PCKG_GCNT                 /** Nombre de colis d'introduction/sortie !== 반출입포장개수 ==! */
			 , A.RLBR_WGHT                      /** Poids d'introduction/sortie !== 반출입중량 ==! */
			 , A.RLBR_VHCL_NO                   /** N° d'immatriculation du véhicule de l'introduction/sortie !== 반출입차량번호 ==! */
			 , NVL(A.RLBR_CFRM_YN,'N') AS RLBR_CFRM_YN	/** SORTIE CONFIRMÉE OU NON !== 반출입확인여부 ==! */
			 , TO_CHAR(A.RLBR_CFRM_DTTM, 'DD/MM/YYYY HH24:MI:SS') AS RLBR_CFRM_DTTM	/** DATE/HEURE DE VÉRIFICATION DE L'INTRODUCTION/SORTIE !== 반출입확인일시 ==! */
			 ,(	SELECT DECODE(L.EMP_FMNM,NULL,L.EMP_NM,L.EMP_FMNM || ' ' ||L.EMP_NM )
	           	FROM TB_POTI_EMP L
	           	WHERE L.DEL_YN = 'N'
	           	AND L.PBSR_NO = A.RLBR_CFMR_ID) AS RLBR_CFMR_ID	/** ID DU VÉRIFICATEUR DE L'INTRODUCTION/SORTIE !== 반출입확인자ID ==! */
			 , B.CAG_MGMT_NO
			 , B.BL_NO
			 , A.RLSE_GATE_NM
		FROM   ALPASSINT.TB_CARI_RLBR_MDFY_FFMN A
		   ,   ALPASSINT.TB_CARI_RLBR_MDFY B
		WHERE  A.RLBR_FFMN_MGMT_NO = B.RLBR_RQST_NO(+)
		AND    A.MDFY_DGCNT = B.MDFY_DGCNT(+)
		AND    A.RLBR_FFMN_MGMT_NO = #{rlbrFfmnMgmtNo}
		AND    A.MDFY_DGCNT = #{mdfyDgcnt}
		AND    A.DEL_YN = 'N'
    </select>

	<!-- !== [ept] TB_CARE_RLBR_FFMN 반출입 이행 테이블 수정 ==!-->
	<update id="updateCarRlbrFfmnEpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
		/** alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCarRlbrFfmnEpt */
		UPDATE ALPASSEXT.TB_CARE_RLBR_FFMN SET
			  DEL_YN 			= NVL(#{delYn},'N')     /**  Suppression On                           	!== 삭제여부 ==!  */
			, LAST_CHPR_ID 		= #{lastChprId}         /**  Id Du Modificateur Final                 	!== 최종변경자ID ==!  */
			, LAST_CHG_DTTM 	= SYSTIMESTAMP			/**  Date Et Heure De Modification Finale     	!== 최종변경일시 ==!  */
		<if test="rlbrPckgGcnt != null and rlbrPckgGcnt != ''">
			, RLBR_PCKG_GCNT 	= #{rlbrPckgGcnt}       /** Nombre de colis d'introduction/sortie 		!== 반출입포장개수 ==! */
		</if>
		<if test="rlbrWght != null and rlbrWght != ''">
			, RLBR_WGHT 		= #{rlbrWght}           /** Poids d'introduction/sortie 				!== 반출입중량 ==! */
		</if>
		<if test="brngAcdnPtCd != null and brngAcdnPtCd != ''">
			, BRNG_ACDN_PT_CD 	= #{brngAcdnPtCd}       /** Code de type d'accident de l'introduction 	!== 반입사고유형코드 ==! */
		</if>
		<if test="brngAcdnGcnt != null and brngAcdnGcnt != ''">
			, BRNG_ACDN_GCNT 	= #{brngAcdnGcnt}       /** Nombre d'accident d'introduction 			!== 반입사고개수 ==! */
		</if>
		<if test="brngAcdnWght != null and brngAcdnWght != ''">
			, BRNG_ACDN_WGHT 	= #{brngAcdnWght}       /** Poids d'accident d'introduction 			!== 반입사고중량 ==! */
		</if>
		<if test="rlbrVhclNo != null and rlbrVhclNo != ''">
			, RLBR_VHCL_NO 		= #{rlbrVhclNo}         /** N° d'immatriculation du véhicule de l'introduction/sortie !== 반출입차량번호 ==! */
		</if>
		<if test="rlbrCfrmYn != null and rlbrCfrmYn != ''">
			, RLBR_CFRM_YN 		= #{rlbrCfrmYn}         /** Sortie confirmée ou non 					!== 반출입확인여부 ==! */
		</if>
		<if test="rlbrCfrmDttm != null and rlbrCfrmDttm != ''">
			, RLBR_CFRM_DTTM 	= TO_DATE(#{rlbrCfrmDttm})       /** Date/Heure de vérification de l'introduction/sortie !== 반출입확인일시 ==! */
		</if>
		<if test="rlbrCfmrId != null and rlbrCfmrId != ''">
			, RLBR_CFMR_ID 		= #{rlbrCfmrId}         /** ID du vérificateur de l'introduction/sortie !== 반출입확인자ID ==! */
		</if>
		<if test="rlseGateNm != null and rlseGateNm != ''">
			, RLSE_GATE_NM 		= #{rlseGateNm}
		</if>
		WHERE RLBR_FFMN_MGMT_NO = #{rlbrFfmnMgmtNo}     /** N° de gestion de l'apurement de l'introduction/sortie  !== 반출입이행관리번호 ==! */
		<if test="rlbrFfmnSrno != null and rlbrFfmnSrno != ''">
		AND   RLBR_FFMN_SRNO = #{rlbrFfmnSrno}          /** N° de série de l'apurement de l'introduction/sortie    !== 반출입이행일련번호 ==! */
		</if>
	</update>

	<!-- !== [ipt] TB_CARI_RLBR_FFMN 반출입 이행 테이블 수정 ==!-->
	<update id="updateCarRlbrFfmnIpt" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
		/** alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.updateCarRlbrFfmnIpt */
		UPDATE ALPASSINT.TB_CARI_RLBR_FFMN SET
			  DEL_YN 			= NVL(#{delYn},'N')     /**  Suppression On                           	!== 삭제여부 ==!  */
			, LAST_CHPR_ID 		= #{lastChprId}         /**  Id Du Modificateur Final                 	!== 최종변경자ID ==!  */
			, LAST_CHG_DTTM 	= SYSTIMESTAMP			/**  Date Et Heure De Modification Finale     	!== 최종변경일시 ==!  */
		<if test="rlbrPckgGcnt != null and rlbrPckgGcnt != ''">
			, RLBR_PCKG_GCNT 	= #{rlbrPckgGcnt}       /** Nombre de colis d'introduction/sortie 		!== 반출입포장개수 ==! */
		</if>
		<if test="rlbrWght != null and rlbrWght != ''">
			, RLBR_WGHT 		= #{rlbrWght}           /** Poids d'introduction/sortie 				!== 반출입중량 ==! */
		</if>
		<if test="brngAcdnPtCd != null and brngAcdnPtCd != ''">
			, BRNG_ACDN_PT_CD 	= #{brngAcdnPtCd}       /** Code de type d'accident de l'introduction 	!== 반입사고유형코드 ==! */
		</if>
		<if test="brngAcdnGcnt != null and brngAcdnGcnt != ''">
			, BRNG_ACDN_GCNT 	= #{brngAcdnGcnt}       /** Nombre d'accident d'introduction 			!== 반입사고개수 ==! */
		</if>
		<if test="brngAcdnWght != null and brngAcdnWght != ''">
			, BRNG_ACDN_WGHT 	= #{brngAcdnWght}       /** Poids d'accident d'introduction 			!== 반입사고중량 ==! */
		</if>
		<if test="rlbrVhclNo != null and rlbrVhclNo != ''">
			, RLBR_VHCL_NO 		= #{rlbrVhclNo}         /** N° d'immatriculation du véhicule de l'introduction/sortie !== 반출입차량번호 ==! */
		</if>
		<if test="rlbrCfrmYn != null and rlbrCfrmYn != ''">
			, RLBR_CFRM_YN 		= #{rlbrCfrmYn}         /** Sortie confirmée ou non 					!== 반출입확인여부 ==! */
		</if>
		<if test="rlbrCfrmDttm != null and rlbrCfrmDttm != ''">
			, RLBR_CFRM_DTTM 	= TO_DATE(#{rlbrCfrmDttm})       /** Date/Heure de vérification de l'introduction/sortie !== 반출입확인일시 ==! */
		</if>
		<if test="rlbrCfmrId != null and rlbrCfmrId != ''">
			, RLBR_CFMR_ID 		= #{rlbrCfmrId}         /** ID du vérificateur de l'introduction/sortie !== 반출입확인자ID ==! */
		</if>
		<if test="rlseGateNm != null and rlseGateNm != ''">
			, RLSE_GATE_NM 		= #{rlseGateNm}
		</if>
		WHERE RLBR_FFMN_MGMT_NO = #{rlbrFfmnMgmtNo}     /** N° de gestion de l'apurement de l'introduction/sortie  !== 반출입이행관리번호 ==! */
		<if test="rlbrFfmnSrno != null and rlbrFfmnSrno != ''">
		AND   RLBR_FFMN_SRNO = #{rlbrFfmnSrno}          /** N° de série de l'apurement de l'introduction/sortie    !== 반출입이행일련번호 ==! */
		</if>
	</update>

  <!--  ############################## 0210, 0211 ############################## -->
  <!--
    [Rechercher] Consulter la liste des "Demande d'accord préalable de l'exploitation de la zone sous douane"
    !== 반출입 예정 목록 조회 0210, 0211 ==!
   -->
	<select id="selectCagBrngRlbrPrngList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrPrngVo">
		/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCagBrngRlbrPrngList */
		<include refid="pagination.header" ></include>
		SELECT
	           A.RLBR_PRNG_NO     /*rlbr_prng_noN° Introduction/Sortie Prévue  		 !== 반출입예정번호 ==!*/
			 , A.RLBR_TP_CD     	/*rlbr_tp_cdCode de catégorie d'introduction/sortie  !== 반출입구분코드 ==!*/
			 , A.RLBR_PT_CD     	/*rlbr_pt_cdCode de type d'introduction/sortie  	 !== 반출입유형코드 ==!*/
			 , A.IBOBZ_CD     	/*ibobz_cdCode de zone sous douane  			     !== 보세구역코드 ==!*/
			 , A.CAG_MGMT_NO      /*cag_mgmt_noCrn  									 !== 화물관리번호 ==!*/
			 , A.BL_NO     		/*bl_noN° De  Bl									 !== BL번호 ==!*/
			 , A.RELA_NO     		/*rela_noNuméro Concerné  							 !== 관련번호 ==!*/
			 , TO_DATE(A.APRE_DT, 'YYYY/MM/DD') AS APRE_DT     		/*apre_dtDate D'Autorisation  !== 승인일자 ==!*/
			 , A.PCKG_GCNT    	/*pckg_gcntNombre De Colis  						     !== 포장개수 ==!*/
			 , A.WGHT    		/*wghtPoids  										     !== 중량 ==!*/
			 , A.RLBR_PCKG_GCNT   /*rlbr_pckg_gcntNombre de colis d'introduction/sortie    !== 반출입포장개수 ==!*/
			 , A.RLBR_WGHT     	/*rlbr_wghtPoids d'introduction/sortie  			     !== 반출입중량 ==!*/
			 , A.RLBR_CMPL_YN     /*rlbr_cmpl_ynFin d'introduction/sortie   			     !== O/N반출입완료여부 ==!*/
			 , A.DEL_YN     		/*del_ynSuppression On  							     !== 삭제여부 ==!*/
			 , A.FRST_REGST_ID    /*frst_regst_idId Du Premier Enregistrant  			     !== 최초등록자ID ==!*/
			 , A.FRST_RGSR_DTTM   /*frst_rgsr_dttmDate Et Heure De Premier Enregistrement  !== 최초등록일시 ==!*/
			 , A.LAST_CHPR_ID     /*last_chpr_idId Du Modificateur Final  				 !== 최종변경자ID ==!*/
			 , A.LAST_CHG_DTTM    /*last_chg_dttmDate Et Heure De Modification Finale      !== 최종변경일시 ==!*/
			 , A.PCKG_GCNT		/**  Nombre De Colis  							 !== 포장개수 ==!  */
			 , A.WGHT  			/**  Poids  									 !== 중량 ==!  	*/
			 , A.CNSI_NM  		/**  Nom de destinataire  						 !== 수하인명 ==!  */
			 , A.CNSI_ADDR  		/**  Adresse de destinataire  					 !== 수하인주소 ==! */
			 , A.PDLS_NM  		/**  Nom De L'Article  !== 품목명 ==!  */
			 , A.CNSI_NIF         /**  N° du registre du commerce de destinataire  !== 수하인납세자식별번호,사업자등록번호 ==!  */
			 , B.IBOBZ_NM 		/**  Nom de la zone sous douane               !== 보세구역명 ==!  */
			 , A.EXP_CMDT_BRNG_RQNO
		FROM ALPASSEXT.TB_CARE_RLBR_PRNG A
		   , ALPASSINT.TB_CARI_IBOBZ B
		WHERE 1 = 1
		AND   A.IBOBZ_CD = B.IBOBZ_CD
		AND   B.DEL_YN = 'N'
		<if test="sctrCd != null and sctrCd != ''">
			AND SUBSTRING(B.JRSD_ORGN_CD,1,3) LIKE SUBSTRING(#{sctrCd},1,3) || '%'				/** Code de DRD !== DRD코드==! */
		</if>

		<if test="cstmCd != null and cstmCd != ''">
			AND SUBSTRING(B.JRSD_ORGN_CD,1,5) LIKE SUBSTRING(#{cstmCd},1,5) || '%'				/**  Code D'Unité Compétente  !== 관할조직코드 ==!  */
		</if>
		<!-- <choose><when test="@alpass.ipt.car.com.util.CarMyBatisUtil@isEqualsStr(csbrYn,'Y')">
		AND   B.IBOBZ_CO_CD = '00000'
		</when><otherwise>
		AND   EXISTS ( SELECT 1
					   FROM  ALPASSEXT.TB_COM_CO_DCLR_CD A1
					   WHERE 1 = 1
					   AND   A1.CO_DCLR_CD = B.IBOBZ_CO_CD
					   AND   A1.CO_DCLR_TP_CD = 'F'
					   AND   A1.NIF = #{nif}
					   AND   A1.DEL_YN = 'N'
					   AND   A1.RQST_TP_CD IN ('01','02') /* 신규나/수정 상태*/
					   AND   A1.PRCS_STTS_CD = 'O' /* 업체  승인상태 */
					   AND   A1.USE_YN = 'Y' /* 사용여부 */)
		</otherwise></choose> -->
		AND	  A.DEL_YN = 'N'   /** Suppression ON 			!== 삭제여부 ==! */
		AND   A.RLBR_CMPL_YN = 'N'
	    /**  Date et heure de transmission  !== 승인일자 ==!  */
	    <if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
		AND (
		        (
		          TO_DATE(A.APRE_DT,'YYYY/MM/DD') <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
		          AND TO_DATE(A.APRE_DT,'YYYY/MM/DD') <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
		        )
			)
	    </if>

		/**  Code De Statut De Traitement  					!== 화물관리번호 ==!  */
	    <if test="cagMgmtNo != null and cagMgmtNo != ''">
		AND  A.CAG_MGMT_NO LIKE #{cagMgmtNo} || '%'
	    </if>

	    /**  Code De Statut De Traitement  					!== 반출입유형코드 ==!  */
	    <if test="rlbrPtCd != null and rlbrPtCd != ''">
		AND  A.RLBR_PT_CD = #{rlbrPtCd}
	    </if>

	     /**  Code De Statut De Traitement  				!== 반출입구분코드 ==!  */
	    <if test="rlbrTpCd != null and rlbrTpCd != ''">
		AND  A.RLBR_TP_CD = #{rlbrTpCd}
	    </if>

	    /** rlbr_prng_noN° Introduction/Sortie Prévue  		!== 반출입예정번호 ==!*/
	    <if test="rlbrPrngNo != null and rlbrPrngNo != ''">
		AND  A.RLBR_PRNG_NO = #{rlbrPrngNo}
	    </if>
	    /*bl_noN° De  Bl									 !== BL번호 ==!*/
	    <if test="blNo != null and blNo != ''">
		AND  A.BL_NO = #{blNo}
	    </if>
	    <if test="expCmdtBrngRqno != null and expCmdtBrngRqno != ''">
		AND  A.EXP_CMDT_BRNG_RQNO = #{expCmdtBrngRqno}
	    </if>
		ORDER BY A.CAG_MGMT_NO DESC, A.FRST_RGSR_DTTM DESC
		<include refid="pagination.footer" ></include>
	</select>

  <!--
    [Rechercher] Consulter la liste des "Demande d'accord préalable de l'exploitation de la zone sous douane"
    !== 반입 예정 상세 조회 0210 s==!
   -->
	<select id="selectCarBnwrhsCagBrngRlbrPrngDetailInfo" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrPrngVo">
	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectCarBnwrhsCagBrngRlbrPrngDetailInfo */
		SELECT
	           A.RLBR_PRNG_NO     /*N° Introduction/Sortie Prévue  		 !== 반출입예정번호==!*/
			 , A.RLBR_TP_CD     	/*Code de catégorie d'introduction/sortie  !== 반출입구분코드==!*/
			 , A.RLBR_PT_CD     	/*Code de type d'introduction/sortie  	 !== 반출입유형코드==!*/
			 , A.IBOBZ_CD     	/*Code de zone sous douane  			     !== 보세구역코드==!*/
			 , A.CAG_MGMT_NO      /*Crn  									 !== 화물관리번호==!*/
			 , A.BL_NO     		/*N° De  Bl									 !== BL번호==!*/
			 , A.RELA_NO     		/*Numéro Concerné  							 !== 관련번호==!*/
			 , TO_CHAR(TO_DATE(A.APRE_DT, 'YYYY/MM/DD'),'DD/MM/YYYY') AS APRE_DT      		/*Date D'Autorisation    !== 승인일자==!*/
			 , A.PCKG_GCNT     	/*Nombre De Colis  						     !== 포장개수==!*/
			 , A.WGHT     		/*Poids  										     !== 중량==!*/
			 , A.RLBR_PCKG_GCNT   /*Nombre de colis d'introduction/sortie    !== 반출입포장개수==!*/
			 , A.RLBR_WGHT     	/*Poids d'introduction/sortie  			     !== 반출입중량==!*/
			 , A.RLBR_CMPL_YN     /*Fin d'introduction/sortie   			     !== O/N반출입완료여부==!*/
			 , A.DEL_YN     		/*Suppression On  							     !== 삭제여부==!*/
			 , A.FRST_REGST_ID    /*Id Du Premier Enregistrant  			     !== 최초등록자ID==!*/
			 , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY') AS FRST_RGSR_DTTM  /*Date Et Heure De Premier Enregistrement  !== 최초등록일시==!*/
			 , A.LAST_CHPR_ID     /*Id Du Modificateur Final  				 !== 최종변경자ID==!*/
			 , A.LAST_CHG_DTTM    /*Date Et Heure De Modification Finale      !== 최종변경일시==!*/
			 , A.PCKG_GCNT		/**  Nombre De Colis  							 !== 포장개수 ==!  */
			 , A.WGHT  			/**  Poids  									 !== 중량 ==!  	*/
			 , A.CNSI_NM  		/**  Nom de destinataire  						 !== 수하인명 ==!  */
			 , A.CNSI_ADDR  		/**  Adresse de destinataire  					 !== 수하인주소 ==! */
			 , A.PDLS_NM  		/**  Nom De L'Article  						!== 품목명 ==!  */
			 , A.CNSI_NIF         /**  N° du registre du commerce de destinataire  !== 수하인납세자식별번호,사업자등록번호 ==!  */
			 , B.JRSD_ORGN_CD AS JRSD_CSTM_CD	/**  Code D'Unité Compétente  					!== 관할조직코드 ==!  */
			 , CASE WHEN CAG_MGMT_NO LIKE '%CRN%' THEN (SELECT PCKG_UT_CD FROM ALPASSEXT.TB_CARE_CAG_MGMT_NO_CRET WHERE CAG_MGMT_NO = A.CAG_MGMT_NO AND DEL_YN ='N')
			        ELSE (SELECT PCKG_UT_CD FROM ALPASSINT.TB_CARI_CAG_DCSH_BL WHERE CAG_MGMT_NO = A.CAG_MGMT_NO AND DEL_YN = 'N' )
			    END  AS PCKG_UT_CD
			 , A.EXP_CMDT_BRNG_RQNO
			 , (SELECT CAG_CHRC_CD FROM ALPASSINT.TB_CARI_CAG_DCSH_BL WHERE CAG_MGMT_NO = A.CAG_MGMT_NO AND DEL_YN = 'N' ) AS CAG_CHRC_CD /** !== 화물특성코드 ==!*/
		FROM  ALPASSEXT.TB_CARE_RLBR_PRNG A
			, ALPASSINT.TB_CARI_IBOBZ B
		WHERE A.IBOBZ_CD = B.IBOBZ_CD
		AND   B.DEL_YN = 'N'
		AND   A.DEL_YN = 'N'           /** Suppression ON 	!== 삭제여부 ==! */

        /** rlbr_prng_noN° Introduction/Sortie Prévue  		!== 반출입예정번호 ==!*/
		<if test="rlbrPrngNo != null and rlbrPrngNo != ''">
		AND   A.RLBR_PRNG_NO = #{rlbrPrngNo}
        </if>

        /**  Code De Statut De Traitement  !== 화물관리번호 ==!  */
        <if test="cagMgmtNo != null and cagMgmtNo != ''">
		AND   A.CAG_MGMT_NO = #{cagMgmtNo}
        </if>
  </select>

  <!-- 반출인경우 통관인터페이스 반출 컨테이너 조회 -->
	<select id="selectClrCntrList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectClrCntrList */
		SELECT ROWNUM() AS RLBR_FFMN_SRNO
			 , B.CNTR_NO
			 , B.CNTR_TP_CD
			 , D.PCKG_GCNT  AS RLBR_PCKG_GCNT
			 , D.TTWG AS RLBR_WGHT
			 , '' AS RLBR_VHCL_NO
			 , A.CAG_MGMT_NO
		     , CASE WHEN C.BL_PT_CD = 'M' THEN C.BL_NO ELSE C.HBL_NO END AS BL_NO
		FROM ALPASSINT.TB_CLRI_CSCL_CAG_INTF A
		   , ALPASSINT.TB_CLRI_CSCL_CAG_CNTR B
		   , ALPASSINT.TB_CARI_CAG_DCSH_BL C
		   , ALPASSINT.TB_CARI_CAG_DCSH_BL_CNTR D
		WHERE A.DTL_DCSH_NO = B.DTL_DCSH_NO
		AND   A.CAG_MGMT_NO = C.CAG_MGMT_NO
		AND   C.MRN = D.MRN
		AND   C.CAG_MGMT_NO = D.CAG_MGMT_NO
		AND   B.CNTR_NO = D.CNTR_NO
		AND   A.DEL_YN = 'N'
		AND   B.DEL_YN = 'N'
		AND   A.PRCS_YN = 'Y'
		AND   A.DCLR_PT_CD IN ('IM4','IM5','IM6','R00','ATA')
		AND   NVL(A.MDFY_RQST_YN,'N') = 'N'
		AND   A.CAG_MGMT_NO = #{cagMgmtNo}
    </select>

    <!-- 수출화물 컨테이너 조회 -->
	<select id="selectExpCntrList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectExpCntrList */
		SELECT '' AS CAG_MGMT_NO
		     , A.BL_NO
		     , B.CNTR_SRNO AS RLBR_FFMN_SRNO
		     , B.CNTR_NO
		     , B.CNTR_TP_CD
		     , B.PCKG_GCNT AS RLBR_PCKG_GCNT
		     , B.TTWG AS RLBR_WGHT
		     , '' AS RLBR_VHCL_NO
		     , A.EXP_CMDT_BRNG_RQNO AS RELA_NO
		FROM ALPASSEXT.TB_CARE_EXP_CMDT_BRNG A
		   , ALPASSEXT.TB_CARE_EXP_CMDT_BRNG_CNTR B
		WHERE A.EXP_CMDT_BRNG_RQNO = B.EXP_CMDT_BRNG_RQNO
		AND   A.DEL_YN = 'N'
		AND   B.DEL_YN = 'N'
		AND   A.PRCS_STTS_CD = 'D08'
		<if test="relaNo != null and relaNo != ''">
		AND   A.EXP_CMDT_BRNG_RQNO = #{relaNo}
		</if>
		<if test="blNo != null and blNo != ''">
		AND   A.BL_NO = #{blNo}
		</if>
    </select>

    <!-- 화물신고서 컨테이너 조회 -->
	<select id="selectDcshCntrList" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarRlbrFfmnVo">
    	/* alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.selectDcshCntrList */
		SELECT A.CAG_MGMT_NO
			 , A.CNTR_SRNO AS RLBR_FFMN_SRNO
			 , A.CNTR_NO
			 , A.CNTR_TP_CD
			 , A.PCKG_GCNT AS RLBR_PCKG_GCNT
			 , A.TTWG AS RLBR_WGHT
			 , '' AS RLBR_VHCL_NO
			 , CASE WHEN B.BL_PT_CD = 'M' THEN B.BL_NO ELSE B.HBL_NO END AS BL_NO
		FROM   ALPASSINT.TB_CARI_CAG_DCSH_BL_CNTR A
		   ,   ALPASSINT.TB_CARI_CAG_DCSH_BL B
		WHERE 1 = 1
		AND   A.CAG_MGMT_NO  = B.CAG_MGMT_NO
		AND   A.CAG_MGMT_NO = #{cagMgmtNo}
		AND   A.DEL_YN = 'N'
		AND   B.DEL_YN = 'N'
    </select>

	<!-- ########################## 0210, 0211  ############################## -->

	<!-- Lors d'une introduction suite au transfert, vérifier si la sortie a été autorisée ou non !== 운송에 의한 반입 시, 반출승인여부 체크 ==! -->
	<select id="carBrngRlbrTrnpChk" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo" resultType="int">
		/** alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.carBrngRlbrTrnpChk */
		SELECT COUNT(*)
		FROM TB_CARE_RLBR A
		   , TB_CARI_TRNP B
		WHERE 1 = 1
		  AND A.RELA_NO = B.TRNP_RQST_NO
		  AND A.IBOBZ_CD = B.DPRP_IBOBZ_CD
		  AND A.RLBR_TP_CD = 'O'
		  AND A.PRCS_STTS_CD = 'D08'
		  AND A.DIVD_TP_CD IN ('T', 'D')
		  AND A.RELA_NO = #{relaNo}
		  AND A.CAG_MGMT_NO = #{cagMgmtNo}
	</select>

	<!--
		[Transfert vers le DT] Lors d'une introduction suite au transfert, vérifier si la sortie du transfert est apurée (apurée : 0, non apurée : supérieure à 0) : Unité de CRN
		!== [하선운송]운송에 의한 반입 시, 운송 반출이행 완료여부 체크(완료 : 0, 미완료 : 0보다 큼) : CRN 단위 ==!
	-->
	<select id="carBrngTrnpRlbrFfmnChk" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo" resultType="int">
		/** alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.carBrngTrnpRlbrFfmnChk */
		SELECT COUNT(*)
		FROM  ALPASSINT.TB_CARI_TRNP_RLBR_FFMN A	/* CARI_운송_반출입_이행 */
		    , ALPASSINT.TB_CARI_TRNP B				/* CARI_운송 */
		    , ALPASSINT.TB_CARI_CAG_PRCS_BRKD C
		WHERE 1=1
		  AND  A.TRNP_RLBR_FFMN_MGMT_NO = B.TRNP_RQST_NO
		  AND  B.TRNP_RQST_NO = C.CAG_RQST_NO
		  AND  A.TRNP_RLBR_FFMN_MGMT_NO = C.CAG_RQST_NO
		  AND  A.DEL_YN = 'N'
		  AND  B.DEL_YN = 'N'
		  AND  C.DEL_YN = 'N'
		  AND  C.CAG_RQST_TP_CD = 'MCG'
		  AND  C.PRCS_STTS_CD = 'D08'
		  AND  A.RLBR_CFRM_YN = 'N'
		  AND  A.ARLC_IBOBZ_CD = #{ibobzCd}			/**  Code De Zone Sous Douane De Destination  !== 도착지보세구역코드 ==!  */
		  AND  A.CAG_MGMT_NO = #{cagMgmtNo}
	</select>

	<!--
    (Transfert vers le DT) Lors d'une introduction suite au transfert, vérifier si la sortie du transfert est apurée (apurée : 0, non apurée : supérieure à 0) : Unité de conteneur
    !== [하선운송]운송에 의한 반입 시, 운송 반출이행 완료여부 체크(완료 : 0, 미완료 : 0보다 큼) : 컨테이너 단위 ==!
-->
	<select id="carCntrBrngTrnpRlbrFfmnChk" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo" resultType="int">
		/** alpass.ipt.car.bnwrhs.cagbrng.mapper.CarCagBrngMapper.carCntrBrngTrnpRlbrFfmnChk */
		SELECT
			CASE WHEN COUNT(*) > 0 THEN COUNT(*)
				 ELSE
				 (
					SELECT COUNT(*)
					FROM  ALPASSINT.TB_CARI_TRNP_RLBR_FFMN A	/* CARI_운송_반출입_이행 */
					   , ALPASSINT.TB_CARI_TRNP B				/* CARI_운송 */
					   , ALPASSINT.TB_CARI_CAG_PRCS_BRKD C
					WHERE 1=1
					  AND A.TRNP_RLBR_FFMN_MGMT_NO = B.TRNP_RQST_NO
					  AND  B.TRNP_RQST_NO = C.CAG_RQST_NO
					  AND  A.TRNP_RLBR_FFMN_MGMT_NO = C.CAG_RQST_NO
					  AND  A.DEL_YN = 'N'
					  AND  B.DEL_YN = 'N'
					  AND  C.DEL_YN = 'N'
					  AND  C.CAG_RQST_TP_CD = 'MCG'
					  AND  C.PRCS_STTS_CD = 'D08'
					  AND  A.RLBR_CFRM_YN = 'N'
					  AND  A.CAG_MGMT_NO = #{cagMgmtNo}
					  AND  A.ARLC_IBOBZ_CD = #{ibobzCd}			/**  Code De Zone Sous Douane De Destination  !== 도착지보세구역코드 ==!  */
				 )
			END CNT
		FROM  ALPASSINT.TB_CARI_TRNP_RLBR_FFMN A	/* CARI_운송_반출입_이행 */
		    , ALPASSINT.TB_CARI_TRNP B				/* CARI_운송 */
		    , ALPASSINT.TB_CARI_CAG_PRCS_BRKD C
		WHERE 1=1
		  AND  A.TRNP_RLBR_FFMN_MGMT_NO = B.TRNP_RQST_NO
		  AND  B.TRNP_RQST_NO = C.CAG_RQST_NO
		  AND  A.TRNP_RLBR_FFMN_MGMT_NO = C.CAG_RQST_NO
		  AND  A.DEL_YN = 'N'
		  AND  B.DEL_YN = 'N'
		  AND  C.DEL_YN = 'N'
		  AND  C.CAG_RQST_TP_CD = 'MCG'
		  AND  C.PRCS_STTS_CD = 'D08'
		  AND  A.RLBR_CFRM_YN = 'N'
		  AND  A.CAG_MGMT_NO = #{cagMgmtNo}
		  AND  A.CNTR_NO = #{cntrNo}
		  AND  A.ARLC_IBOBZ_CD = #{ibobzCd}			/**  Code De Zone Sous Douane De Destination  !== 도착지보세구역코드 ==!  */
	</select>

	<!-- @TODO번역필요 !== 반입 예정정보가 존재하는지 조회 한다. ==! -->
    <select id="selectCagBrngRlbrPrngYn" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarCagBrngRlbrVo" resultType="string">
        /* CarCagLdunRqstMdfyBlMapper.selectRlbrPrngYn */
        SELECT CASE WHEN COUNT(*) > 0 THEN 'Y' ELSE 'N' END as prngYn
        FROM ALPASSEXT.TB_CARE_RLBR_PRNG
        WHERE DEL_YN = 'N'
          AND RLBR_TP_CD = #{rlbrTpCd}
		  AND RELA_NO = #{relaNo}
          AND CAG_MGMT_NO = #{cagMgmtNo}
    </select>
    
    <!-- Consulter les marchandises non introduites apres l'arrivee au port !== 입항 미반입 대상 조회 ==! -->
    <select id="selectCarBnwrhsCagBrngRlbrEtprNbriBrkdList" parameterType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarBnwrhsCagBrngEtprNbriBrkdVo" resultType="alpass.ipt.car.bnwrhs.cagbrng.vo.CarBnwrhsCagBrngEtprNbriBrkdVo">
    	/* CarCagBrngMapper.selectCarBnwrhsCagBrngRlbrEtprNbriBrkdList */
    	<include refid="pagination.header"/>
    	SELECT P.IBOBZ_CD
	         , P.CAG_MGMT_NO
	         , P.BL_NO
	         , P.PDLS_NM
	         , P.PCKG_GCNT
	         , P.WGHT
	         , P.RELA_NO
	         , R.LDUN_RPRT_NO
	         , R.PRCS_DTTM
	      FROM ALPASSEXT.TB_CARE_RLBR_PRNG P
	     INNER JOIN (SELECT L1.LDUN_RPRT_NO
				          , L1.MRN
				          , P.PRCS_DTTM
				       FROM TB_CARI_LDUN_RPRT L1
				      INNER JOIN TB_CARI_CAG_PRCS_BRKD P
				         ON L1.LDUN_RPRT_NO  = P.CAG_RQST_NO
				        AND P.PRCS_STTS_CD ='D08'
				        AND P.DEL_YN = 'N'
				      WHERE 1=1
			          <if test="sctrCd != null and sctrCd != ''">
		   				AND SUBSTRING(L1.JRSD_ORGN_CD,1,3) LIKE SUBSTRING(#{sctrCd},1,3) || '%'				/** Code de DRD !== DRD코드==! */
		 			  </if>
				      <if test="cstmCd != null and cstmCd != ''">
						AND SUBSTRING(L1.JRSD_ORGN_CD,1,5) LIKE SUBSTRING(#{cstmCd},1,5) || '%'				/**  Code D'Unité Compétente  !== 관할조직코드 ==!  */
					  </if>
				    ) R
	        ON 1=1 
	       AND SUBSTR(P.CAG_MGMT_NO, 1,16) = R.MRN
	     WHERE 1=1
	       AND RLBR_PT_CD = '10'
	       AND RLBR_TP_CD = 'I'
	       AND DEL_YN = 'N'
   	       AND RLBR_CMPL_YN = 'N'
	       AND R.PRCS_DTTM::DATE + INTERVAL '48 HOUR' <![CDATA[ < ]]> SYSTIMESTAMP
		 <if test="(searchKeywordFrom != null and searchKeywordFrom != '') and (searchKeywordTo != null and searchKeywordTo != '')">
          AND (
            (
              R.PRCS_DTTM <![CDATA[ >= ]]> TO_DATE(#{searchKeywordFrom}, 'DD/MM/YYYY')
              AND R.PRCS_DTTM <![CDATA[ <= ]]> TO_DATE(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            ) OR (
                R.PRCS_DTTM <![CDATA[ >= ]]> TO_TIMESTAMP(#{searchKeywordFrom}, 'DD/MM/YYYY')
                AND R.PRCS_DTTM <![CDATA[ <= ]]> TO_TIMESTAMP(#{searchKeywordTo}, 'DD/MM/YYYY')+0.9999
            )
          )
         </if>
	     <if test="cagMgmtNo != null and cagMgmtNo != ''">
		   AND P.CAG_MGMT_NO LIKE #{cagMgmtNo} || '%'
	     </if>
	     <if test="blNo != null and blNo != ''">
		   AND P.BL_NO = #{blNo}
	     </if>
	     ORDER BY R.PRCS_DTTM DESC, P.IBOBZ_CD, P.CAG_MGMT_NO
	     <include refid="pagination.footer"/>
    </select>
</mapper>
