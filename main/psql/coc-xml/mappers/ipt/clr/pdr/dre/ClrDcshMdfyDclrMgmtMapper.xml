<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="alpass.ipt.clr.pdr.dre.mapper.ClrDcshMdfyDclrMgmtMapper">

    <resultMap id="ClrDedVhclResultMap" type="alpass.ipt.clr.pdr.dre.vo.ClrDedVhclVo">
        <id property="dtlDcshNo" column="dtl_dcsh_no"></id>
        <id property="pdlsNo" column="pdls_no"></id>
        <id property="mdlStszNo" column="mdl_stsz_no"></id>
        <result property="chssNo" column="chss_no"></result>
        <result property="impPtNm" column="imp_pt_nm"></result>
        <result property="vhclMnurCd" column="vhcl_mnur_cd"></result>
        <result property="vhclMnurNm" column="vhcl_mnur_nm"></result>
        <result property="clrNm" column="clr_nm"></result>
        <result property="vhclMdlCd" column="vhcl_mdl_cd"></result>
        <result property="vhclMdlNm" column="vhcl_mdl_nm"></result>
        <result property="drvrNm" column="drvr_nm"></result>
        <result property="trsfNnprYn" column="trsf_nnpr_yn"></result>
        <result property="trsfUnblTpCd" column="trsf_unbl_tp_cd"></result>
        <result property="impCrppNo" column="imp_crpp_no"></result>
        <result property="impCrppDt" column="imp_crpp_dt"></result>
        <result property="impCrppPrid" column="imp_crpp_prid"></result>
        <result property="vhclCsclMgmtNo" column="vhcl_cscl_mgmt_no"></result>
        <result property="drvrPostNo" column="drvr_post_no"></result>
        <result property="drvrAddr" column="drvr_addr"></result>
        <result property="carRgsrNo" column="car_rgsr_no"></result>
        <result property="vhclReleDt" column="vhcl_rele_dt"></result>
        <result property="mkngYy" column="mkng_yy"></result>
        <result property="vhclWghtCn" column="vhcl_wght_cn"></result>
        <result property="loadWghtCn" column="load_wght_cn"></result>
        <result property="otptCn" column="otpt_cn"></result>
        <result property="dpcmtCn" column="dpcmt_cn"></result>
        <result property="flKndNm" column="fl_knd_nm"></result>
        <result property="vhclKndNm" column="vhcl_knd_nm"></result>
        <result property="caboNm" column="cabo_nm"></result>
        <result property="frstOpraDt" column="frst_opra_dt"></result>
        <result property="stcnt" column="stcnt"></result>
        <result property="delYn" column="del_yn"></result>
        <result property="frstRegstId" column="frst_regst_id"></result>
        <result property="frstRgsrDttm" column="frst_rgsr_dttm"></result>
        <result property="lastChprId" column="last_chpr_id"></result>
        <result property="lastChgDttm" column="last_chg_dttm"></result>
        <result property="trsfNnprStrtDt" column="trsf_nnpr_strt_dt"></result>
        <result property="trsfNnprEndDt" column="trsf_nnpr_end_dt"></result>
        <result property="vhclKndCd" column="vhcl_knd_cd"></result>
    </resultMap>

    <resultMap id="ClrDedMdlStszResultMap" type="alpass.ipt.clr.pdr.dre.vo.ClrDedMdlStszDcshVo">
        <id property="dtlDcshNo" column="dtl_dcsh_no"></id>
        <id property="pdlsNo" column="pdls_no"></id>
        <id property="mdlStszNo" column="mdl_stsz_no"></id>
        <result property="mdlStszNm" column="mdl_stsz_nm"></result>
        <result property="ingrNm" column="ingr_nm"></result>
        <result property="qty" column="qty"></result>
        <result property="qtyUtCd" column="qty_ut_cd"></result>
        <result property="utPrc" column="ut_prc"></result>
        <result property="invcAmt" column="invc_amt"></result>
        <result property="delYn" column="del_yn"></result>
        <result property="frstRegstId" column="frst_regst_id"></result>
        <result property="frstRgsrDttm" column="frst_rgsr_dttm"></result>
        <result property="lastChprId" column="last_chpr_id"></result>
        <result property="lastChgDttm" column="last_chg_dttm"></result>
        <result property="bfPdlsNo" column="BF_PDLS_NO"></result>
        <result property="bfMdlStszNo" column="BF_MDL_STSZ_NO"></result>
        <association property="vhclVo" resultMap="ClrDedVhclResultMap" columnPrefix="VHCL_"/>
    </resultMap>

    <resultMap id="ClrDedRimexPrngPdlsResultMap" type="alpass.ipt.clr.pdr.dre.vo.ClrDedRimexPrngPdlsVo">
        <id property="dtlDcshNo" column="dtl_dcsh_no"></id>
        <id property="prngPdlsNo" column="prng_pdls_no"></id>
        <result property="cmdtClsfSpelCd" column="cmdt_clsf_spel_cd"></result>
        <result property="pdlsNm" column="pdls_nm"></result>
        <result property="dlngPdlsNm" column="dlng_pdls_nm"></result>
        <result property="orcyCntyCd" column="orcy_cnty_cd"></result>
        <result property="qty" column="qty"></result>
        <result property="qtyUtCd" column="qty_ut_cd"></result>
        <result property="pdlsTtwg" column="pdls_ttwg"></result>
        <result property="pdlsNtwg" column="pdls_ntwg"></result>
        <result property="delYn" column="del_yn"></result>
        <result property="hsErrPvntVal" column="hs_err_pvnt_val"></result>
        <result property="frstRegstId" column="frst_regst_id"></result>
        <result property="frstRgsrDttm" column="frst_rgsr_dttm"></result>
        <result property="lastChprId" column="last_chpr_id"></result>
        <result property="lastChgDttm" column="last_chg_dttm"></result>
    </resultMap>


    <!-- 품목 ResultMap -->
    <resultMap id="selectDedPdlsHistListResultMap" type="alpass.ipt.clr.pdr.dre.vo.ClrDedPdlsDcshHVo">
        <id property="dtlDcshNo" column="dtl_dcsh_no"></id>
        <id property="histSrno" column="hist_srno"></id>
        <id property="pdlsNo" column="pdls_no"></id>
        <result property="uprPdlsNo" column="upr_pdls_no"></result>
        <result property="hsCd" column="hs_cd"></result>
        <result property="cmdtClsfSpelCd" column="cmdt_clsf_spel_cd"></result>
        <result property="pdlsNm" column="pdls_nm"></result>
        <result property="dlngPdlsNm" column="dlng_pdls_nm"></result>
        <result property="nwprScarCmdtCd" column="nwpr_scar_cmdt_cd"></result>
        <result property="pckgShmrMarkNo" column="pckg_shmr_mark_no"></result>
        <result property="pckgDesc" column="pckg_desc"></result>
        <result property="orcyCntyCd" column="orcy_cnty_cd"></result>
        <result property="apcCd" column="apc_cd"></result>
        <result property="prvlCd" column="prvl_cd"></result>
        <result property="qtaApreNo" column="qta_apre_no"></result>
        <result property="mgDscnApreNo" column="mg_dscn_apre_no"></result>
        <result property="prcDtrmMeanCd" column="prc_dtrm_mean_cd"></result>
        <result property="brndNm" column="brnd_nm"></result>
        <result property="bfDtlDcshNo" column="bf_dtl_dcsh_no"></result>
        <result property="bfDtlDcshDt" column="bf_dtl_dcsh_dt"></result>
        <result property="bfPdlsNo" column="bf_pdls_no"></result>
        <result property="divdFfmnTpCd" column="divd_ffmn_tp_cd"></result>
        <result property="qty" column="qty"></result>
        <result property="qtyUtCd" column="qty_ut_cd"></result>
        <result property="trifBaseVal" column="trif_base_val"></result>
        <result property="pdlsTtwg" column="pdls_ttwg"></result>
        <result property="pdlsNtwg" column="pdls_ntwg"></result>
        <result property="pdlsPckgGcnt" column="pdls_pckg_gcnt"></result>
        <result property="pdlsPckgUtCd" column="pdls_pckg_ut_cd"></result>
        <result property="oilTankNo" column="oil_tank_no"></result>
        <result property="vhclYn" column="vhcl_yn"></result>
        <result property="pdlsPsmgtTrgtYn" column="pdls_psmgt_trgt_yn"></result>
        <result property="pdlsPsmgtFfmnCmplYn" column="pdls_psmgt_ffmn_cmpl_yn"></result>
        <result property="pdlsPsmgtFfmnCmplDt" column="pdls_psmgt_ffmn_cmpl_dt"></result>
        <result property="pdlsPsmgtConcRsnCd" column="pdls_psmgt_conc_rsn_cd"></result>
        <result property="delYn" column="del_yn"></result>
        <result property="frstRegstId" column="frst_regst_id"></result>
        <result property="frstRgsrDttm" column="frst_rgsr_dttm"></result>
        <result property="lastChprId" column="last_chpr_id"></result>
        <result property="lastChgDttm" column="last_chg_dttm"></result>
        <result property="hsErrPvntVal" column="hs_err_pvnt_val"></result>
        <result property="hsErrPvnt" column="hs_err_pvnt"></result>
        <result property="regmRqstCd" column="regm_rqst_cd"></result>
        <result property="regmPn" column="regm_pn"></result>
        <result property="prhbCmdtCd" column="prhb_cmdt_cd"></result>
        <result property="hsExcpMtrCd" column="hs_excp_mtr_cd"></result>
        <result property="hsExcpMtrNm" column="hs_excp_mtr_nm"></result>
        <result property="apcExcpMtrCd" column="apc_excp_mtr_cd"></result>
        <result property="apcExcpMtrNm" column="apc_excp_mtr_nm"></result>
        <result property="apcDtlCd" column="APC_DTL_CD"></result>
        <result property="apcDtlNm" column="APC_DTL_NM"></result>
        <result property="prvlExcpMtrCd" column="prvl_excp_mtr_cd"></result>
        <result property="prvlExcpMtrNm" column="prvl_excp_mtr_nm"></result>
        <result property="aditTxQty" column="adit_tx_qty"/>
        <result property="aditTxQtyUtCd" column="adit_tx_qty_ut_cd"/>
        <result property="pdlsClsfBfhnJdgnPn" column="PDLS_CLSF_BFHN_JDGN_PN"/>
        <result property="apcAtpmStrtDt" column="apc_atpm_strt_dt"/>
        <result property="apcAtpmEndDt" column="apc_atpm_end_dt"/>
        <result property="psmgtFfmnXpirPrid" column="psmgt_ffmn_xpir_prid"/>
        <collection property="mdlStszHistList" resultMap="ClrDedMdlStszResultMap" columnPrefix="STSZ_"/>
        <collection property="rwmsHistList" resultMap="ClrDedRimexPrngPdlsResultMap" columnPrefix="RWMS_"/>
    </resultMap>

    <!-- DED 정정 접수 목록 조회 -->
    <select id="selectDedAtrAcapList" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedAtrAcapVo">
        /* selectDedAtrAcapList */

        <include refid="pagination.header"></include>
        SELECT T.*
        , DECODE(T.PRCS_STTS_PR_PRFR_CD, NULL, '',
        ( SELECT PRCS_STTS_PR_PRFR_CD FROM TB_CLRI_DED_PRCS_BRKD
        WHERE DTL_DCSH_NO = T.DTL_DCSH_NO
        AND PRCS_SRNO = T.PRCS_SRNO
        )||'|'||
        ( SELECT FN_GET_CD_VDVAL_NM('CLR_0012', ( SELECT PRCS_STTS_PR_PRFR_CD
        FROM TB_CLRI_DED_PRCS_BRKD
        WHERE DTL_DCSH_NO = T.DTL_DCSH_NO
        AND PRCS_SRNO = T.PRCS_SRNO
        )
        , #{langCd}
        )
        FROM DUAL
        )
        ) AS PRCS_STTS_PR_PRFR_NM
        FROM
        (

        SELECT A.DTL_DCSH_NO
        , TO_CHAR(TO_DATE(A.DCLR_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS DCLR_DT
        , TO_DATE(A.DCLR_DT, 'YYYYMMDD') AS DCLR_DATE
        , A.DCLR_CSTM_CD
        , A.DCLR_PT_CD
        , A.CSCL_PLN_CD
        , A.EXP_CNTY_CD
        , A.EPC_CD
        , A.SELC_RSLT_CD
        , A.RLBR_CSTM_CD /* 반출입세관*/
        , A.TRNP_METH_KND_CD /* 운송수단종류코드 */
        , A.PRCS_STTS_CD
        , A.CSCL_PSTP_YN
        , (SELECT PRCS_STTS_PR_PRFR_CD FROM TB_CLRI_DED_PRCS_BRKD
        WHERE DTL_DCSH_NO = A.DTL_DCSH_NO
        AND PRCS_SRNO = (SELECT MAX(PRCS_SRNO) FROM TB_CLRI_DED_PRCS_BRKD WHERE DTL_DCSH_NO = A.DTL_DCSH_NO AND DEL_YN =
        'N')
        ) AS PRCS_STTS_PR_PRFR_CD
        , (SELECT MAX(PRCS_SRNO) FROM TB_CLRI_DED_PRCS_BRKD WHERE DTL_DCSH_NO = A.DTL_DCSH_NO AND DEL_YN = 'N') AS
        PRCS_SRNO
        FROM TB_CLRI_DED_COMN A
        WHERE A.DEL_YN = 'N'

        <if test="dclrCstmCd != null and dclrCstmCd != ''">
            AND A.DCLR_CSTM_CD = #{dclrCstmCd}
        </if>
        <if test="deptCd != null and deptCd != ''">
            AND A.audt_dept_cd = #{deptCd}
        </if>
        <if test='dtlDcshNo != null and dtlDcshNo != "" '>
            AND A.DTL_DCSH_NO LIKE #{dtlDcshNo}||'%' /** Numero du DAU !== DED번호 ==! */
        </if>
        <if test="reffNo != null and reffNo != ''">
            AND A.REFF_NO LIKE #{reffNo}||'%'
        </if>
        <if test="dclrPtCd != null and dclrPtCd != ''">
            AND A.DCLR_PT_CD = #{dclrPtCd}
        </if>
        <if test="csclPlnCd != null and csclPlnCd != ''">
            AND A.CSCL_PLN_CD = #{csclPlnCd}
        </if>
        <if test="trnpMethKndCd != null and trnpMethKndCd != ''">
            AND A.TRNP_METH_KND_CD = #{trnpMethKndCd}
        </if>
        <if test="csclPstpYn != null and csclPstpYn != ''">
            AND A.CSCL_PSTP_YN = #{csclPstpYn}
        </if>
        <if test="prcsSttsCd != null and prcsSttsCd != ''">
            AND A.PRCS_STTS_CD = #{prcsSttsCd}
        </if>
        <if test='dedInqtTp != null and dedInqtTp == "CR"'>
            /* !== 쟁송등록 ==! */
            AND A.DPUT_YN = 'Y'
        </if>
        <if test='dedInqtTp != null and dedInqtTp == "CC"'>
            /* !== 쟁송완료 ==! */
            AND A.DPUT_YN = 'N'
        </if>
        <if test='dedInqtTp != null and dedInqtTp == "PR"'>
            /* !== 잠정신고 등록 (잠정승인신고여부 N ) ==! */
            AND A.PRVI_DCLR_APRE_YN = 'N'
        </if>
        <if test='dedInqtTp != null and dedInqtTp == "PC"'>
            /* !== 잠정신고 완료 (잠정승인신고여부 Y ) ==! */
            AND A.PRVI_DCLR_APRE_YN = 'Y'
        </if>
        <!-- 2020.01.10 김선구 요구사항에 의한 수출자 수입자 신고인 조회조건 추가. -->
        <if test="exppnIdfyNo != null and exppnIdfyNo != ''">
            AND A.EXPPN_IDFY_NO = #{exppnIdfyNo}
        </if>

        <if test="imppnIdfyNo != null and imppnIdfyNo != ''">
            AND A.IMPPN_IDFY_NO = #{imppnIdfyNo}
        </if>

        <if test="dcerCd != null and dcerCd != ''">
            AND A.DCER_CD = #{dcerCd}
        </if>

        <if test='dedInqtTp != null and dedInqtTp == "VR"'>
            /* !== 방문검사/통관 등록 ==! 검사장소구분코드 B,C 이고 검사가 완료 안된것 (E02 아닌것) */
            AND A.INSC_PLC_TP_CD IN ('B','C')
            AND ( EXISTS ( SELECT 1 FROM TB_CLRI_DED_INSC_RSLT
            WHERE DEL_YN = 'N'
            AND IPRT_PRCS_STTS_CD <![CDATA[ <> ]]> 'E02'
            AND DTL_DCSH_NO = A.DTL_DCSH_NO
            )
            OR
            NOT EXISTS ( SELECT 1 FROM TB_CLRI_DED_INSC_RSLT
            WHERE DEL_YN = 'N'
            AND DTL_DCSH_NO = A.DTL_DCSH_NO
            )
            )

        </if>
        <if test='dedInqtTp != null and dedInqtTp == "VC"'>
            /* !== 방문검사/통관 완료 ==! 검사장소구분코드 B,C 이고 검사가 완료 (E02) */
            AND A.INSC_PLC_TP_CD IN ('B','C')
            AND EXISTS ( SELECT 1 FROM TB_CLRI_DED_INSC_RSLT
            WHERE DEL_YN = 'N'
            AND IPRT_PRCS_STTS_CD = 'E02'
            AND DTL_DCSH_NO = A.DTL_DCSH_NO
            )
        </if>
        <choose>
            <when test='userRoleTp != null and userRoleTp =="CHPN"'>
                <if test="userId != null and userId != ''">
                    /* !== 담당자 ==!*/
                    AND A.DCLR_CSTM_CD = #{userCstmCd}
                    AND A.audt_dept_cd = #{userDeptCd}
                    AND A.AUDT_EMP_ID = #{userId}
                </if>

            </when>
            <otherwise>
                /* !== 관리자 ==!*/
                <choose>
                    <when test='userRoleTp != null and userRoleTp =="SRVC"'>
                        /* !== 부서장 ==!*/
                        AND A.DCLR_CSTM_CD = #{userCstmCd}
                        AND A.audt_dept_cd = #{userDeptCd}
                    </when>
                    <when test='userRoleTp != null and userRoleTp =="CSTM"'>
                        /* !== 세관장 ==!*/
                        AND A.DCLR_CSTM_CD = #{userCstmCd}
                    </when>
                </choose>
            </otherwise>
        </choose>
        <if test="dclrDtFrom != null and dclrDtFrom != ''">
            AND A.DCLR_DT <![CDATA[ >= ]]> TO_CHAR(TO_DATE(#{dclrDtFrom},'DD/MM/YYYY'),'YYYYMMDD')
            AND A.DCLR_DT <![CDATA[ <= ]]> TO_CHAR(TO_DATE(#{dclrDtTo},'DD/MM/YYYY'),'YYYYMMDD')
        </if>
        <if test="mdfyRqstDtFrom != null and mdfyRqstDtFrom != ''">
            AND A.last_chg_dttm <![CDATA[ >= ]]> TO_DATE(#{mdfyRqstDtFrom},'DD/MM/YYYY')
            AND A.last_chg_dttm <![CDATA[ < ]]> TO_DATE(#{mdfyRqstDtTo},'DD/MM/YYYY') + 1
        </if>
        AND A.ATR_DCLR_RCPN_YN = 'Y'
        AND A.PRCS_STTS_CD NOT IN ('A01','A04','B01','C02','B02','G01', 'G03', 'G04')
        ) T
        WHERE 1 = 1
        <if test="prcsSttsPrPrfrCd != null and prcsSttsPrPrfrCd != ''">
            AND T.PRCS_STTS_PR_PRFR_CD = #{prcsSttsPrPrfrCd}
        </if>
        ORDER BY DCLR_DATE DESC, DTL_DCSH_NO
        <include refid="pagination.footer"></include>

    </select>

    <!-- DED 공통 이력  조회 -->
    <select id="selectDedComnHistInfo" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedComnDcshHVo">
        /* selectDedComnHistInfo */
        SELECT A.DTL_DCSH_NO /** Numero du DAU !== DED번호 ==! */
        , TO_CHAR(TO_DATE(A.DCLR_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS DCLR_DT /** Date de DAU !== DED일자 ==! */
        , TO_CHAR(TO_DATE(A.RQST_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS RQST_DT /** !==신청일자==! */
        , A.REFF_NO /** !==참조번호==! */
        , A.WKNG_PT_CD
        , A.DCLR_PT_CD /** !==신고유형==! */
        , A.DCLR_CSTM_CD /** !==신고세관==! */
        , A.CSCL_PLN_CD /** Code de plan de dedouanement !== 통관계획코드 ==! */
        , A.AL_TTWG /** Poids brut total !== 전체총중량 ==! */
        , A.AL_NTWG /** Poids net total !== 전체순중량 ==! */
        , A.PCKG_TGCNT /** Nombre total de colis !== 포장총개수 ==! */
        , A.CNTR_CAG_YN /** Cargaison conteneurisee ON !== 컨테이너화물여부 ==! */
        , A.EXPPN_IDFY_NO_TP_CD /** Code de type du N° d'identification de l'exportateur !== 수출자식별번호구분코드 ==! */
        , A.EXPPN_IDFY_NO /** N° d'identification de l'exportateur !== 수출자식별번호 ==! */
        , A.IMPPN_IDFY_NO_TP_CD /** Code de type du N° d'identification de l'importateur !== 수입자식별번호구분코드 ==! */
        , A.IMPPN_IDFY_NO /** N° d'identification de l'importateur !== 수입자식별번호 ==! */
        , A.TXPR_IDFY_NO /** NIU !== 납세자식별번호 ==! */
        , TO_CHAR(TO_DATE(A.prmsnt_dt, 'YYYYMMDD'),'DD/MM/YYYY') as prmsnt_dt
        , NVL(A.sys_use_ss, 1) as sys_use_ss
        , A.exp_cmdt_brng_rqno         /** N° demande de l'introduction des marchandises à exporter !== 수출물품반입신청번호 ==! */
        , A.exp_cmdt_loct_nm           /** Exporter le nom de l'emplacement du produit !== 수출물품위치명 ==! */
        , A.bf_dtl_dcsh_no             /** N° de la déclaration en détail précédent !== 이전상세신고서번호 ==! */
        , A.bfhn_no                    /** N° de autorisation pour PAD et provisoire !== 사전허가번호 ==! */
        , A.pad_bfhn_no
        , A.prvi_bfhn_no
        , A.bfcy_idfy_no                /** NIF du bénéficiaire */
        , A.bfcy_cmrc_regs_no           /** Registre de commerce du bénéficiaire */
        , A.PRMSNT_STTS_CD
        , TO_CHAR(TO_DATE(A.bl_dt, 'YYYYMMDD'),'DD/MM/YYYY') as bl_dt
        , A.DLNG_PYMN_MEAN_CD
        , FN_GET_CD_VDVAL_NM('CLR_0137', A.DLNG_PYMN_MEAN_CD, #{langCd}) AS DLNG_PYMN_MEAN_NM
        , C.EXPPN_CO_NM /** Nom de societe de l'exportateur !== 수출자업체명 ==! */
        , C.EXPPN_ADDR /** Adresse de l'exportateur !== 수출자주소 ==! */
        , C.IMPPN_CO_NM /** Nom de societe de l'importateur !== 수입자업체명 ==! */
        , C.IMPPN_ADDR /** Adresse de l'importateur !== 수입자주소 ==! */
        , C.TXPR_CO_NM /** Nom de societe contribuable !== 납세자업체명 ==! */
        , C.TXPR_ADDR /** Adresse du contribuable !== 납세자주소 ==! */
        , C.TXPR_TLPH_NO /** N° de telephone du contribuable !== 납세자전화번호 ==! */
        , C.TXPR_EML /** E-mail du contribuable !== 납세자이메일 ==! */
        , C.DCER_CO_NM /** Nom de societe du declarant !== 신고인업체명 ==! */
        , C.DCER_ADDR /** Adresse du declarant !== 신고인주소 ==! */
        , C.BFCY_CO_NM /** Nom De L''Entreprise Du Bénéficiaire */
        , C.BFCY_ADDR /** Adresse Benef */
        , A.EPC_CD
        , A.CSM_CNTY_CD /** Code de pays d'expedition !== 탁송국가코드 ==! */
        , A.TRDE_DLNG_CNTY_CD /** Code de pays de transaction !== 무역거래국가코드 ==! */
        , A.EXP_CNTY_CD /** Code de pays exportateur !== 수출국가코드 ==! */
        , A.DSTN_CNTY_CD /** Code de pays destinataire !== 목적지국가코드 ==! */
        , A.DCER_CD /** Code du declarant !== 신고인코드 ==! */
        , A.CMDT_STGE_LOCT_CD /** Code de lieu de stockage !== 물품위치코드(물품장치장소코드) ==! */
        , A.BNBN_CMDT_WRHS_CD /** Code d'entrepot !== 보세창고코드(보세물품창고코드) ==! */
        , ( SELECT X.ibobz_nm FROM tb_cari_ibobz X WHERE X.DEL_YN = 'N' AND X.ibobz_cd = A.BNBN_CMDT_WRHS_CD AND ROWNUM
        = 1 ) AS BNBN_WRHS_NM
        , A.BF_BNBN_CMDT_WRHS_CD /** Code de l'entrepot precedent !== 이전보세물품창고코드(이전보세창고코드) ==! */
        , (SELECT X.ibobz_nm FROM tb_cari_ibobz X WHERE X.DEL_YN = 'N' AND X.ibobz_cd = A.BF_BNBN_CMDT_WRHS_CD AND
        ROWNUM = 1) AS BF_BNBN_WRHS_NM
        , A.PSMGT_FFMN_XPIR_PRID /** Echeance de l'entrepot !== 보세창고보관기관(사후관리이행만료기간) ==! */
        , A.DLVR_COND_CD /** Code de la condition de livraison !== 인도조건코드 ==! */
        , A.DLVR_PLC_CD /** Code du lieu de livraison !== 인도장소코드 ==! */
        , A.INVC_NO /** N° de facture !== 송장번호 ==! */
        , TO_CHAR(TO_DATE(A.INVC_PBLS_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS INVC_PBLS_DT /** Date de l'emission de la facture
        !== 송장발행일자 ==! */
        , A.PYMN_MEAN_CD /** Code de mode de paiement !== 지불방법코드 ==! */
        , A.PYMN_BNK_CD /** Code de banque de paiement !== 지불은행코드 ==! */
        , A.PYMN_BNK_BRNH_CD /** Code d'agnce de banque de paiement !== 지불은행지점코드 ==! */
        , A.PYMN_AC_NO /** N° de compte de paiement !== 지불계좌번호 ==! */
        , A.DLNG_COND1_CD /** Code de condition de transaction 1 !== 거래조건1코드 ==! */
        , A.DLNG_COND2_CD /** Code de condition de transaction 2 !== 거래조건2코드 ==! */
        , B.INVC_AMT /** Montant de facture !== 송장금액 ==! */
        , B.INVC_CURR_CD /** Code de devise de la facture !== 송장통화코드 ==! */
        , B.INVC_FXRT /** Taux de change de la facture !== 송장환율 ==! */
        , B.INVC_NCY_AMT /** Montant NCY de facture !== 송장NCY금액 ==! */
        , B.INVC_USD_AMT /** Montant USD de facture !== 송장USD금액 ==! */
        , B.CACH_AMT /** Montant du fret !== 운임금액 ==! */
        , B.CACH_CURR_CD /** Code de devise du fret !== 운임통화코드 ==! */
        , B.CACH_FXRT /** Taux de change du fret !== 운임환율 ==! */
        , B.CACH_NCY_AMT /** Montant NCY du fret !== 운임NCY금액 ==! */
        , B.INFEE_AMT /** Montant d'assurance !== 보험료금액 ==! */
        , B.INFEE_CURR_CD /** Code de devise d'assurance !== 보험료통화코드 ==! */
        , B.INFEE_FXRT /** Taux de change d'assurance !== 보험료환율 ==! */
        , B.INFEE_NCY_AMT /** Montant NYC de l'assurance !== 보험료NCY금액 ==! */
        , B.OTCST_AMT /** Montant des autres couts !== 기타비용금액 ==! */
        , B.OTCST_CURR_CD /** Code de devise des autres couts !== 기타비용통화코드 ==! */
        , B.OTCST_FXRT /** Taux de change des autres couts !== 기타비용환율 ==! */
        , B.OTCST_NCY_AMT /** Montant des autres couts de NCY !== 기타비용NCY금액 ==! */
        , B.DDCT_AMT /** Montant deduit !== 공제금액 ==! */
        , B.DDCT_RT /** Montant deduit !== 공제금액 ==! */
        , B.DDCT_CURR_CD /** Code de devise de la deduction !== 공제통화코드 ==! */
        , B.DDCT_FXRT /** Taux de change de la deduction !== 공제환율 ==! */
        , B.DDCT_NCY_AMT /** Montant NCY deduit !== 공제NCY금액 ==! */
        , D.TTXBS_NCY_AMT /** Montant NCY total de la valeur statistique !== 총과세기준NCY금액 ==! */
        , D.TTXBS_USD_AMT /** Montant USD total de la valeur statistique !== 총과세기준USD금액 ==! */
        , NVL(A.TRNP_METH_KND_CD, '') AS TRNP_METH_KND_CD /** Code de type du moyen de transport !== 운송수단종류코드 ==! */
        , A.TRNP_METH_IDFY_NO /** N° d'identification du moyen de transport !== 운송수단식별번호 ==! */
        , A.TRNP_METH_NAT_CD /** Code de pays du moyen de transport !== 운송수단국적코드 ==! */
        , TO_CHAR(TO_DATE(A.ARVL_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS ARVL_DT /** Date d'arrivee !== 도착일자 ==! */
        , A.CAG_MGMT_NO /** CRN !== 화물관리번호 ==! */
        , A.BL_NO /** N° de BL !== BL번호 ==! */
        , A.SHIP_NM /** Nom du navire !== 선박명 ==! */
        , A.DIVD_CSCL_TP_CD /** Dedouanement partiel ON !== 분할통관구분코드 ==! */
        , A.LDNP_CD
        , A.CNTR_GCNT
        , A.DISPR_CD
        , TO_CHAR(TO_DATE(A.LDUN_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS LDUN_DT
        , TO_CHAR(TO_DATE(A.RLSE_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS RLSE_DT /** Date d'enlevement !== 반출일자 ==! */
        , A.RLBR_CSTM_CD /** Code du bureau d'entree et de sortie !== 반출입세관코드 ==! */
        , A.CMDT_STGE_LOCT_CD /** Code de lieu de stockage !== 물품위치코드(물품장치장소코드) ==! */
        , A.BNBN_CMDT_WRHS_CD /** Code d'entrepot !== 보세창고코드(보세물품창고코드) ==! */
        , A.BF_BNBN_CMDT_WRHS_CD /** Code de l'entrepot precedent !== 이전보세물품창고코드(이전보세창고코드) ==! */
        , A.PSMGT_FFMN_XPIR_PRID /** Echeance de l'entrepot !== 보세창고보관기관(사후관리이행만료기간) ==! */
        , A.AUDT_EMP_ID /** ID de la personne verifiant !== 심사직원ID ==! */
        , A.SELC_RSLT_CD /** Code de resultat de ciblage !== 선별결과코드 ==! */
        , A.DCSH_FM_CD /** Code de formulaire de la declaration !== 신고서양식코드 ==! */
        , A.MDFY_DGCNT /** Nombre de fois de la modification !== 정정차수 ==! */
        , A.CSCL_PSTP_YN /** Dedouanement suspendu ON !== 통관보류여부 ==! */
        , A.DPUT_YN /** Contentieux ON !== 쟁송여부 ==! */
        , A.ATR_DCLR_RCPN_YN /** Declaration modifiee recue ON !== 수정신고수신여부 ==! */
        , A.CNCL_DCLR_RCPN_YN /** !== 취소신고수신여부 ==! */
        , A.PRVI_DCLR_APRE_YN /** Declaration provisoire autorisee ON !== 잠정신고승인여부 ==! */
        , A.PRCS_STTS_CD /** Code de statut de traitement !== 처리상태코드 ==! */
        , A.PDLS_GCNT /** !== 품목개수 ==! */
        , A.DCRD_YN /** !== 차상반출여부 ==! */
        , A.OWHS_PRC_EV_YN /** !== 자가가격평가여부 ==! */
        , A.ADOR_HNOT_OPIN_CN /** !== 심사자배부의견내용==! */
        , (SELECT BB.NIF
        FROM TB_COM_CO_DCLR_CD BB
        WHERE BB.CO_DCLR_CD = A.DCER_CD
        AND BB.CO_DCLR_TP_CD = 'H'
        AND BB.DEL_YN = 'N'
        AND ROWNUM = 1
        ) AS DCER_IDFY_NO


        FROM TB_CLRI_DED_COMN_H A
        , TB_CLRI_DED_VLUT_COMN_H B
        , TB_CLRI_DED_CO_H C
        , TB_CLRI_DED_VLUT_COMN D
        , TB_CLRI_DED_COMN E

        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.HIST_SRNO = B.HIST_SRNO
        AND A.DTL_DCSH_NO = C.DTL_DCSH_NO
        AND A.HIST_SRNO = C.HIST_SRNO
        AND A.DTL_DCSH_NO = D.DTL_DCSH_NO
        AND A.DTL_DCSH_NO = E.DTL_DCSH_NO
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = E.HIST_SRNO - 1
        </if>

        AND A.DEL_YN = 'N'
        AND B.DEL_YN = 'N'
        AND C.DEL_YN = 'N'
        AND D.DEL_YN = 'N'
        AND E.DEL_YN = 'N'

    </select>

    <!-- DED 재수출재수입예정품목 이력 목록 조회 -->
    <select id="selectDedReimexHistList" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedRimexPrngPdlsVo">
        /* selectDedReimexHistList */
        SELECT
        A.DTL_DCSH_NO
        , A.PRNG_PDLS_NO
        , A.HS_CD
        , A.CMDT_CLSF_SPEL_CD
        , A.PDLS_NM
        , A.DLNG_PDLS_NM
        , A.ORCY_CNTY_CD
        , A.QTY
        , A.QTY_UT_CD
        , A.PDLS_TTWG
        , A.PDLS_NTWG
        , A.hs_err_pvnt_val
        FROM TB_CLRI_DED_RIMEX_PRNG_PDLS_H A
        , TB_CLRI_DED_COMN B
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.DEL_YN = 'N'
        AND B.DEL_YN = 'N'
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>

    </select>

    <!-- DED가격공통 이력 조회 -->
    <select id="selectDedVlutComnHistInfo" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedVlutComnVo">
        /* selectDedVlutComnHistInfo */
        SELECT A.DTL_DCSH_NO
        , A.INVC_AMT
        , A.INVC_CURR_CD
        , A.INVC_FXRT
        , A.INVC_NCY_AMT
        , A.INVC_USD_AMT
        , A.CACH_AMT
        , A.CACH_CURR_CD
        , A.CACH_FXRT
        , A.CACH_NCY_AMT
        , A.INFEE_AMT
        , A.INFEE_CURR_CD
        , A.INFEE_FXRT
        , A.INFEE_NCY_AMT
        , A.OTCST_AMT
        , A.OTCST_CURR_CD
        , A.OTCST_FXRT
        , A.OTCST_NCY_AMT
        , A.DDCT_AMT
        , A.DDCT_RT
        , A.DDCT_CURR_CD
        , A.DDCT_FXRT
        , A.DDCT_NCY_AMT
        , A.TTXBS_NCY_AMT
        , A.TTXBS_USD_AMT
        FROM TB_CLRI_DED_VLUT_COMN_H A
        , TB_CLRI_DED_COMN B
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.DEL_YN = 'N'
        AND B.DEL_YN = 'N'
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>

    </select>

    <!-- DED가격평가 품목 이력 목록 조회-->
    <select id="selectDedVlutPdlsHistList" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedVlutPdlsVo">
        /* selectDedVlutPdlsHistList */
        SELECT
        A.DTL_DCSH_NO
        , A.PDLS_NO
        , A.PDLS_INVC_CURR_CD
        , A.PDLS_INVC_FXRT
        , A.PDLS_INVC_AMT
        , A.PDLS_INVC_NCY_AMT
        , A.PDLS_INVC_USD_AMT
        , A.PDLS_CACH_CURR_CD
        , A.PDLS_CACH_FXRT
        , A.PDLS_CACH_AMT
        , A.PDLS_CACH_NCY_AMT
        , A.PDLS_INFEE_CURR_CD
        , A.PDLS_INFEE_FXRT
        , A.PDLS_INFEE_AMT
        , A.PDLS_INFEE_NCY_AMT
        , A.PDLS_OTCST_CURR_CD
        , A.PDLS_OTCST_FXRT
        , A.PDLS_OTCST_AMT
        , A.PDLS_OTCST_NCY_AMT
        , A.PDLS_DDCT_CURR_CD
        , A.PDLS_DDCT_FXRT
        , A.PDLS_DDCT_AMT
        , A.PDLS_DDCT_NCY_AMT
        , A.PDLS_TXBS_NCY_AMT
        , A.PDLS_TXBS_USD_AMT
        , A.DEL_YN
        , A.FRST_REGST_ID
        , A.FRST_RGSR_DTTM
        , A.LAST_CHPR_ID
        , A.LAST_CHG_DTTM
        FROM TB_CLRI_DED_VLUT_PDLS_H A
        , TB_CLRI_DED_COMN B
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.DEL_YN = 'N'
        AND B.DEL_YN = 'N'
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>
        ORDER BY TO_NUMBER(A.PDLS_NO)

    </select>

    <!-- DED 품목 이력  조회 -->
    <select id="selectDedPdlsHistListNI" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultMap="selectDedPdlsHistListResultMap">
        /* selectDedPdlsHistListNI */
        SELECT
        A.DTL_DCSH_NO /** Numero du DAU !== DED번호 ==! */
        , A.PDLS_NO /** N° d'article !== 품목번호 ==! */
        , A.HS_CD /** Code SH !== HS코드 ==! */
        , A.CMDT_CLSF_SPEL_CD /** Code specifique de classification de marchandise !== 물품분류특별코드 ==! */
        , A.PDLS_NM /** Nom de l'article !== 품목명 ==! */
        , A.DLNG_PDLS_NM /** Nom de l'article de transaction !== 거래품목명 ==! */
        , A.NWPR_SCAR_CMDT_CD /** Code de produit neuf et usage !== 신상품중고물품코드 ==! */
        , A.PCKG_SHMR_MARK_NO /** N° de marque d'expedition du colis !== 포장화인마크번호 ==! */
        , A.PCKG_DESC /** Description Du Colis !== 포장설명 ==! */
        , A.ORCY_CNTY_CD /** Code de pays d'origine !== 원산지국가코드 ==! */
        , A.APC_CD /** Code APC !== APC코드 ==! */
        , A.PRVL_CD /** Code de preference !== 특혜코드 ==! */
        , A.QTA_APRE_NO
        , A.MG_DSCN_APRE_NO /** N° d'autorisation de l'abattement sur la caution !== 담보할인승인번호 ==! */
        , A.PRC_DTRM_MEAN_CD /** Code de methode d'evaluation de valeur !== 가격결정방법코드 ==! */
        , A.BRND_NM /** Nom de la marque !== 브랜드명 ==! */
        , A.BF_DTL_DCSH_NO /** N° de DAU precedent !== 이전DED번호 ==! */
        , TO_CHAR(TO_DATE(A.BF_DTL_DCSH_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS BF_DTL_DCSH_DT /** Date de DAU precedent !==
        이전DED일자 ==! */
        , A.BF_PDLS_NO /** N° d'article precedent !== 이전품목번호 ==! */
        , A.DIVD_FFMN_TP_CD /** Apurement partiel ON !== 분할통관구분코드 ==! */
        , A.QTY /** Quantite !== 수량 ==! */
        , A.QTY_UT_CD /** Code de l'unite de quantite !== 수량단위코드 ==! */
        , A.TRIF_BASE_VAL /** Valeur statistique !== 관세기준값 ==! */
        , A.PDLS_TTWG /** Poids brut de l'article !== 품목총중량 ==! */
        , A.PDLS_NTWG /** Poids net de l'article !== 품목순중량 ==! */
        , A.PDLS_PCKG_GCNT /** Nombre de colis de l'article !== 품목포장개수 ==! */
        , A.PDLS_PCKG_UT_CD /** Code d'unite de colis de l'article !== 품목포장단위코드 ==! */
        , A.VHCL_YN /** Vehicule ON !== 차량여부 ==! */
        , A.PDLS_PSMGT_TRGT_YN /** Objet de suivi de l'article ON !== 품목사후관리대상여부 ==! */
        , A.PDLS_PSMGT_FFMN_CMPL_YN /** Apurement de regime suspensif accompli ON !== 품목사후관리이행완료여부 ==! */
        , TO_CHAR(TO_DATE(A.PDLS_PSMGT_FFMN_CMPL_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS PDLS_PSMGT_FFMN_CMPL_DT /** Date de
        l'accomplissement de l'apurement de regime suspensif de l'article !== 품목사후관리이행완료일자 ==! */
        , A.PDLS_PSMGT_CONC_RSN_CD /** Code de cloture de suivi de l'article !== 품목사후관리종결사유코드 ==! */
        , A.OIL_TANK_NO
        , A.hs_err_pvnt_val
        , (select hs_err_pvnt_val from tb_clri_hs_cd where hs_cd = A.hs_cd and del_yn = 'N' limit 1) as HS_ERR_PVNT
        , A.regm_rqst_cd
        , A.prhb_cmdt_cd
        , A.hs_excp_mtr_cd             /** Code d'extrait de la sous position tarifaire !== HS예외사항코드 ==! */
        , alpassint.fn_get_excp_mtr_cd_nm(A.hs_cd, A.hs_excp_mtr_cd, 'A', '') AS hs_excp_mtr_nm
        , A.apc_excp_mtr_cd
        , alpassint.fn_get_excp_mtr_cd_nm(A.hs_cd, A.apc_excp_mtr_cd, 'B', A.apc_cd) AS apc_excp_mtr_nm
        , A.apc_dtl_cd
        , alpassint.fn_get_excp_mtr_cd_nm(A.hs_cd, A.apc_dtl_cd, 'D', A.apc_cd) AS apc_dtl_nm
        , A.prvl_excp_mtr_cd
        , alpassint.fn_get_excp_mtr_cd_nm(A.hs_cd, A.prvl_excp_mtr_cd, 'C', A.prvl_cd) AS prvl_excp_mtr_nm
        , A.adit_tx_qty
        , A.adit_tx_qty_ut_cd
        , A.PDLS_CLSF_BFHN_JDGN_PN
        , TO_CHAR(TO_DATE(A.apc_atpm_strt_dt    , 'YYYYMMDD'),'DD/MM/YYYY') AS apc_atpm_strt_dt
        , TO_CHAR(TO_DATE(A.apc_atpm_end_dt     , 'YYYYMMDD'),'DD/MM/YYYY') AS apc_atpm_end_dt
        , A.psmgt_ffmn_xpir_prid
        , C.PDLS_TXBS_USD_AMT
        , C.PDLS_TXBS_NCY_AMT
        , D.DTL_DCSH_NO AS STSZ_DTL_DCSH_NO
        , D.PDLS_NO AS STSZ_PDLS_NO
        , D.MDL_STSZ_NO AS STSZ_MDL_STSZ_NO
        , D.MDL_STSZ_NM AS STSZ_MDL_STSZ_NM
        , D.INGR_NM AS STSZ_INGR_NM
        , D.QTY AS STSZ_QTY
        , D.QTY_UT_CD AS STSZ_QTY_UT_CD
        , D.UT_PRC AS STSZ_UT_PRC
        , D.INVC_AMT AS STSZ_INVC_AMT
        , E.DTL_DCSH_NO AS RWMS_DTL_DCSH_NO
        , E.PDLS_NO AS RWMS_PDLS_NO
        , E.RWMS_SRNO AS RWMS_RWMS_SRNO
        , E.BF_DTL_DCSH_NO AS RWMS_BF_DTL_DCSH_NO
        , E.BF_PDLS_NO AS RWMS_BF_PDLS_NO
        , E.BF_HS_CD AS RWMS_BF_HS_CD
        , E.BF_CMDT_CLSF_SPEL_CD AS RWMS_BF_CMDT_CLSF_SPEL_CD
        , E.DIVD_FFMN_TP_CD AS RWMS_DIVD_FFMN_TP_CD
        , E.QTY AS RWMS_QTY
        , E.QTY_UT_CD AS RWMS_QTY_UT_CD
        , E.NTWG AS RWMS_NTWG
        , F.DTL_DCSH_NO AS STSZ_VHCL_DTL_DCSH_NO
        , F.PDLS_NO AS STSZ_VHCL_PDLS_NO
        , F.MDL_STSZ_NO AS STSZ_VHCL_MDL_STSZ_NO
        , F.CHSS_NO AS STSZ_VHCL_CHSS_NO
        , F.VHCL_MNUR_CD AS STSZ_VHCL_VHCL_MNUR_CD
        , (SELECT VHCL_MNUR_NM FROM TB_COM_VHCL_MNUR WHERE F.VHCL_MNUR_CD = VHCL_MNUR_CD AND DEL_YN = 'N') AS STSZ_VHCL_VHCL_MNUR_NM
        , F.CLR_NM AS STSZ_VHCL_CLR_NM
        , F.VHCL_MDL_CD AS STSZ_VHCL_VHCL_MDL_CD
        , (SELECT VHCL_MDL_NM FROM TB_COM_VHCL_MDL WHERE F.VHCL_MDL_CD = VHCL_MDL_CD AND DEL_YN = 'N') AS STSZ_VHCL_VHCL_MDL_NM
        , TO_CHAR(TO_DATE(F.FRST_OPRA_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS STSZ_VHCL_FRST_OPRA_DT
        , F.STCNT AS STSZ_VHCL_STCNT
        , F.IMP_PT_NM AS STSZ_VHCL_IMP_PT_NM
        , F.DRVR_NM AS STSZ_VHCL_DRVR_NM
        , F.DRVR_POST_NO AS STSZ_VHCL_DRVR_POST_NO
        , F.DRVR_ADDR AS STSZ_VHCL_DRVR_ADDR
        , F.MKNG_YY AS STSZ_VHCL_MKNG_YY
        , F.CAR_RGSR_NO AS STSZ_VHCL_CAR_RGSR_NO
        , SUBSTRING(F.VHCL_RELE_DT, 1, 4) AS STSZ_VHCL_VHCL_RELE_DT
        , F.VHCL_WGHT_CN AS STSZ_VHCL_VHCL_WGHT_CN
        , F.LOAD_WGHT_CN AS STSZ_VHCL_LOAD_WGHT_CN
        , F.TRSF_UNBL_TP_CD AS STSZ_VHCL_TRSF_UNBL_TP_CD
        , F.IMP_CRPP_NO AS STSZ_VHCL_IMP_CRPP_NO
        , F.OTPT_CN AS STSZ_VHCL_OTPT_CN
        , F.DPCMT_CN AS STSZ_VHCL_DPCMT_CN
        , F.FL_KND_NM AS STSZ_VHCL_FL_KND_NM
        , F.VHCL_KND_CD AS STSZ_VHCL_VHCL_KND_CD
        , F.CABO_NM AS STSZ_VHCL_CABO_NM
        , TO_CHAR(TO_DATE(F.IMP_CRPP_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS STSZ_VHCL_IMP_CRPP_DT
        , F.IMP_CRPP_PRID AS STSZ_VHCL_IMP_CRPP_PRID
        , F.VHCL_CSCL_MGMT_NO AS STSZ_VHCL_VHCL_CSCL_MGMT_NO
        FROM TB_CLRI_DED_PDLS_H A
        INNER JOIN TB_CLRI_DED_COMN B ON A.DTL_DCSH_NO = B.DTL_DCSH_NO AND B.DEL_YN = 'N'
        INNER JOIN TB_CLRI_DED_VLUT_PDLS_H C ON A.DTL_DCSH_NO = C.DTL_DCSH_NO AND A.PDLS_NO = C.PDLS_NO AND A.HIST_SRNO
        = C.HIST_SRNO AND C.DEL_YN = 'N'
        LEFT JOIN TB_CLRI_DED_MDL_STSZ_H D ON A.DTL_DCSH_NO = D.DTL_DCSH_NO AND A.PDLS_NO = D.PDLS_NO AND A.HIST_SRNO =
        D.HIST_SRNO AND D.DEL_YN = 'N'
        LEFT JOIN TB_CLRI_DED_RWMS_H E ON A.DTL_DCSH_NO = E.DTL_DCSH_NO AND A.PDLS_NO = E.PDLS_NO AND A.HIST_SRNO =
        E.HIST_SRNO AND E.DEL_YN = 'N'
        LEFT JOIN TB_CLRI_DED_VHCL_H F ON A.DTL_DCSH_NO = F.DTL_DCSH_NO AND A.PDLS_NO = F.PDLS_NO AND D.MDL_STSZ_NO = F.MDL_STSZ_NO AND A.HIST_SRNO =
        F.HIST_SRNO AND F.DEL_YN = 'N'
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>
        AND A.DEL_YN = 'N'
        ORDER BY TO_NUMBER(A.PDLS_NO), TO_NUMBER(D.MDL_STSZ_NO), E.RWMS_SRNO
    </select>

    <!-- DED 업체 이력 정보 조회 -->
    <select id="selectDedCoHistInfo" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedCoHVo">
        /* selectDedCoHistInfo */

        SELECT
        A.DTL_DCSH_NO
        , A.EXPPN_CO_NM
        , A.EXPPN_ADDR
        , A.IMPPN_CO_NM
        , A.IMPPN_ADDR
        , A.TXPR_CO_NM
        , A.TXPR_ADDR
        , A.TXPR_TLPH_NO
        , A.TXPR_EML
        , A.DCER_CO_NM
        , A.DCER_ADDR
        , A.BFCY_CO_NM /** Nom De L''Entreprise Du Bénéficiaire */
        , A.BFCY_ADDR /** Adresse Benef */
        FROM TB_CLRI_DED_CO_H A
        , TB_CLRI_DED_COMN B
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.DEL_YN = 'N'
        AND B.DEL_YN = 'N'
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>
    </select>

    <!-- DED담보정보 조회 -->
    <select id="selectDedMgHistInfo" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedMgHVo">
        /* selectDedMgHistInfo */
        SELECT
        A.DTL_DCSH_NO
        , A.MG_AC_NO
        , A.MG_TP_CD
        FROM TB_CLRI_DED_MG_H A
        , TB_CLRI_DED_COMN B
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.DEL_YN = 'N'
        AND B.DEL_YN = 'N'
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>

    </select>

    <!-- Consultation de la liste des conteneurs de DED !==DED 컨테이너 목록 조회==! -->
    <select id="selectDedCntrHistList" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedCntrHVo">
        /* selectDedCntrHistList */
        SELECT
        A.DTL_DCSH_NO
        , A.CNTR_SRNO
        , A.CNTR_NO
        , A.CNTR_TP_CD
        , A.CNTR_STFN_STTS_CD
        , A.SEAL_NO1
        , A.SEAL_NO2
        , A.SEAL_NO3
        , A.SEAL_CHPN1
        , A.SEAL_CHPN2
        , A.SEAL_CHPN3
        , (
        SELECT CNTR_SCN_URL
        FROM (
        SELECT CNTR_SCN_URL
        FROM TB_COM_CNTR_SCN_IMGE C
        WHERE C.CNTR_NO = A.CNTR_NO
        AND C.IMEX_TP_CD = 'EXP' /* 수출 */
        AND C.REFF_NO = A.DTL_DCSH_NO /* DED번호 */
        AND C.DEL_YN = 'N'
        UNION ALL
        SELECT CNTR_SCN_URL
        FROM TB_COM_CNTR_SCN_IMGE C
        WHERE C.CNTR_NO = A.CNTR_NO
        AND C.IMEX_TP_CD = 'IMP' /* 수입 */
        AND C.REFF_NO = SUBSTR(B.CAG_MGMT_NO, 0, 15) /* MRN */
        AND C.DEL_YN = 'N'
        )
        WHERE ROWNUM = 1
        ) AS CNTR_SCN_URL
        FROM TB_CLRI_DED_CNTR_H A
        , TB_CLRI_DED_COMN B
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.DEL_YN = 'N'
        AND B.DEL_YN = 'N'
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>
    </select>

    <!-- DED 세금 목록 조회 -->
    <select id="selectDedTaxHistList" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedTaxVo">
        /* selectDedTaxHistList */
        SELECT
        A.dtl_dcsh_no /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
        , A.pdls_no /** N° D'Article !== 품목번호 ==! */
        , A.tax_cd /** Code De Taxe !== 세금코드 ==! */
        , A.txbs_amt /** Montant de base d'imposition !== 과세기준금액 ==! */
        , A.tfrt_ctgy_cd /** Code de categorie du tarif !== 관세율카테고리코드 ==! */
        , NVL(A.TXRT, 0) AS TXRT
        , NVL(A.TAX_AMT, 0) AS TAX_AMT
        , NVL(A.PAY_TAX_AMT,0) AS PAY_TAX_AMT
        , A.pay_knd_cd /** Code De Type De Paiement !== 납부종류코드 ==! */
        , A.rdex_pt_cd /** Code De Type D'Exonération !== 감면유형코드 ==! */
        , A.rdex_cd /** Code d'avantage fiscaux !== 감면코드 ==! */
        , NVL(A.RDEX_AMT,0) AS RDEX_AMT
        , NVL(A.RDEX_BASE_AMT,0) AS RDEX_BASE_AMT
        , NVL(A.RDEX_TXRT,0) AS RDEX_TXRT
        , A.mg_dscn_aply_amt /** Montant de caution après l'exemption de la garantie !== 담보할인적용금액 ==! */
        , A.bscs_txbs_amt /** Montant De La Base Taxable Basique !== 기본과세기준금액 ==! */
        , A.bscs_txrt /** Taux d'imposition de base !== 기본세율 ==! */
        , A.bscs_tax_amt /** Montant De La Taxe Basique !== 기본세금금액 ==! */
        , A.del_yn /** Suppression On !== 삭제여부 ==! */
        , A.frst_regst_id /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , A.frst_rgsr_dttm /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
        , A.last_chpr_id /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , A.last_chg_dttm /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        FROM TB_CLRI_DED_TAX_H A, TB_CLRI_DED_COMN B
        WHERE A.del_yn = 'N' /** Suppression ON !== 삭제여부 ==! */
        AND A.DTL_DCSH_NO = B.DTL_DCSH_NO
        AND A.dtl_dcsh_no = #{dtlDcshNo} /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
        <if test='histSrno == null or histSrno.equals("")'>
            AND A.HIST_SRNO = B.HIST_SRNO - 1
        </if>
        <if test="histSrno != null and histSrno != -1">
            AND A.HIST_SRNO = #{histSrno}
        </if>
        ORDER BY A.tax_cd
    </select>


    <!-- 해당정정신청서한 심사결과 등록 여부 확인 -->
    <select id="selectDedAdrtYn" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* selectDedAdrtYn */
        SELECT A.DTL_DCSH_NO
        FROM TB_CLRI_DED_ADRT A
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
          AND A.HIST_SRNO = #{histSrno}
          AND A.DEL_YN = 'N'
    </select>

    <select id="selectDedComnbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedComnDcshVo">
        SELECT A.dclr_dt
             , A.reff_no
             , A.mdfy_dgcnt
             , A.rqst_dt
             , A.dclr_pt_cd
             , A.epc_cd
             , A.cscl_pln_cd
             , A.dcsh_fm_cd
             , A.pdls_gcnt
             , A.pckg_tgcnt
             , A.cntr_cag_yn
             , A.al_ttwg
             , A.al_ntwg
             , A.exppn_idfy_no_tp_cd
             , A.imppn_idfy_no_tp_cd
             , A.csm_cnty_cd
             , A.trde_dlng_cnty_cd
             , A.exp_cnty_cd
             , A.dstn_cnty_cd
             , A.dstn_regn_cd
             , A.trnp_meth_knd_cd
             , A.trnp_meth_idfy_no
             , A.trnp_meth_nat_cd
             , A.ship_nm
             , A.bl_no
             , A.arvl_dt
             , A.divd_cscl_tp_cd
             , A.ldnp_cd
             , A.cntr_gcnt
             , A.dispr_cd
             , A.ldun_dt
             , A.psmgt_ffmn_xpir_prid
             , A.dcrd_yn
             , A.dlvr_cond_cd
             , A.dlvr_plc_cd
             , A.invc_no
             , A.invc_pbls_dt
             , A.pymn_mean_cd
             , A.pymn_ac_no
             , A.dlng_cond1_cd
             , A.dlng_cond2_cd
             , A.prc_dcsh_wrte_yn
             , A.owhs_prc_ev_yn
             , A.dcer_wrte_cn
             , A.mdfy_rsn_cd
             , A.mdfy_rsn_cn
             , A.prcs_stts_cd
             , A.insc_emp_id
             , A.selc_rslt_cd
             , A.insc_plc_tp_cd
             , A.psmgt_trgt_yn
             , A.psmgt_ffmn_cmpl_yn
             , A.psmgt_ffmn_cmpl_dt
             , A.ador_hnot_prcs_yn
             , A.ador_hnot_opin_cn
             , A.hist_srno
             , A.exp_ffmn_cmpl_dt
             , A.exp_ffmn_xpir_dt
             , A.asmt_dt
             , A.acpt_yn
             , A.acpt_dt
             , A.rlse_yn
             , A.rlse_dt
             , A.atr_dclr_rcpn_yn
             , A.cncl_dclr_rcpn_yn
             , (SELECT NVL(MIN('Y'), 'N') AS CSCL_PSTP_YN
                FROM DUAL
                WHERE EXISTS(
                        SELECT 1
                        FROM TB_CLRI_DED_SPLM_QRY
                        WHERE DTL_DCSH_NO = #{dtlDcshNo}
                          AND LAST_YN = 'Y'
                          AND DEL_YN = 'N'
                    )
                   OR EXISTS(
                        SELECT 1
                        FROM TB_CLRI_DED_CSCL_PSTP
                        WHERE DTL_DCSH_NO = #{dtlDcshNo}
                          AND LAST_YN = 'Y'
                          AND DEL_YN = 'N'
                          AND CSCL_PSTP_RELE_YN = 'N'
                    )) /** Dedouanement suspendu ON !== 통관보류여부 ==! */
             , A.dput_yn
             , A.prvi_dclr_apre_yn
             , A.new_sys_yn
             , 'N'
             , A.frst_regst_id
             , A.frst_rgsr_dttm
             , #{userId}
             , systimestamp
             , A.wkng_pt_cd
             , A.exppn_cmrc_regs_no
             , A.imppn_cmrc_regs_no
             , A.txpr_cmrc_regs_no
             , A.imppn_idfy_no
             , A.exppn_idfy_no
             , A.txpr_idfy_no
             , A.cag_mgmt_no
             , A.audt_emp_id
             , A.bf_bnbn_cmdt_wrhs_cd
             , A.bnbn_cmdt_wrhs_cd
             , A.cmdt_stge_loct_cd
             , A.dcer_cd
             , A.dclr_cstm_cd
             , A.dept_cd
             , A.audt_dept_cd
             , A.pymn_bnk_brnh_cd
             , A.pymn_bnk_cd
             , A.rlbr_cstm_cd
             , A.csor_aprv_rsof_yn
             , A.dphd_aprv_rsof_yn
             , A.dept_hnot_prcs_yn
             , A.dept_hnot_opin_cn
             , A.prmsnt_dt
             , NVL(A.sys_use_ss, 1) as sys_use_ss
             , A.exp_cmdt_brng_rqno         /** N° demande de l'introduction des marchandises à exporter !== 수출물품반입신청번호 ==! */
             , A.exp_cmdt_loct_nm           /** Exporter le nom de l'emplacement du produit !== 수출물품위치명 ==! */
             , A.bf_dtl_dcsh_no             /** N° de la déclaration en détail précédent !== 이전상세신고서번호 ==! */
             , A.bfhn_no                    /** N° de autorisation pour PAD et provisoire !== 사전허가번호 ==! */
             , A.pad_bfhn_no
             , A.prvi_bfhn_no
             , A.bfcy_idfy_no                /** NIF du bénéficiaire */
             , A.bfcy_cmrc_regs_no           /** Registre de commerce du bénéficiaire */
             , A.PRMSNT_STTS_CD
             , A.bl_dt
             , A.DLNG_PYMN_MEAN_CD
        FROM TB_CLRI_DED_COMN_H A
        WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
          AND A.HIST_SRNO = #{histSrno} - 1
          AND A.DEL_YN = 'N'
    </select>

    <!-- CLRI_상세신고서공통 이전 버전으로 되돌리기 -->
    <update id="updateDedComnbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Revenir à la version précédente de la généralité de la déclaration en détail
         * CLRI_상세신고서공통 이전 버전으로 되돌리기
        */
        UPDATE tb_clri_ded_comn
        SET (
             DCLR_DT, REFF_NO, MDFY_DGCNT, RQST_DT, DCLR_PT_CD, EPC_CD, CSCL_PLN_CD, DCSH_FM_CD, PDLS_GCNT, PCKG_TGCNT,
             CNTR_CAG_YN, AL_TTWG, AL_NTWG, EXPPN_IDFY_NO_TP_CD, IMPPN_IDFY_NO_TP_CD, CSM_CNTY_CD, TRDE_DLNG_CNTY_CD,
             EXP_CNTY_CD, DSTN_CNTY_CD, DSTN_REGN_CD, TRNP_METH_KND_CD, TRNP_METH_IDFY_NO, TRNP_METH_NAT_CD, SHIP_NM,
             BL_NO, ARVL_DT, DIVD_CSCL_TP_CD, LDNP_CD, CNTR_GCNT, DISPR_CD, LDUN_DT, PSMGT_FFMN_XPIR_PRID, DCRD_YN,
             DLVR_COND_CD, DLVR_PLC_CD, INVC_NO, INVC_PBLS_DT, PYMN_MEAN_CD, PYMN_AC_NO, DLNG_COND1_CD, DLNG_COND2_CD,
             PRC_DCSH_WRTE_YN, OWHS_PRC_EV_YN, DCER_WRTE_CN, MDFY_RSN_CD, MDFY_RSN_CN, PRCS_STTS_CD, INSC_EMP_ID,
             SELC_RSLT_CD, INSC_PLC_TP_CD, PSMGT_TRGT_YN, PSMGT_FFMN_CMPL_YN, PSMGT_FFMN_CMPL_DT, ADOR_HNOT_PRCS_YN,
             ADOR_HNOT_OPIN_CN, HIST_SRNO, EXP_FFMN_CMPL_DT, EXP_FFMN_XPIR_DT, ASMT_DT,
             CSCL_PSTP_YN,
             NEW_SYS_YN, DEL_YN,
             LAST_CHPR_ID, LAST_CHG_DTTM, WKNG_PT_CD, EXPPN_CMRC_REGS_NO,
             IMPPN_CMRC_REGS_NO, TXPR_CMRC_REGS_NO, IMPPN_IDFY_NO, EXPPN_IDFY_NO, TXPR_IDFY_NO, CAG_MGMT_NO,
             AUDT_EMP_ID, BF_BNBN_CMDT_WRHS_CD, BNBN_CMDT_WRHS_CD, CMDT_STGE_LOCT_CD, DCER_CD, DCLR_CSTM_CD, DEPT_CD,
             audt_dept_cd, PYMN_BNK_BRNH_CD, PYMN_BNK_CD, RLBR_CSTM_CD, CSOR_APRV_RSOF_YN, DPHD_APRV_RSOF_YN,
             DEPT_HNOT_PRCS_YN, DEPT_HNOT_OPIN_CN, prmsnt_dt, sys_use_ss, exp_cmdt_brng_rqno, exp_cmdt_loct_nm, bf_dtl_dcsh_no,
             bfhn_no, pad_bfhn_no ,prvi_bfhn_no, bfcy_idfy_no, bfcy_cmrc_regs_no, PRMSNT_STTS_CD, bl_dt, DLNG_PYMN_MEAN_CD
                ) = (SELECT A.dclr_dt
                          , A.reff_no
                          , A.mdfy_dgcnt
                          , A.rqst_dt
                          , A.dclr_pt_cd
                          , A.epc_cd
                          , A.cscl_pln_cd
                          , A.dcsh_fm_cd
                          , A.pdls_gcnt
                          , A.pckg_tgcnt
                          , A.cntr_cag_yn
                          , A.al_ttwg
                          , A.al_ntwg
                          , A.exppn_idfy_no_tp_cd
                          , A.imppn_idfy_no_tp_cd
                          , A.csm_cnty_cd
                          , A.trde_dlng_cnty_cd
                          , A.exp_cnty_cd
                          , A.dstn_cnty_cd
                          , A.dstn_regn_cd
                          , A.trnp_meth_knd_cd
                          , A.trnp_meth_idfy_no
                          , A.trnp_meth_nat_cd
                          , A.ship_nm
                          , A.bl_no
                          , A.arvl_dt
                          , A.divd_cscl_tp_cd
                          , A.ldnp_cd
                          , A.cntr_gcnt
                          , A.dispr_cd
                          , A.ldun_dt
                          , A.psmgt_ffmn_xpir_prid
                          , A.dcrd_yn
                          , A.dlvr_cond_cd
                          , A.dlvr_plc_cd
                          , A.invc_no
                          , A.invc_pbls_dt
                          , A.pymn_mean_cd
                          , A.pymn_ac_no
                          , A.dlng_cond1_cd
                          , A.dlng_cond2_cd
                          , A.prc_dcsh_wrte_yn
                          , A.owhs_prc_ev_yn
                          , A.dcer_wrte_cn
                          , A.mdfy_rsn_cd
                          , A.mdfy_rsn_cn
                          , A.prcs_stts_cd
                          , A.insc_emp_id
                          , A.selc_rslt_cd
                          , A.insc_plc_tp_cd
                          , A.psmgt_trgt_yn
                          , A.psmgt_ffmn_cmpl_yn
                          , A.psmgt_ffmn_cmpl_dt
                          , A.ador_hnot_prcs_yn
                          , A.ador_hnot_opin_cn
                          , A.hist_srno
                          , A.exp_ffmn_cmpl_dt
                          , A.exp_ffmn_xpir_dt
                          , A.asmt_dt
                          , (SELECT NVL(MIN('Y'), 'N') AS CSCL_PSTP_YN
                             FROM DUAL
                             WHERE EXISTS(
                                     SELECT 1
                                     FROM TB_CLRI_DED_SPLM_QRY
                                     WHERE DTL_DCSH_NO = #{dtlDcshNo}
                                       AND LAST_YN = 'Y'
                                       AND DEL_YN = 'N'
                                 )
                                OR EXISTS(
                                     SELECT 1
                                     FROM TB_CLRI_DED_CSCL_PSTP
                                     WHERE DTL_DCSH_NO = #{dtlDcshNo}
                                       AND LAST_YN = 'Y'
                                       AND DEL_YN = 'N'
                                       AND CSCL_PSTP_RELE_YN = 'N'
                                 )) /** Dedouanement suspendu ON !== 통관보류여부 ==! */
                          , A.new_sys_yn
                          , 'N'
                          , #{userId}
                          , systimestamp
                          , A.wkng_pt_cd
                          , A.exppn_cmrc_regs_no
                          , A.imppn_cmrc_regs_no
                          , A.txpr_cmrc_regs_no
                          , A.imppn_idfy_no
                          , A.exppn_idfy_no
                          , A.txpr_idfy_no
                          , A.cag_mgmt_no
                          , A.audt_emp_id
                          , A.bf_bnbn_cmdt_wrhs_cd
                          , A.bnbn_cmdt_wrhs_cd
                          , A.cmdt_stge_loct_cd
                          , A.dcer_cd
                          , A.dclr_cstm_cd
                          , A.dept_cd
                          , (SELECT audt_dept_cd FROM TB_CLRI_DED_COMN WHERE dtl_dcsh_no = #{dtlDcshNo})
                          , A.pymn_bnk_brnh_cd
                          , A.pymn_bnk_cd
                          , A.rlbr_cstm_cd
                          , A.csor_aprv_rsof_yn
                          , A.dphd_aprv_rsof_yn
                          , A.dept_hnot_prcs_yn
                          , A.dept_hnot_opin_cn
                          , A.prmsnt_dt
                          , NVL(A.sys_use_ss, 1) as sys_use_ss
                          , A.exp_cmdt_brng_rqno         /** N° demande de l'introduction des marchandises à exporter !== 수출물품반입신청번호 ==! */
                          , A.exp_cmdt_loct_nm           /** Exporter le nom de l'emplacement du produit !== 수출물품위치명 ==! */
                          , A.bf_dtl_dcsh_no             /** N° de la déclaration en détail précédent !== 이전상세신고서번호 ==! */
                          , A.bfhn_no                    /** N° de autorisation pour PAD et provisoire !== 사전허가번호 ==! */
                          , A.pad_bfhn_no
                          , A.prvi_bfhn_no
                          , A.bfcy_idfy_no              /** NIF du bénéficiaire */
                          , A.bfcy_cmrc_regs_no         /** Registre de commerce du bénéficiaire */
                          , A.PRMSNT_STTS_CD
                          , A.bl_dt
                          , A.DLNG_PYMN_MEAN_CD
                     FROM TB_CLRI_DED_COMN_H A
                     WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
                       AND A.HIST_SRNO = #{histSrno} - 1
                       AND A.DEL_YN = 'N')
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
    </update>

    <!-- CLRI_상세신고서업체 이전 버전으로 되돌리기 -->
    <update id="updateDedCobfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Revenir à la version précédente de l'opérateur de la déclaration en détail
         * CLRI_상세신고서업체 이전 버전으로 되돌리기
         void updateDedCobfVer(ClrDedSrchVo searchVo);
        */
        UPDATE TB_CLRI_DED_CO
        SET (
             EXPPN_CO_NM, EXPPN_ADDR, IMPPN_CO_NM, IMPPN_ADDR, TXPR_CO_NM, TXPR_ADDR, TXPR_TLPH_NO, TXPR_EML,
             BFCY_CO_NM, BFCY_ADDR, DCER_CO_NM, DCER_ADDR, DEL_YN, FRST_REGST_ID, FRST_RGSR_DTTM, LAST_CHPR_ID, LAST_CHG_DTTM
                ) = (SELECT A.exppn_co_nm
                          , A.exppn_addr
                          , A.imppn_co_nm
                          , A.imppn_addr
                          , A.txpr_co_nm
                          , A.txpr_addr
                          , A.txpr_tlph_no
                          , A.txpr_eml
                          , A.BFCY_CO_NM /** Nom De L''Entreprise Du Bénéficiaire */
                          , A.BFCY_ADDR /** Adresse Benef */
                          , A.dcer_co_nm
                          , A.dcer_addr
                          , 'N'
                          , A.frst_regst_id
                          , A.frst_rgsr_dttm
                          , #{userId}
                          , SYSTIMESTAMP
                     FROM TB_CLRI_DED_CO_H A
                     WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
                       AND A.HIST_SRNO = #{histSrno} - 1
                       AND A.DEL_YN = 'N')
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
    </update>

    <!-- 가격평가공통 원복 (이력->공통) 이전 버전으로 되돌리기 -->
    <update id="updateDedVlutComnbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Revenir à la version précédente de l'estimation de la valeur générale (historique -> général)
         * 가격평가공통 원복 (이력->공통) 이전 버전으로 되돌리기
         void updateDedVlutComnbfVer(ClrDedSrchVo searchVo);
        */
        UPDATE tb_clri_ded_vlut_comn
        SET (
             INVC_AMT, INVC_FXRT, INVC_NCY_AMT, INVC_USD_AMT, CACH_AMT, CACH_CURR_CD, CACH_FXRT, CACH_NCY_AMT,
             INFEE_AMT, INFEE_CURR_CD, INFEE_FXRT, INFEE_NCY_AMT, OTCST_AMT, OTCST_CURR_CD, OTCST_FXRT, OTCST_NCY_AMT,
             DDCT_AMT, DDCT_RT, DDCT_CURR_CD, DDCT_FXRT, DDCT_NCY_AMT, TTXBS_NCY_AMT, TTXBS_USD_AMT, TVLUT_NCY_AMT,
             TVLUT_USD_AMT, DEL_YN, FRST_REGST_ID, FRST_RGSR_DTTM, LAST_CHPR_ID, LAST_CHG_DTTM, INVC_CURR_CD
                ) = (SELECT A.invc_amt
                          , A.invc_fxrt
                          , A.invc_ncy_amt
                          , A.invc_usd_amt
                          , A.cach_amt
                          , A.cach_curr_cd
                          , A.cach_fxrt
                          , A.cach_ncy_amt
                          , A.infee_amt
                          , A.infee_curr_cd
                          , A.infee_fxrt
                          , A.infee_ncy_amt
                          , A.otcst_amt
                          , A.otcst_curr_cd
                          , A.otcst_fxrt
                          , A.otcst_ncy_amt
                          , A.ddct_amt
                          , A.ddct_rt
                          , A.ddct_curr_cd
                          , A.ddct_fxrt
                          , A.ddct_ncy_amt
                          , A.ttxbs_ncy_amt
                          , A.ttxbs_usd_amt
                          , A.tvlut_ncy_amt
                          , A.tvlut_usd_amt
                          , 'N'
                          , A.frst_regst_id
                          , A.frst_rgsr_dttm
                          , #{userId}
                          , systimestamp
                          , A.invc_curr_cd
                     FROM TB_CLRI_DED_VLUT_COMN_H A
                     WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
                       AND A.HIST_SRNO = #{histSrno} - 1
                       AND A.DEL_YN = 'N')
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
    </update>

    <!-- CLRI_상세신고서가격신고 이전 버전으로 되돌리기 -->
    <update id="updateDedPrcDclrbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Revenir à la version précédente de la déclaration de valeur de la déclaration en détail
         * CLRI_상세신고서가격신고 이전 버전으로 되돌리기
         void updateDedPrcDclrbfVer(ClrDedSrchVo searchVo);
        */
        UPDATE tb_clri_ded_prc_dclr
        SET (
             BYER_IDFY_NO, SELR_NO, INVC_NO, INVC_PBLS_DT, CVNT_NO, CVNT_DT, DLVR_COND_CD, BFHN_DTRM_OFDC_NO,
             BFHN_DTRM_OFDC_PBLS_DT, QUES_RSPN_1_YN, QUES_RSPN_2_YN, QUES_RSPN_3_YN, QUES_RSPN_4_YN, QUES_RSPN_5_YN,
             QUES_RSPN_6_YN, QUES_RSPN_7_YN, DCER_NM, DCLR_PLC_NM, DCLR_DT, CPUT_BSS_DLNG_PRC, CPUT_BSS_INDR_AMT,
             CPUT_BSS_SUM_AMT, ADCST_SALE_CMIS_YN, ADCST_PUCH_CMIS_YN, ADCST_BRKG_AMT, ADCST_CTNR_PCKG_CST,
             ADCST_MTRL_CMPS_FTOR_CST, ADCST_TOOL_OTCST, ADCST_CNSM_CMDT_CST, ADCST_TECH_DGN_OTCST, ADCST_RYLT_CST,
             ADCST_SELR_RVRS_AMT, ADCST_TRNP_CST, ADCST_IMP_PORT_TRCG_AMT, ADCST_IMP_PORT_OTCST, ADCST_PRCS_CST,
             ADCST_IMP_PORT_INFEE_AMT, ADTN_CST_SUM_AMT, DDCT_TRNP_CST, DDCT_OTCST, DDCT_OTHS_APMT_AMT,
             DDCT_EXP_CNTY_TRIF_AMT, DDCT_SUM_AMT, DCLR_TX_PRC, DEL_YN, FRST_REGST_ID, FRST_RGSR_DTTM, LAST_CHPR_ID,
             LAST_CHG_DTTM, OTHS_DESC, RSTC_MTR_CN, QUES_RSPN_8_YN, ADIT_OPIN_CN
                ) = (SELECT A.byer_idfy_no
                          , A.selr_no
                          , A.invc_no
                          , A.invc_pbls_dt
                          , A.cvnt_no
                          , A.cvnt_dt
                          , A.dlvr_cond_cd
                          , A.bfhn_dtrm_ofdc_no
                          , A.bfhn_dtrm_ofdc_pbls_dt
                          , A.ques_rspn_1_yn
                          , A.ques_rspn_2_yn
                          , A.ques_rspn_3_yn
                          , A.ques_rspn_4_yn
                          , A.ques_rspn_5_yn
                          , A.ques_rspn_6_yn
                          , A.ques_rspn_7_yn
                          , A.dcer_nm
                          , A.dclr_plc_nm
                          , A.dclr_dt
                          , A.cput_bss_dlng_prc
                          , A.cput_bss_indr_amt
                          , A.cput_bss_sum_amt
                          , A.adcst_sale_cmis_yn
                          , A.adcst_puch_cmis_yn
                          , A.adcst_brkg_amt
                          , A.adcst_ctnr_pckg_cst
                          , A.adcst_mtrl_cmps_ftor_cst
                          , A.adcst_tool_otcst
                          , A.adcst_cnsm_cmdt_cst
                          , A.adcst_tech_dgn_otcst
                          , A.adcst_rylt_cst
                          , A.adcst_selr_rvrs_amt
                          , A.adcst_trnp_cst
                          , A.adcst_imp_port_trcg_amt
                          , A.adcst_imp_port_otcst
                          , A.adcst_prcs_cst
                          , A.adcst_imp_port_infee_amt
                          , A.adtn_cst_sum_amt
                          , A.ddct_trnp_cst
                          , A.ddct_otcst
                          , A.ddct_oths_apmt_amt
                          , A.ddct_exp_cnty_trif_amt
                          , A.ddct_sum_amt
                          , A.dclr_tx_prc
                          , 'N'
                          , A.frst_regst_id
                          , A.frst_rgsr_dttm
                          , #{userId}
                          , SYSTIMESTAMP
                          , A.oths_desc
                          , A.rstc_mtr_cn
                          , A.ques_rspn_8_yn
                          , A.adit_opin_cn
                     FROM TB_CLRI_DED_PRC_DCLR_H A
                     WHERE A.DTL_DCSH_NO = #{dtlDcshNo}
                       AND A.HIST_SRNO = #{histSrno} - 1
                       AND A.DEL_YN = 'N')
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
    </update>

    <!-- Restaurer l'article de l'estimation de la valeur de la déclaration en détail à la version précédente : CLRI_상세신고서가격평가품목 이전 버전으로 되돌리기 -->
    <insert id="updateDedPrcDclrPdlsBfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        INSERT INTO TB_CLRI_DED_PRC_DCLR_PDLS (
            DTL_DCSH_NO
        , PDLS_NO
        , mdl_stsz_no
        , INDR_PYMN_TAMT
        , PCFE_AMT
        , MDTN_PCFE_AMT
        , PCKG_AMT
        , MNFU_SRVC_1_AMT
        , MNFU_SRVC_2_AMT
        , MNFU_SRVC_3_AMT
        , MNFU_SRVC_4_AMT
        , PCFE_LCNE_AMT
        , RESALE_ERN_AMT
        , TRNP_CST_AMT
        , LOAD_CST_AMT
        , INFEE_AMT
        , BRNG_TRNP_CST
        , TECH_SPPT_CST
        , OTCST_AMT
        , PYR_TRIF_AMT
        , byer_pymn_cst
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM)
        SELECT DTL_DCSH_NO
             , PDLS_NO
             , mdl_stsz_no
             , INDR_PYMN_TAMT
             , PCFE_AMT
             , MDTN_PCFE_AMT
             , PCKG_AMT
             , MNFU_SRVC_1_AMT
             , MNFU_SRVC_2_AMT
             , MNFU_SRVC_3_AMT
             , MNFU_SRVC_4_AMT
             , PCFE_LCNE_AMT
             , RESALE_ERN_AMT
             , TRNP_CST_AMT
             , LOAD_CST_AMT
             , INFEE_AMT
             , BRNG_TRNP_CST
             , TECH_SPPT_CST
             , OTCST_AMT
             , PYR_TRIF_AMT
             , NVL(byer_pymn_cst, 0)
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
        FROM TB_CLRI_DED_PRC_DCLR_PDLS_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , PDLS_NO, mdl_stsz_no )
            DO UPDATE SET DTL_DCSH_NO     = excluded.DTL_DCSH_NO
                        , INDR_PYMN_TAMT  = excluded.INDR_PYMN_TAMT
                        , PCFE_AMT        = excluded.PCFE_AMT
                        , MDTN_PCFE_AMT   = excluded.MDTN_PCFE_AMT
                        , PCKG_AMT        = excluded.PCKG_AMT
                        , MNFU_SRVC_1_AMT = excluded.MNFU_SRVC_1_AMT
                        , MNFU_SRVC_2_AMT = excluded.MNFU_SRVC_2_AMT
                        , MNFU_SRVC_3_AMT = excluded.MNFU_SRVC_3_AMT
                        , MNFU_SRVC_4_AMT = excluded.MNFU_SRVC_4_AMT
                        , PCFE_LCNE_AMT   = excluded.PCFE_LCNE_AMT
                        , RESALE_ERN_AMT  = excluded.RESALE_ERN_AMT
                        , TRNP_CST_AMT    = excluded.TRNP_CST_AMT
                        , LOAD_CST_AMT    = excluded.LOAD_CST_AMT
                        , INFEE_AMT       = excluded.INFEE_AMT
                        , BRNG_TRNP_CST   = excluded.BRNG_TRNP_CST
                        , TECH_SPPT_CST   = excluded.TECH_SPPT_CST
                        , OTCST_AMT       = excluded.OTCST_AMT
                        , PYR_TRIF_AMT    = excluded.PYR_TRIF_AMT
                        , byer_pymn_cst   = excluded.byer_pymn_cst
                        , DEL_YN          = excluded.DEL_YN
                        , FRST_REGST_ID   = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM  = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID    = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM   = excluded.LAST_CHG_DTTM

    </insert>

    <!--
    CLRI_Suppression du document joint de la déclaration en détail !== CLRI_상세신고서첨부문서 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedAtdoc" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /*
        void deleteDedAtdoc(ClrDedSrchVo deleteVo);
         */
        DELETE
        FROM TB_CLRI_DED_ATDOC
        WHERE dtl_dcsh_no = #{dtlDcshNo}

    </delete>

    <!--
	Supprimer la caution de DED
	!== DED 담보 삭제 ==!
	-->
    <delete id="deleteDedMg" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        DELETE
        FROM TB_CLRI_DED_MG
        WHERE dtl_dcsh_no = #{dtlDcshNo}
    </delete>

    <!--
    CLRI_Suppression du conteneur de la déclaration en détail !== CLRI_상세신고서컨테이너 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedCntr" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression du conteneur de la déclaration en détail !== CLRI_상세신고서컨테이너 삭제 ==!
        void deleteDedCntr(DedCntrVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_CNTR
        WHERE dtl_dcsh_no = #{dtlDcshNo}
    </delete>

    <!--
    CLRI_Suppression de l'article à réimporter/réexporter de la déclaration en détail !== CLRI_상세신고서재수입재수출예정품목 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedRimexPrngPdls" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'article à réimporter/réexporter de la déclaration en détail !== CLRI_상세신고서재수입재수출예정품목 삭제 ==!
        void deleteDedRimexPrngPdls(ClrDedRimexPrngPdlsVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_RIMEX_PRNG_PDLS
        WHERE dtl_dcsh_no = #{dtlDcshNo}
    </delete>

    <!--
    CLRI_Suppression du véhicule de la déclaration en détail !== CLRI_상세신고서차량 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedVhcl" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression du véhicule de la déclaration en détail !== CLRI_상세신고서차량 삭제 ==!
        void deleteDedVhcl(ClrDedVhclVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_VHCL
        WHERE dtl_dcsh_no = #{dtlDcshNo}
    </delete>

    <!--
    Suppression de la matière première !== 원재료 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedRwms" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Suppression de la matière première !== 원재료 삭제 ==!
        void deleteDedRwms(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_RWMS
        WHERE dtl_dcsh_no = #{dtlDcshNo}

    </delete>

    <!--
  CLRI_Suppression de modèle/spécification de la déclaration en détail !== CLRI_상세신고서모델규격 삭제 ==!
  (Kim Kiryong)
  -->
    <delete id="deleteDedMdlStsz" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de modèle/spécification de la déclaration en détail !== CLRI_상세신고서모델규격 삭제 ==!
        void deleteDedMdlStsz(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_MDL_STSZ
        WHERE dtl_dcsh_no = #{dtlDcshNo}

    </delete>

    <!--
    Suppression de la taxe !== 세금 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedTax" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Suppression de la taxe !== 세금 삭제 ==!
        void deleteDedTax(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_TAX
        WHERE dtl_dcsh_no = #{dtlDcshNo}

    </delete>

    <!--
    CLRI_Suppression de l'article d'estimation de la valeur de la déclaration en détail !== CLRI_상세신고서가격평가품목 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedVlutPdls" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'article d'estimation de la valeur de la déclaration en détail !== CLRI_상세신고서가격평가품목 삭제 ==!
        void deleteDedVlutPdls(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_VLUT_PDLS
        WHERE dtl_dcsh_no = #{dtlDcshNo}

    </delete>

    <!--
    CLRI_Suppression de l'article de la déclaration en détail !== CLRI_상세신고서품목 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedPdls" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'article de la déclaration en détail !== CLRI_상세신고서품목 삭제 ==!
        void deleteDedPdls(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_PDLS
        WHERE dtl_dcsh_no = #{dtlDcshNo}

    </delete>

    <!-- CLRI_상세신고서품목 이전 버전으로 되돌리기 -->
    <update id="updateDedPdlsbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer l'article de la déclaration en détail à la version précédente
         * CLRI_상세신고서품목 이전 버전으로 되돌리기
         void updateDedPdlsbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_PDLS (
            DTL_DCSH_NO
        , PDLS_NO
        , UPR_PDLS_NO
        , HS_CD
        , CMDT_CLSF_SPEL_CD
        , PDLS_NM
        , DLNG_PDLS_NM
        , NWPR_SCAR_CMDT_CD
        , PCKG_SHMR_MARK_NO
        , PCKG_DESC
        , ORCY_CNTY_CD
        , APC_CD
        , PRVL_CD
        , QTA_APRE_NO
        , MG_DSCN_APRE_NO
        , PRC_DTRM_MEAN_CD
        , BRND_NM
        , BF_DTL_DCSH_NO
        , BF_DTL_DCSH_DT
        , BF_PDLS_NO
        , DIVD_FFMN_TP_CD
        , QTY
        , QTY_UT_CD
        , TRIF_BASE_VAL
        , PDLS_TTWG
        , PDLS_NTWG
        , PDLS_PCKG_GCNT
        , PDLS_PCKG_UT_CD
        , OIL_TANK_NO
        , VHCL_YN
        , PDLS_PSMGT_TRGT_YN
        , PDLS_PSMGT_FFMN_CMPL_YN
        , PDLS_PSMGT_FFMN_CMPL_DT
        , PDLS_PSMGT_CONC_RSN_CD
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM
        , HS_ERR_PVNT_VAL
        , REGM_RQST_CD
        , prhb_cmdt_cd
        , hs_excp_mtr_cd
        , apc_excp_mtr_cd
        , apc_dtl_cd
        , prvl_excp_mtr_cd
        , regm_pn
        , adit_tx_qty
        , adit_tx_qty_ut_cd
        , PDLS_CLSF_BFHN_JDGN_PN
        ,apc_atpm_strt_dt
        ,apc_atpm_end_dt
        ,psmgt_ffmn_xpir_prid
        )
        SELECT DTL_DCSH_NO
             , PDLS_NO
             , UPR_PDLS_NO
             , HS_CD
             , CMDT_CLSF_SPEL_CD
             , PDLS_NM
             , DLNG_PDLS_NM
             , NWPR_SCAR_CMDT_CD
             , PCKG_SHMR_MARK_NO
             , PCKG_DESC
             , ORCY_CNTY_CD
             , APC_CD
             , PRVL_CD
             , QTA_APRE_NO
             , MG_DSCN_APRE_NO
             , PRC_DTRM_MEAN_CD
             , BRND_NM
             , BF_DTL_DCSH_NO
             , BF_DTL_DCSH_DT
             , BF_PDLS_NO
             , DIVD_FFMN_TP_CD
             , QTY
             , QTY_UT_CD
             , TRIF_BASE_VAL
             , PDLS_TTWG
             , PDLS_NTWG
             , PDLS_PCKG_GCNT
             , PDLS_PCKG_UT_CD
             , OIL_TANK_NO
             , VHCL_YN
             , PDLS_PSMGT_TRGT_YN
             , PDLS_PSMGT_FFMN_CMPL_YN
             , PDLS_PSMGT_FFMN_CMPL_DT
             , PDLS_PSMGT_CONC_RSN_CD
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
             , HS_ERR_PVNT_VAL
             , REGM_RQST_CD
             , prhb_cmdt_cd
             , hs_excp_mtr_cd
             , apc_excp_mtr_cd
             , apc_dtl_cd
             , prvl_excp_mtr_cd
             , regm_pn
             , adit_tx_qty
             , adit_tx_qty_ut_cd
             , PDLS_CLSF_BFHN_JDGN_PN
             ,apc_atpm_strt_dt
             ,apc_atpm_end_dt
             , psmgt_ffmn_xpir_prid
        FROM TB_CLRI_DED_PDLS_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , PDLS_NO )
            DO UPDATE SET DTL_DCSH_NO             = excluded.DTL_DCSH_NO
                        , PDLS_NO                 = excluded.PDLS_NO
                        , UPR_PDLS_NO             = excluded.UPR_PDLS_NO
                        , HS_CD                   = excluded.HS_CD
                        , CMDT_CLSF_SPEL_CD       = excluded.CMDT_CLSF_SPEL_CD
                        , PDLS_NM                 = excluded.PDLS_NM
                        , DLNG_PDLS_NM            = excluded.DLNG_PDLS_NM
                        , NWPR_SCAR_CMDT_CD       = excluded.NWPR_SCAR_CMDT_CD
                        , PCKG_SHMR_MARK_NO       = excluded.PCKG_SHMR_MARK_NO
                        , PCKG_DESC               = excluded.PCKG_DESC
                        , ORCY_CNTY_CD            = excluded.ORCY_CNTY_CD
                        , APC_CD                  = excluded.APC_CD
                        , PRVL_CD                 = excluded.PRVL_CD
                        , QTA_APRE_NO             = excluded.QTA_APRE_NO
                        , MG_DSCN_APRE_NO         = excluded.MG_DSCN_APRE_NO
                        , PRC_DTRM_MEAN_CD        = excluded.PRC_DTRM_MEAN_CD
                        , BRND_NM                 = excluded.BRND_NM
                        , BF_DTL_DCSH_NO          = excluded.BF_DTL_DCSH_NO
                        , BF_DTL_DCSH_DT          = excluded.BF_DTL_DCSH_DT
                        , BF_PDLS_NO              = excluded.BF_PDLS_NO
                        , DIVD_FFMN_TP_CD         = excluded.DIVD_FFMN_TP_CD
                        , QTY                     = excluded.QTY
                        , QTY_UT_CD               = excluded.QTY_UT_CD
                        , TRIF_BASE_VAL           = excluded.TRIF_BASE_VAL
                        , PDLS_TTWG               = excluded.PDLS_TTWG
                        , PDLS_NTWG               = excluded.PDLS_NTWG
                        , PDLS_PCKG_GCNT          = excluded.PDLS_PCKG_GCNT
                        , PDLS_PCKG_UT_CD         = excluded.PDLS_PCKG_UT_CD
                        , OIL_TANK_NO             = excluded.OIL_TANK_NO
                        , VHCL_YN                 = excluded.VHCL_YN
                        , PDLS_PSMGT_TRGT_YN      = excluded.PDLS_PSMGT_TRGT_YN
                        , PDLS_PSMGT_FFMN_CMPL_YN = excluded.PDLS_PSMGT_FFMN_CMPL_YN
                        , PDLS_PSMGT_FFMN_CMPL_DT = excluded.PDLS_PSMGT_FFMN_CMPL_DT
                        , PDLS_PSMGT_CONC_RSN_CD  = excluded.PDLS_PSMGT_CONC_RSN_CD
                        , DEL_YN                  = excluded.DEL_YN
                        , FRST_REGST_ID           = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM          = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID            = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM           = excluded.LAST_CHG_DTTM
                        , HS_ERR_PVNT_VAL         = excluded.HS_ERR_PVNT_VAL
                        , REGM_RQST_CD            = excluded.REGM_RQST_CD
                        , prhb_cmdt_cd            = excluded.prhb_cmdt_cd
                        , hs_excp_mtr_cd          = excluded.hs_excp_mtr_cd
                        , apc_excp_mtr_cd         = excluded.apc_excp_mtr_cd
                        , adit_tx_qty             = excluded.adit_tx_qty
                        , adit_tx_qty_ut_cd       = excluded.adit_tx_qty_ut_cd
                        , PDLS_CLSF_BFHN_JDGN_PN  = excluded.PDLS_CLSF_BFHN_JDGN_PN
                        , apc_atpm_strt_dt        = excluded.apc_atpm_strt_dt
                        , apc_atpm_end_dt         = excluded.apc_atpm_end_dt
                        , psmgt_ffmn_xpir_prid    = excluded.psmgt_ffmn_xpir_prid
    </update>

    <!-- CLRI_상세신고서가격평가품목 이전 버전으로 되돌리기 -->
    <update id="updateDedVlutPdlsbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer l'article de l'estimation de la valeur de la déclaration en détail à la version précédente
         * CLRI_상세신고서가격평가품목 이전 버전으로 되돌리기
         void updateDedVlutPdlsbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_VLUT_PDLS (
            DTL_DCSH_NO
        , PDLS_NO
        , PDLS_INVC_AMT
        , PDLS_INVC_FXRT
        , PDLS_INVC_NCY_AMT
        , PDLS_INVC_USD_AMT
        , PDLS_CACH_AMT
        , PDLS_CACH_CURR_CD
        , PDLS_CACH_FXRT
        , PDLS_CACH_NCY_AMT
        , PDLS_INFEE_AMT
        , PDLS_INFEE_CURR_CD
        , PDLS_INFEE_FXRT
        , PDLS_INFEE_NCY_AMT
        , PDLS_OTCST_AMT
        , PDLS_OTCST_CURR_CD
        , PDLS_OTCST_FXRT
        , PDLS_OTCST_NCY_AMT
        , PDLS_DDCT_AMT
        , PDLS_DDCT_CURR_CD
        , PDLS_DDCT_FXRT
        , PDLS_DDCT_NCY_AMT
        , PDLS_TXBS_NCY_AMT
        , PDLS_TXBS_USD_AMT
        , PDLS_VLUT_NCY_AMT
        , PDLS_VLUT_USD_AMT
        , PDLS_MPRC_BASE_VAL
        , PDLS_MPRC_UT_AMT
        , PDLS_MPRC_NCY_AMT
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM
        , PDLS_INVC_CURR_CD
        , PDLS_MPRC_TP_CD
        , PDLS_MPRC_CURR_CD
        , PDLS_MPRC_USD_AMT)
        SELECT DTL_DCSH_NO
             , PDLS_NO
             , PDLS_INVC_AMT
             , PDLS_INVC_FXRT
             , PDLS_INVC_NCY_AMT
             , PDLS_INVC_USD_AMT
             , PDLS_CACH_AMT
             , PDLS_CACH_CURR_CD
             , PDLS_CACH_FXRT
             , PDLS_CACH_NCY_AMT
             , PDLS_INFEE_AMT
             , PDLS_INFEE_CURR_CD
             , PDLS_INFEE_FXRT
             , PDLS_INFEE_NCY_AMT
             , PDLS_OTCST_AMT
             , PDLS_OTCST_CURR_CD
             , PDLS_OTCST_FXRT
             , PDLS_OTCST_NCY_AMT
             , PDLS_DDCT_AMT
             , PDLS_DDCT_CURR_CD
             , PDLS_DDCT_FXRT
             , PDLS_DDCT_NCY_AMT
             , PDLS_TXBS_NCY_AMT
             , PDLS_TXBS_USD_AMT
             , PDLS_VLUT_NCY_AMT
             , PDLS_VLUT_USD_AMT
             , PDLS_MPRC_BASE_VAL
             , PDLS_MPRC_UT_AMT
             , PDLS_MPRC_NCY_AMT
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
             , PDLS_INVC_CURR_CD
             , PDLS_MPRC_TP_CD
             , PDLS_MPRC_CURR_CD
             , PDLS_MPRC_USD_AMT
        FROM TB_CLRI_DED_VLUT_PDLS_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , PDLS_NO )
            DO UPDATE SET DTL_DCSH_NO        = excluded.DTL_DCSH_NO
                        , PDLS_NO            = excluded.PDLS_NO
                        , PDLS_INVC_AMT      = excluded.PDLS_INVC_AMT
                        , PDLS_INVC_FXRT     = excluded.PDLS_INVC_FXRT
                        , PDLS_INVC_NCY_AMT  = excluded.PDLS_INVC_NCY_AMT
                        , PDLS_INVC_USD_AMT  = excluded.PDLS_INVC_USD_AMT
                        , PDLS_CACH_AMT      = excluded.PDLS_CACH_AMT
                        , PDLS_CACH_CURR_CD  = excluded.PDLS_CACH_CURR_CD
                        , PDLS_CACH_FXRT     = excluded.PDLS_CACH_FXRT
                        , PDLS_CACH_NCY_AMT  = excluded.PDLS_CACH_NCY_AMT
                        , PDLS_INFEE_AMT     = excluded.PDLS_INFEE_AMT
                        , PDLS_INFEE_CURR_CD = excluded.PDLS_INFEE_CURR_CD
                        , PDLS_INFEE_FXRT    = excluded.PDLS_INFEE_FXRT
                        , PDLS_INFEE_NCY_AMT = excluded.PDLS_INFEE_NCY_AMT
                        , PDLS_OTCST_AMT     = excluded.PDLS_OTCST_AMT
                        , PDLS_OTCST_CURR_CD = excluded.PDLS_OTCST_CURR_CD
                        , PDLS_OTCST_FXRT    = excluded.PDLS_OTCST_FXRT
                        , PDLS_OTCST_NCY_AMT = excluded.PDLS_OTCST_NCY_AMT
                        , PDLS_DDCT_AMT      = excluded.PDLS_DDCT_AMT
                        , PDLS_DDCT_CURR_CD  = excluded.PDLS_DDCT_CURR_CD
                        , PDLS_DDCT_FXRT     = excluded.PDLS_DDCT_FXRT
                        , PDLS_DDCT_NCY_AMT  = excluded.PDLS_DDCT_NCY_AMT
                        , PDLS_TXBS_NCY_AMT  = excluded.PDLS_TXBS_NCY_AMT
                        , PDLS_TXBS_USD_AMT  = excluded.PDLS_TXBS_USD_AMT
                        , PDLS_VLUT_NCY_AMT  = excluded.PDLS_VLUT_NCY_AMT
                        , PDLS_VLUT_USD_AMT  = excluded.PDLS_VLUT_USD_AMT
                        , PDLS_MPRC_BASE_VAL = excluded.PDLS_MPRC_BASE_VAL
                        , PDLS_MPRC_UT_AMT   = excluded.PDLS_MPRC_UT_AMT
                        , PDLS_MPRC_NCY_AMT  = excluded.PDLS_MPRC_NCY_AMT
                        , DEL_YN             = excluded.DEL_YN
                        , FRST_REGST_ID      = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM     = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID       = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM      = excluded.LAST_CHG_DTTM
                        , PDLS_INVC_CURR_CD  = excluded.PDLS_INVC_CURR_CD
                        , PDLS_MPRC_TP_CD    = excluded.PDLS_MPRC_TP_CD
                        , PDLS_MPRC_CURR_CD  = excluded.PDLS_MPRC_CURR_CD
                        , PDLS_MPRC_USD_AMT  = excluded.PDLS_MPRC_USD_AMT
    </update>


    <!-- CLRI_상세신고서차량 이전 버전으로 되돌리기 -->
    <update id="updateDedVhclbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer les véhicules de la déclaration en détail à la version précédente
         * CLRI_상세신고서차량 이전 버전으로 되돌리기
         void updateDedVhclbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_VHCL (
            PDLS_NO
        , MDL_STSZ_NO
        , DTL_DCSH_NO
        , CHSS_NO
        , IMP_PT_NM
        , VHCL_MNUR_CD
        , CLR_NM
        , VHCL_MDL_CD
        , DRVR_NM
        , TRSF_NNPR_YN
        , DRVR_POST_NO
        , DRVR_ADDR
        , CAR_RGSR_NO
        , VHCL_RELE_DT
        , MKNG_YY
        , VHCL_WGHT_CN
        , LOAD_WGHT_CN
        , OTPT_CN
        , DPCMT_CN
        , FL_KND_NM
        , VHCL_KND_NM
        , CABO_NM
        , FRST_OPRA_DT
        , STCNT
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM
        , TRSF_NNPR_STRT_DT
        , TRSF_NNPR_END_DT
        , VHCL_KND_CD
        , TRSF_UNBL_TP_CD
        , IMP_CRPP_NO
        , IMP_CRPP_DT
        , IMP_CRPP_PRID
        , VHCL_CSCL_MGMT_NO)
        SELECT PDLS_NO
             , MDL_STSZ_NO
             , DTL_DCSH_NO
             , CHSS_NO
             , IMP_PT_NM
             , VHCL_MNUR_CD
             , CLR_NM
             , VHCL_MDL_CD
             , DRVR_NM
             , TRSF_NNPR_YN
             , DRVR_POST_NO
             , DRVR_ADDR
             , CAR_RGSR_NO
             , VHCL_RELE_DT
             , MKNG_YY
             , VHCL_WGHT_CN
             , LOAD_WGHT_CN
             , OTPT_CN
             , DPCMT_CN
             , FL_KND_NM
             , VHCL_KND_NM
             , CABO_NM
             , FRST_OPRA_DT
             , STCNT
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
             , TRSF_NNPR_STRT_DT
             , TRSF_NNPR_END_DT
             , VHCL_KND_CD
             , TRSF_UNBL_TP_CD
             , IMP_CRPP_NO
             , IMP_CRPP_DT
             , IMP_CRPP_PRID
             , VHCL_CSCL_MGMT_NO
        FROM TB_CLRI_DED_VHCL_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( PDLS_NO , MDL_STSZ_NO, DTL_DCSH_NO )
            DO UPDATE SET PDLS_NO           = excluded.PDLS_NO
                        , MDL_STSZ_NO       = excluded.MDL_STSZ_NO
                        , DTL_DCSH_NO       = excluded.DTL_DCSH_NO
                        , CHSS_NO           = excluded.CHSS_NO
                        , IMP_PT_NM         = excluded.IMP_PT_NM
                        , VHCL_MNUR_CD      = excluded.VHCL_MNUR_CD
                        , CLR_NM            = excluded.CLR_NM
                        , VHCL_MDL_CD       = excluded.VHCL_MDL_CD
                        , DRVR_NM           = excluded.DRVR_NM
                        , TRSF_NNPR_YN      = excluded.TRSF_NNPR_YN
                        , DRVR_POST_NO      = excluded.DRVR_POST_NO
                        , DRVR_ADDR         = excluded.DRVR_ADDR
                        , CAR_RGSR_NO       = excluded.CAR_RGSR_NO
                        , VHCL_RELE_DT      = excluded.VHCL_RELE_DT
                        , MKNG_YY           = excluded.MKNG_YY
                        , VHCL_WGHT_CN      = excluded.VHCL_WGHT_CN
                        , LOAD_WGHT_CN      = excluded.LOAD_WGHT_CN
                        , OTPT_CN           = excluded.OTPT_CN
                        , DPCMT_CN          = excluded.DPCMT_CN
                        , FL_KND_NM         = excluded.FL_KND_NM
                        , VHCL_KND_NM       = excluded.VHCL_KND_NM
                        , CABO_NM           = excluded.CABO_NM
                        , FRST_OPRA_DT      = excluded.FRST_OPRA_DT
                        , STCNT             = excluded.STCNT
                        , DEL_YN            = excluded.DEL_YN
                        , FRST_REGST_ID     = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM    = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID      = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM     = excluded.LAST_CHG_DTTM
                        , TRSF_NNPR_STRT_DT = excluded.TRSF_NNPR_STRT_DT
                        , TRSF_NNPR_END_DT  = excluded.TRSF_NNPR_END_DT
                        , VHCL_KND_CD       = excluded.VHCL_KND_CD

    </update>

    <!-- 세금 이전 버전으로 되돌리기 -->
    <update id="updateDedTaxbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer les taxes à la version précédente
         * 세금 이전 버전으로 되돌리기
         void updateDedTaxbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_TAX (
            DTL_DCSH_NO
        , PDLS_NO
        , TAX_CD
        , TXBS_AMT
        , TFRT_CTGY_CD
        , TXRT
        , TAX_AMT
        , PAY_TAX_AMT
        , PAY_KND_CD
        , RDEX_PT_CD
        , RDEX_CD
        , RDEX_AMT
        , RDEX_BASE_AMT
        , RDEX_TXRT
        , MG_DSCN_APLY_AMT
        , BSCS_TXBS_AMT
        , BSCS_TXRT
        , BSCS_TAX_AMT
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM)
        SELECT DTL_DCSH_NO
             , PDLS_NO
             , TAX_CD
             , TXBS_AMT
             , TFRT_CTGY_CD
             , TXRT
             , TAX_AMT
             , PAY_TAX_AMT
             , PAY_KND_CD
             , RDEX_PT_CD
             , RDEX_CD
             , RDEX_AMT
             , RDEX_BASE_AMT
             , RDEX_TXRT
             , MG_DSCN_APLY_AMT
             , BSCS_TXBS_AMT
             , BSCS_TXRT
             , BSCS_TAX_AMT
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
        FROM TB_CLRI_DED_TAX_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , PDLS_NO , TAX_CD )
            DO UPDATE SET DTL_DCSH_NO      = excluded.DTL_DCSH_NO
                        , PDLS_NO          = excluded.PDLS_NO
                        , TAX_CD           = excluded.TAX_CD
                        , TXBS_AMT         = excluded.TXBS_AMT
                        , TFRT_CTGY_CD     = excluded.TFRT_CTGY_CD
                        , TXRT             = excluded.TXRT
                        , TAX_AMT          = excluded.TAX_AMT
                        , PAY_TAX_AMT      = excluded.PAY_TAX_AMT
                        , PAY_KND_CD       = excluded.PAY_KND_CD
                        , RDEX_PT_CD       = excluded.RDEX_PT_CD
                        , RDEX_CD          = excluded.RDEX_CD
                        , RDEX_AMT         = excluded.RDEX_AMT
                        , RDEX_BASE_AMT    = excluded.RDEX_BASE_AMT
                        , RDEX_TXRT        = excluded.RDEX_TXRT
                        , MG_DSCN_APLY_AMT = excluded.MG_DSCN_APLY_AMT
                        , BSCS_TXBS_AMT    = excluded.BSCS_TXBS_AMT
                        , BSCS_TXRT        = excluded.BSCS_TXRT
                        , BSCS_TAX_AMT     = excluded.BSCS_TAX_AMT
                        , DEL_YN           = excluded.DEL_YN
                        , FRST_REGST_ID    = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM   = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID     = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM    = excluded.LAST_CHG_DTTM

    </update>

    <!-- CLRI_상세신고서모델규격 이전 버전으로 되돌리기 -->
    <update id="updateDedMdlStszbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer les produits modèles de la déclaration en détail à la version précédente
         * CLRI_상세신고서모델규격 이전 버전으로 되돌리기
         void updateDedMdlStszbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_MDL_STSZ (
            DTL_DCSH_NO
        , PDLS_NO
        , MDL_STSZ_NO
        , MDL_STSZ_NM
        , INGR_NM
        , QTY
        , QTY_UT_CD
        , UT_PRC
        , INVC_AMT
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM
        , INDR_PYMN_TAMT)
        SELECT DTL_DCSH_NO
             , PDLS_NO
             , MDL_STSZ_NO
             , MDL_STSZ_NM
             , INGR_NM
             , QTY
             , QTY_UT_CD
             , UT_PRC
             , INVC_AMT
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
             , INDR_PYMN_TAMT
        FROM TB_CLRI_DED_MDL_STSZ_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , PDLS_NO , MDL_STSZ_NO )
            DO UPDATE SET DTL_DCSH_NO    = excluded.DTL_DCSH_NO
                        , PDLS_NO        = excluded.PDLS_NO
                        , MDL_STSZ_NO    = excluded.MDL_STSZ_NO
                        , MDL_STSZ_NM    = excluded.MDL_STSZ_NM
                        , INGR_NM        = excluded.INGR_NM
                        , QTY            = excluded.QTY
                        , QTY_UT_CD      = excluded.QTY_UT_CD
                        , UT_PRC         = excluded.UT_PRC
                        , INVC_AMT       = excluded.INVC_AMT
                        , DEL_YN         = excluded.DEL_YN
                        , FRST_REGST_ID  = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID   = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM  = excluded.LAST_CHG_DTTM
                        , INDR_PYMN_TAMT = excluded.INDR_PYMN_TAMT

    </update>

    <!-- 원재료 원복 (이력->공통) 이전 버전으로 되돌리기 -->
    <update id="updateDedRwmsbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer les matières premières (historique->commun) à la version précédente
         * 원재료 원복 (이력->공통) 이전 버전으로 되돌리기
         void updateDedRwmsbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_RWMS (
            DTL_DCSH_NO
        , PDLS_NO
        , RWMS_SRNO
        , BF_DTL_DCSH_NO
        , BF_PDLS_NO
        , BF_HS_CD
        , BF_CMDT_CLSF_SPEL_CD
        , DIVD_FFMN_TP_CD
        , QTY
        , QTY_UT_CD
        , NTWG
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM)
        SELECT DTL_DCSH_NO
             , PDLS_NO
             , RWMS_SRNO
             , BF_DTL_DCSH_NO
             , BF_PDLS_NO
             , BF_HS_CD
             , BF_CMDT_CLSF_SPEL_CD
             , DIVD_FFMN_TP_CD
             , QTY
             , QTY_UT_CD
             , NTWG
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
        FROM TB_CLRI_DED_RWMS_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , PDLS_NO , RWMS_SRNO )
            DO UPDATE SET DTL_DCSH_NO          = excluded.DTL_DCSH_NO
                        , PDLS_NO              = excluded.PDLS_NO
                        , RWMS_SRNO            = excluded.RWMS_SRNO
                        , BF_DTL_DCSH_NO       = excluded.BF_DTL_DCSH_NO
                        , BF_PDLS_NO           = excluded.BF_PDLS_NO
                        , BF_HS_CD             = excluded.BF_HS_CD
                        , BF_CMDT_CLSF_SPEL_CD = excluded.BF_CMDT_CLSF_SPEL_CD
                        , DIVD_FFMN_TP_CD      = excluded.DIVD_FFMN_TP_CD
                        , QTY                  = excluded.QTY
                        , QTY_UT_CD            = excluded.QTY_UT_CD
                        , NTWG                 = excluded.NTWG
                        , DEL_YN               = excluded.DEL_YN
                        , FRST_REGST_ID        = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM       = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID         = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM        = excluded.LAST_CHG_DTTM
    </update>

    <!-- CLRI_상세신고서재수입재수출예정품목 이전 버전으로 되돌리기 -->
    <update id="updateDedRimexPrngPdlsbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer les articles prévus de la réimport/réexport de la déclaration en détail à la version précédente
         * CLRI_상세신고서재수입재수출예정품목 이전 버전으로 되돌리기
         void updateDedRimexPrngPdlsbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_RIMEX_PRNG_PDLS (
            DTL_DCSH_NO
        , PRNG_PDLS_NO
        , CMDT_CLSF_SPEL_CD
        , PDLS_NM
        , DLNG_PDLS_NM
        , ORCY_CNTY_CD
        , QTY
        , QTY_UT_CD
        , PDLS_TTWG
        , PDLS_NTWG
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM
        , HS_CD)
        SELECT DTL_DCSH_NO
             , PRNG_PDLS_NO
             , CMDT_CLSF_SPEL_CD
             , PDLS_NM
             , DLNG_PDLS_NM
             , ORCY_CNTY_CD
             , QTY
             , QTY_UT_CD
             , PDLS_TTWG
             , PDLS_NTWG
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
             , HS_CD
        FROM TB_CLRI_DED_RIMEX_PRNG_PDLS_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , PRNG_PDLS_NO )
            DO UPDATE SET DTL_DCSH_NO       = excluded.DTL_DCSH_NO
                        , PRNG_PDLS_NO      = excluded.PRNG_PDLS_NO
                        , CMDT_CLSF_SPEL_CD = excluded.CMDT_CLSF_SPEL_CD
                        , PDLS_NM           = excluded.PDLS_NM
                        , DLNG_PDLS_NM      = excluded.DLNG_PDLS_NM
                        , ORCY_CNTY_CD      = excluded.ORCY_CNTY_CD
                        , QTY               = excluded.QTY
                        , QTY_UT_CD         = excluded.QTY_UT_CD
                        , PDLS_TTWG         = excluded.PDLS_TTWG
                        , PDLS_NTWG         = excluded.PDLS_NTWG
                        , DEL_YN            = excluded.DEL_YN
                        , FRST_REGST_ID     = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM    = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID      = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM     = excluded.LAST_CHG_DTTM
                        , HS_CD             = excluded.HS_CD

    </update>

    <!-- CLRI_상세신고서컨테이너 이전 버전으로 되돌리기 -->
    <update id="updateDedCntrbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer les conteneurs de la déclaration en détail à la version précédente
         * CLRI_상세신고서컨테이너 이전 버전으로 되돌리기
         void updateDedCntrbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_CNTR (
            DTL_DCSH_NO
        , CNTR_SRNO
        , CNTR_NO
        , CNTR_TP_CD
        , CNTR_STFN_STTS_CD
        , SEAL_NO1
        , SEAL_NO2
        , SEAL_NO3
        , SEAL_CHPN1
        , SEAL_CHPN2
        , SEAL_CHPN3
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM)
        SELECT DTL_DCSH_NO
             , CNTR_SRNO
             , CNTR_NO
             , CNTR_TP_CD
             , CNTR_STFN_STTS_CD
             , SEAL_NO1
             , SEAL_NO2
             , SEAL_NO3
             , SEAL_CHPN1
             , SEAL_CHPN2
             , SEAL_CHPN3
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
        FROM TB_CLRI_DED_CNTR_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , CNTR_SRNO )
            DO UPDATE SET DTL_DCSH_NO       = excluded.DTL_DCSH_NO
                        , CNTR_SRNO         = excluded.CNTR_SRNO
                        , CNTR_NO           = excluded.CNTR_NO
                        , CNTR_TP_CD        = excluded.CNTR_TP_CD
                        , CNTR_STFN_STTS_CD = excluded.CNTR_STFN_STTS_CD
                        , SEAL_NO1          = excluded.SEAL_NO1
                        , SEAL_NO2          = excluded.SEAL_NO2
                        , SEAL_NO3          = excluded.SEAL_NO3
                        , SEAL_CHPN1        = excluded.SEAL_CHPN1
                        , SEAL_CHPN2        = excluded.SEAL_CHPN2
                        , SEAL_CHPN3        = excluded.SEAL_CHPN3
                        , DEL_YN            = excluded.DEL_YN
                        , FRST_REGST_ID     = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM    = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID      = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM     = excluded.LAST_CHG_DTTM

    </update>

    <!-- CLRI_상세신고서담보 이전 버전으로 되돌리기 -->
    <update id="updateDedMgbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer la caution de la déclaration en détail à la version précédente
         * CLRI_상세신고서담보 이전 버전으로 되돌리기
         void updateDedMgbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_MG (
            DTL_DCSH_NO
        , MG_AC_NO
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM
        , MG_TP_CD)
        SELECT DTL_DCSH_NO
             , MG_AC_NO
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
             , MG_TP_CD
        FROM TB_CLRI_DED_MG_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO )
            DO UPDATE SET MG_AC_NO       = excluded.MG_AC_NO
                        , DEL_YN         = excluded.DEL_YN
                        , FRST_REGST_ID  = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID   = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM  = excluded.LAST_CHG_DTTM
                        , MG_TP_CD       = excluded.MG_TP_CD

    </update>

    <!-- CLRI_상세신고서첨부문서 이전 버전으로 되돌리기 -->
    <update id="updateDedAtdocbfVer" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Restaurer les docs joints de la déclaration en détail à la version précédente
         * CLRI_상세신고서첨부문서 이전 버전으로 되돌리기
         void updateDedAtdocbfVer(ClrDedSrchVo searchVo);
        */
        INSERT INTO TB_CLRI_DED_ATDOC (
            DTL_DCSH_NO
        , ATCH_DOC_SRNO
        , DOC_KND_CD
        , PDLS_NO
        , DOC_NO
        , DOC_DESC
        , ATCH_FILE_NM
        , PBLS_ITT_NM
        , PBLS_DT
        , ATCH_FILE_ID
        , DEL_YN
        , FRST_REGST_ID
        , FRST_RGSR_DTTM
        , LAST_CHPR_ID
        , LAST_CHG_DTTM)
        SELECT DTL_DCSH_NO
             , ATCH_DOC_SRNO
             , DOC_KND_CD
             , PDLS_NO
             , DOC_NO
             , NVL(DOC_DESC, '')
             , ATCH_FILE_NM
             , PBLS_ITT_NM
             , PBLS_DT
             , ATCH_FILE_ID
             , 'N'
             , FRST_REGST_ID
             , FRST_RGSR_DTTM
             , #{userId}
             , SYSTIMESTAMP
        FROM TB_CLRI_DED_ATDOC_H
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
        ON CONFLICT ( DTL_DCSH_NO , ATCH_DOC_SRNO )
            DO UPDATE SET DTL_DCSH_NO    = excluded.DTL_DCSH_NO
                        , ATCH_DOC_SRNO  = excluded.ATCH_DOC_SRNO
                        , DOC_KND_CD     = excluded.DOC_KND_CD
                        , PDLS_NO        = excluded.PDLS_NO
                        , DOC_NO         = excluded.DOC_NO
                        , DOC_DESC       = excluded.DOC_DESC
                        , ATCH_FILE_NM   = excluded.ATCH_FILE_NM
                        , PBLS_ITT_NM    = excluded.PBLS_ITT_NM
                        , PBLS_DT        = excluded.PBLS_DT
                        , ATCH_FILE_ID   = excluded.ATCH_FILE_ID
                        , DEL_YN         = excluded.DEL_YN
                        , FRST_REGST_ID  = excluded.FRST_REGST_ID
                        , FRST_RGSR_DTTM = excluded.FRST_RGSR_DTTM
                        , LAST_CHPR_ID   = excluded.LAST_CHPR_ID
                        , LAST_CHG_DTTM  = excluded.LAST_CHG_DTTM

    </update>

    <!--
    Suppression de la logique de modèle/spécification du contrôle pour l'estimation de la valeur !== 가격평가심사모델규격 논리 삭제 ==!
    (Kim Kiryong)
    -->
    <update id="deleteDedVlutAudtMdlStsz" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* ClrDedVlutAudtMdlStsz_deleteClrDedVlutAudtMdlStsz */
        UPDATE TB_CLRI_DED_VLUT_AUDT_MDL_STSZ
        SET del_yn        = 'Y' /** Suppression ON !== 삭제여부 ==! */
          , last_chpr_id  = #{lastChprId} /** ID du modificateur final !== 최종변경자ID ==! */
          , last_chg_dttm = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE del_yn = 'N' /** Suppression ON !== 삭제여부 ==! */
          AND dtl_dcsh_no = #{dtlDcshNo} /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
          AND PRC_EV_DGCNT IN (SELECT PRC_EV_DGCNT
                               FROM TB_CLRI_DED_VLUT_AUDT_COMN
                               WHERE dtl_dcsh_no = #{dtlDcshNo}
                                 AND HIST_SRNO = #{histSrno}
                                 AND DEL_YN = 'N')
    </update>

    <!--
    CLRI_Suppression des recours du contrôle pour l'estimation de la valeur !== CLRI_가격평가심사이의제기 삭제 ==!
    (Kim Kiryong)
    -->
    <update id="deleteVlutAudtMkoj" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* ClrVlutAudtMkoj_deleteClrVlutAudtMkoj */
        UPDATE TB_CLRI_VLUT_AUDT_MKOJ
        SET del_yn        = 'Y' /** Suppression ON !== 삭제여부 ==! */
          , last_chpr_id  = #{lastChprId} /** ID du modificateur final !== 최종변경자ID ==! */
          , last_chg_dttm = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE del_yn = 'N' /** Suppression ON !== 삭제여부 ==! */
          AND dtl_dcsh_no = #{dtlDcshNo} /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
          AND PRC_EV_DGCNT IN (SELECT PRC_EV_DGCNT
                               FROM TB_CLRI_DED_VLUT_AUDT_COMN
                               WHERE dtl_dcsh_no = #{dtlDcshNo}
                                 AND HIST_SRNO = #{histSrno}
                                 AND DEL_YN = 'N')
    </update>

    <!--
    Suppression de la logique de taxe pour l'estimation de la valeur !== 가격평가심사세금 논리 삭제 ==!
    (Kim Kiryong)
    -->
    <update id="deleteDedVlutAudtTax" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* ClrDedVlutAudtTax_deleteClrDedVlutAudtTax */
        UPDATE TB_CLRI_DED_VLUT_AUDT_TAX
        SET del_yn        = 'Y' /** Suppression ON !== 삭제여부 ==! */
          , last_chpr_id  = #{lastChprId} /** ID du modificateur final !== 최종변경자ID ==! */
          , last_chg_dttm = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE del_yn = 'N' /** Suppression ON !== 삭제여부 ==! */
          AND dtl_dcsh_no = #{dtlDcshNo} /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
          AND PRC_EV_DGCNT IN (SELECT PRC_EV_DGCNT
                               FROM TB_CLRI_DED_VLUT_AUDT_COMN
                               WHERE dtl_dcsh_no = #{dtlDcshNo}
                                 AND HIST_SRNO = #{histSrno}
                                 AND DEL_YN = 'N')
    </update>

    <!--
    CLRI_Estimation de la valeur_Suppression du conteneur !== CLRI_가격평가_컨테이너 삭제 ==!
    (Kim Kiryong)
    -->
    <update id="deleteVlutCntr" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* ClrVlutCntr_deleteClrVlutCntr */
        UPDATE TB_CLRI_VLUT_CNTR
        SET del_yn        = 'Y' /** Suppression ON !== 삭제여부 ==! */
          , last_chpr_id  = #{lastChprId} /** ID du modificateur final !== 최종변경자ID ==! */
          , last_chg_dttm = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE del_yn = 'N' /** Suppression ON !== 삭제여부 ==! */
          AND dtl_dcsh_no = #{dtlDcshNo} /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
          AND PRC_EV_DGCNT IN (SELECT PRC_EV_DGCNT
                               FROM TB_CLRI_DED_VLUT_AUDT_COMN
                               WHERE dtl_dcsh_no = #{dtlDcshNo}
                                 AND HIST_SRNO = #{histSrno}
                                 AND DEL_YN = 'N')
    </update>

    <!--
    Suppression de la logique d'article du contrôle pour l'estimation de la valeur !== 가격평가심사품목 논리 삭제 ==!
    (Kim Kiryong)
    -->
    <update id="deleteDedVlutAudtPdls" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* ClrDedVlutAudtPdls_deleteClrDedVlutAudtPdls */
        UPDATE TB_CLRI_DED_VLUT_AUDT_PDLS
        SET del_yn        = 'Y' /** Suppression ON !== 삭제여부 ==! */
          , last_chpr_id  = #{lastChprId} /** ID du modificateur final !== 최종변경자ID ==! */
          , last_chg_dttm = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE del_yn = 'N' /** Suppression ON !== 삭제여부 ==! */
          AND dtl_dcsh_no = #{dtlDcshNo} /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
          AND PRC_EV_DGCNT IN (SELECT PRC_EV_DGCNT
                               FROM TB_CLRI_DED_VLUT_AUDT_COMN
                               WHERE dtl_dcsh_no = #{dtlDcshNo}
                                 AND HIST_SRNO = #{histSrno}
                                 AND DEL_YN = 'N')
    </update>

    <!--
    Suppression Inserts newlines to specified file !== Inserts newlines to specified file 삭제 ==!
    (Kim Kiryong)
    -->
    <update id="deleteDedVlutAudtComn" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* ClrDedVlutAudtComn_deleteClrDedVlutAudtComn */
        UPDATE TB_CLRI_DED_VLUT_AUDT_COMN
        SET del_yn        = 'Y' /** Suppression ON !== 삭제여부 ==! */
          , last_chpr_id  = #{lastChprId} /** ID du modificateur final !== 최종변경자ID ==! */
          , last_chg_dttm = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE del_yn = 'N' /** Suppression ON !== 삭제여부 ==! */
          AND dtl_dcsh_no = #{dtlDcshNo} /** Numero de la déclaration en détail!! !== 상세신고서번호 ==! */
          AND HIST_SRNO = #{histSrno}
    </update>

    <!--
	Consulter le nombre de fois de l'estimation de la valeur précédente
	!== 이전 가격평가차수 조회 ==!
	-->
    <select id="selectBfPrcEvDgcnt" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo"
            resultType="java.math.BigDecimal">
        /* selectBfPrcEvDgcnt */
        SELECT MAX(PRC_EV_DGCNT)
        FROM TB_CLRI_DED_VLUT_AUDT_COMN
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND HIST_SRNO = #{histSrno} - 1
          AND DEL_YN = 'N'
    </select>

    <!--
	Modifier le contrôle de l'estimation de la valeur de DED final o/n
	!== DED 가격평가심사공통 최종여부 수정 ==!
	-->
    <update id="updateDedVlutAudtComnLastYn" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedVlutAudtComnVo">
        /* updateDedVlutAudtComnLastYn */
        UPDATE TB_CLRI_DED_VLUT_AUDT_COMN
        SET LAST_YN       = #{lastYn}
          , LAST_CHPR_ID  = #{lastChprId} /** ID du modificateur final !== 최종변경자ID ==! */
          , LAST_CHG_DTTM = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND PRC_EV_DGCNT = #{prcEvDgcnt}
          AND DEL_YN = 'N'

    </update>

    <!--
    CLRI_Suppression de l'historique de modèle/spécification de la déclaration en détail !== CLRI_상세신고서모델규격이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedMdlStszH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique de modèle/spécification de la déclaration en détail !== CLRI_상세신고서모델규격이력 삭제 ==!
        void deleteDedMdlStszH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_MDL_STSZ_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1
    </delete>

    <!--
    Suppression de l'historique de taxe !== 세금 이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedTaxH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Suppression de l'historique de taxe !== 세금 이력 삭제 ==!
        void deleteDedTaxH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_TAX_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1
    </delete>

    <!--
    CLRI_Suppression de l'historique de l'article d'estimation de la valeur de la déclaration en détail !== CLRI_상세신고서가격평가품목이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedVlutPdlsH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique de l'article d'estimation de la valeur de la déclaration en détail !== CLRI_상세신고서가격평가품목이력 삭제 ==!
        void deleteDedVlutPdlsH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_VLUT_PDLS_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de l'historique générale de l'estimation de la valeur de la déclaration en détail !== CLRI_상세신고서가격평가공통이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedVlutComnH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique générale de l'estimation de la valeur de la déclaration en détail !== CLRI_상세신고서가격평가공통이력 삭제 ==!
        void deleteDedVlutComnH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_VLUT_COMN_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    Suppression de l'historique de véhicule !== 차량 이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedVhclH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Suppression de l'historique de véhicule !== 차량 이력 삭제 ==!
        void deleteDedVhclH(ClrDedVhclHVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_VHCL_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    Suppression de l'historique de matière première !== 원재료 이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedRwmsH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* Suppression de l'historique de matière première !== 원재료 이력 삭제 ==!
        void deleteDedRwmsH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_RWMS_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de la déclaration des éléments de la valeur de la déclaration en détail !== CLRI_상세신고서가격신고품 삭제 ==!
    ()
    -->
    <delete id="deleteDedPrcDclrPdls" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de la déclaration des éléments de la valeur de la déclaration en détail !== CLRI_상세신고서가격신고품 삭제 ==!
        void deleteDedPrcDclrPdls(ClrDedPrcDclrPdlsVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_PRC_DCLR_PDLS_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de l'historique d'article de la déclaration en détail !== CLRI_상세신고서품목이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedPdlsH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique d'article de la déclaration en détail !== CLRI_상세신고서품목이력 삭제 ==!
        void deleteDedPdlsH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_PDLS_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de l'historique d'opérateur de la déclaration en détail !== CLRI_상세신고서업체이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedCoH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique d'opérateur de la déclaration en détail !== CLRI_상세신고서업체이력 삭제 ==!
        void deleteDedCoH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_CO_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de l'historique de conteneur de la déclaration en détail !== CLRI_상세신고서컨테이너이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedCntrH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique de conteneur de la déclaration en détail !== CLRI_상세신고서컨테이너이력 삭제 ==!
        void deleteDedCntrH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_CNTR_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de l'historique de caution de la déclaration en détail !== CLRI_상세신고서담보이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedMgH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique de caution de la déclaration en détail !== CLRI_상세신고서담보이력 삭제 ==!
        void deleteDedMgH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_MG_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1
    </delete>

    <!--
    CLRI_Suppression de l'historique de déclaration de la valeur de la déclaration en détail !== CLRI_상세신고서가격신고이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedPrcDclrH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique de déclaration de la valeur de la déclaration en détail !== CLRI_상세신고서가격신고이력 삭제 ==!
        void deleteDedPrcDclrH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_PRC_DCLR_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de l'historique d'article à réimporter/réexporter de la déclaration en détail !== CLRI_상세신고서재수입재수출예정품목이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedRimexPrngPdlsH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique d'article à réimporter/réexporter de la déclaration en détail !== CLRI_상세신고서재수입재수출예정품목이력 삭제 ==!
        void deleteDedRimexPrngPdlsH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_RIMEX_PRNG_PDLS_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1
    </delete>

    <!--
    CLRI_Suppression de l'historique de document joint de la déclaration en détail !== CLRI_상세신고서첨부문서이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedAtdocH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique de document joint de la déclaration en détail !== CLRI_상세신고서첨부문서이력 삭제 ==!
        void deleteDedAtdocH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_ATDOC_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
    CLRI_Suppression de l'historique générale de la déclaration en détail !== CLRI_상세신고서공통이력 삭제 ==!
    (Kim Kiryong)
    -->
    <delete id="deleteDedComnH" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* CLRI_Suppression de l'historique générale de la déclaration en détail !== CLRI_상세신고서공통이력 삭제 ==!
        void deleteDedComnH(ClrDedSrchVo deleteVo);
          */
        DELETE
        FROM TB_CLRI_DED_COMN_H
        WHERE dtl_dcsh_no = #{dtlDcshNo}
          AND hist_srno = #{histSrno} - 1

    </delete>

    <!--
	Modification LAST_YN N, DEL_YN Y communs de la DED externe
	!== 외부 DED신고서 공통 LAST_YN N, DEL_YN Y 수정 ==!
	-->
    <update id="updateOutbndDedComnLastDelYn" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* updateOutbndDedComnLastDelYn */
        UPDATE ALPASSEXT.TB_CLRE_DED_COMN
        SET LAST_YN       = 'N'
          , DEL_YN        = 'Y'
          , LAST_CHPR_ID  = #{userId} /** ID du modificateur final !== 최종변경자ID ==! */
          , LAST_CHG_DTTM = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE REFF_NO = #{reffNo}
          AND MDFY_DGCNT = #{mdfyDgcnt}
          AND DEL_YN = 'N'

    </update>

    <!--
   Modification de LAST_YN degré précédent commun de la déclaration DED externe
   !== 외부 DED신고서 공통 이전차수 LAST_YN 수정 ==!
   -->
    <update id="updateOutbndDedComnBfDgcntLastYn" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        /* updateOutbndDedComnBfDgcntLastYn */
        UPDATE ALPASSEXT.TB_CLRE_DED_COMN
        SET LAST_YN       = 'Y'
          , LAST_CHPR_ID  = #{userId} /** ID du modificateur final !== 최종변경자ID ==! */
          , LAST_CHG_DTTM = SYSTIMESTAMP /** Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE REFF_NO = #{reffNo}
          AND MDFY_DGCNT = (SELECT MDFY_DGCNT
                            FROM (SELECT MDFY_DGCNT
                                  FROM ALPASSEXT.TB_CLRE_DED_COMN
                                  WHERE REFF_NO = #{reffNo}
                                    AND DEL_YN = 'N'
                                    AND MDFY_DGCNT <![CDATA[ <> ]]> #{mdfyDgcnt}
                                  ORDER BY MDFY_DGCNT DESC)
                            WHERE ROWNUM = 1)

    </update>

    <update id="updateDedComnAtrDclrRcpn" parameterType="alpass.ipt.clr.pdr.dre.vo.ClrDedSrchVo">
        UPDATE TB_CLRI_DED_COMN
        SET    ATR_DCLR_RCPN_YN = 'N'
        WHERE DTL_DCSH_NO = #{dtlDcshNo}
    </update>
</mapper>
