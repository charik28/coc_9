<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="alpass.ipt.psc.blgg.lst.mapper.PscDpstLstMapper">

  <!--
  @TODO:번역필요 !== 휴대품 예치 목록 조회 ==!
  -->
  <select id="selectPscDpstDcshList"  parameterType="alpass.ipt.psc.blgg.lst.vo.PscDpstSearchVo"
    resultType="alpass.ipt.psc.blgg.lst.vo.PscDpstSearchVo">
      /* selectPscDpstDcshList */
      <include refid="pagination.header" ></include>
			SELECT
			A.DPST_TEMP_NO               /** Numéro provisoire de mise en dépôt !== 예치임시번호 ==! */
			, A.CSTM_CD                    /** Code Du Bureau !== 세관코드 ==! */
			, FN_GET_ORGN_NM(A.CSTM_CD) AS CSTM_CD_NM               /**  !== 세관명 ==! */
			, A.BLGG_MGMT_NO               /** N° De La Gestion Des Bagages Accompagnés !== 휴대품관리번호 ==! */
			, A.DPST_MGMT_NO               /** Numéro De Série De Transit/Correspondance !== 예치관리번호 ==! */
			, A.BLGG_RQST_STTS_CD          /** Code de statut de demande des effets personnels !== 휴대품신청상태코드 ==! */
			, A.BLGG_TP_CD                 /** Code de type des effets personnels !== 휴대품구분코드 ==! */
			, A.PSPR_NO                    /** N° De Passeport !== 여권번호 ==! */
			, A.NAT_CD                     /** Code De Nationalité !== 국적코드 ==! */
			, FN_GET_CNTY_NM(A.NAT_CD, #{langCd}) AS NAT_CD_NM /**  !== 국가명 ==! */
			, A.STGE_PRID_DT               /** Date d'échéance !== 장치기간일자 ==! */
			, TO_CHAR(TO_DATE(A.RGSR_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS RGSR_DT /** Date D'Enregistrement !== 등록일자 ==! */
			, A.DPST_SFKP_EVDC_NO          /** Numéro de bulletin de dépôt !== 예치보관증서번호 ==! */
			, A.REGST_ID                   /** Id De La Personne Enregistrant !== 등록자ID ==! */
			, A.RLSE_RQST_DT               /** Date de demande de sortie !== 반출신청일자 ==! */
			, A.STGE_PRID_XTNS_REQST_DT       /** Date d'échéance sollicitée !== 장치기간연장요청일자 ==! */
			, B.RLSE_DT
			, B.RLSE_APRE_EMP_ID
			FROM   ALPASSINT.TB_PSCI_PSNR_BLGG_DPST A, ALPASSINT.TB_PSCI_PSNR_BRNG_RLSE B
			WHERE  A.DEL_YN = 'N'                                /** Suppression ON !== 삭제여부 ==! */
			AND A.DPST_TEMP_NO = B.DPST_TEMP_NO(+)
			<if test='dpstTempNo != null and dpstTempNo != ""'>
			AND  A.DPST_TEMP_NO = #{dpstTempNo}              /** Numéro provisoire de mise en dépôt !== 예치임시번호 ==! */
			</if>
			<if test='psprNo != null and psprNo != ""'>
				AND A.PSPR_NO = #{psprNo}
			</if>
			<if test='natCd != null and natCd != ""'>
				AND A.NAT_CD = #{natCd}
			</if>
			<if test='blggRqstSttsCd != null and blggRqstSttsCd != ""'>
				AND A.BLGG_RQST_STTS_CD = #{blggRqstSttsCd}
			</if>
			<if test='blggTpCd != null and blggTpCd != ""'>
				AND A.BLGG_TP_CD = #{blggTpCd}
			</if>
			<if test='(dclrDtFrom != null and !"".equals(dclrDtFrom)) and (dclrDtTo != null and !"".equals(dclrDtTo))'>
				AND A.RGSR_DT BETWEEN TO_CHAR(TO_DATE(REPLACE(#{dclrDtFrom}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD') AND TO_CHAR(TO_DATE(REPLACE(#{dclrDtTo}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD')
			</if>
			ORDER BY A.FRST_RGSR_DTTM DESC
      <include refid="pagination.footer" ></include>
  </select>

  
</mapper>