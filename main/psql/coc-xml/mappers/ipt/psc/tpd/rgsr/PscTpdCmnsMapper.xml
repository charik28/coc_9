<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="alpass.ipt.psc.tpd.rgsr.mapper.PscTpdCmnsMapper">

  <!--
  @TODO:번역필요 !== TPD부품 목록 조회 ==!
  -->
  <select id="selectPscTpdCmnsList"  
    parameterType="alpass.ipt.psc.tpd.rgsr.vo.PscTpdCmnsVo" 
    resultType="alpass.ipt.psc.tpd.rgsr.vo.PscTpdCmnsVo"> 
      /* selectPscTpdCmnsList */
          SELECT
                A.TPD_TEMP_NO                /** Numéro provisoire de TPD !== TPD임시번호 ==! */
              , A.PDLS_SRNO                  /** N° de séquence de l'article !== 품목일련번호 ==! */
              , A.CMNS_SRNO                  /** N° de série du composant !== 부품일련번호 ==! */
              , A.CMNS_NM                    /** Nom du composant !== 부품명 ==! */
              , A.CMNS_GCNT                  /** Nombre de composants !== 부품개수 ==! */
              , A.CMNS_NO                    /** Numéro du composant !== 부품번호 ==! */
              , A.CMNS_BRND_NM               /** Marque du composant !== 부품브랜드명 ==! */
              , A.CMNS_SPFT_CN               /** Caractéristiques du composant !== 부품특징내용 ==! */
              , A.CMNS_CAPC_LIR              /** Capacité du composant(litre) !== 부품용량리터 ==! */
              , A.DEL_YN                     /** Suppression On !== 삭제여부 ==! */
              , A.FRST_REGST_ID              /** Id Du Premier Enregistrant  !== 최초등록자ID ==! */
              , A.FRST_RGSR_DTTM             /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
              , A.LAST_CHPR_ID               /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , A.LAST_CHG_DTTM              /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
          FROM   TB_PSCI_TPD_CMNS A
         WHERE  A.DEL_YN = 'N'                                /** Suppression ON !== 삭제여부 ==! */
           AND  A.TPD_TEMP_NO = #{tpdTempNo}                /** Numéro provisoire de TPD !== TPD임시번호 ==! */
           <if test="pdlsSrno != null and pdlsSrno != ''">           
           AND  A.PDLS_SRNO = #{pdlsSrno}                   /** N° de séquence de l'article !== 품목일련번호 ==! */
           </if>
           <if test="cmnsSrno != null and cmnsSrno != ''">   
           AND  A.CMNS_SRNO = #{cmnsSrno}                   /** N° de série du composant !== 부품일련번호 ==! */
           </if>
  </select>


  <!--
  @TODO:번역필요 !== TPD부품 등록 ==!
  (deKim)
  -->
  <insert id="insertPscTpdCmns" parameterType="alpass.ipt.psc.tpd.rgsr.vo.PscTpdCmnsVo">
      /* insertPscTpdCmns */
      <selectKey keyProperty="cmnsSrno" order="BEFORE" resultType="java.math.BigDecimal">
        SELECT NVL(MAX(CMNS_SRNO),0)+1 FROM TB_PSCI_TPD_CMNS WHERE TPD_TEMP_NO = #{tpdTempNo} AND PDLS_SRNO = #{pdlsSrno}
      </selectKey>
    
        INSERT INTO TB_PSCI_TPD_CMNS
              (
                TPD_TEMP_NO                  /** Numéro provisoire de TPD !== TPD임시번호 ==! */
              , PDLS_SRNO                    /** N° de séquence de l'article !== 품목일련번호 ==! */
              , CMNS_SRNO                    /** N° de série du composant !== 부품일련번호 ==! */
              , CMNS_NM                      /** Nom du composant !== 부품명 ==! */
              , CMNS_GCNT                    /** Nombre de composants !== 부품개수 ==! */
              , CMNS_NO                      /** Numéro du composant !== 부품번호 ==! */
              , CMNS_BRND_NM                 /** Marque du composant !== 부품브랜드명 ==! */
              , CMNS_SPFT_CN                 /** Caractéristiques du composant !== 부품특징내용 ==! */
              , CMNS_CAPC_LIR                /** Capacité du composant(litre) !== 부품용량리터 ==! */
              , DEL_YN                       /** Suppression On !== 삭제여부 ==! */
              , FRST_REGST_ID                /** Id Du Premier Enregistrant  !== 최초등록자ID ==! */
              , FRST_RGSR_DTTM               /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
              , LAST_CHPR_ID                 /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , LAST_CHG_DTTM                /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
              )
              VALUES
              (
                #{tpdTempNo}                 /** Numéro provisoire de TPD !== TPD임시번호 ==! */
              , #{pdlsSrno}                  /** N° de séquence de l'article !== 품목일련번호 ==! */
              , #{cmnsSrno}                  /** N° de série du composant !== 부품일련번호 ==! */
              , #{cmnsNm}                    /** Nom du composant !== 부품명 ==! */
              , #{cmnsGcnt}                  /** Nombre de composants !== 부품개수 ==! */
              , #{cmnsNo}                    /** Numéro du composant !== 부품번호 ==! */
              , #{cmnsBrndNm}                /** Marque du composant !== 부품브랜드명 ==! */
              , #{cmnsSpftCn}                /** Caractéristiques du composant !== 부품특징내용 ==! */
              , #{cmnsCapcLir}               /** Capacité du composant(litre) !== 부품용량리터 ==! */
              , 'N'                          /** Suppression On !== 삭제여부 ==! */
              , #{frstRegstId}               /** Id Du Premier Enregistrant  !== 최초등록자ID ==! */
              , SYSTIMESTAMP                 /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
              , #{lastChprId}                /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , SYSTIMESTAMP                 /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
              )
  </insert>


  <!--
  @TODO:번역필요 !== TPD부품 수정 ==!
  (deKim)
  -->
  <update id="updatePscTpdCmns" parameterType="alpass.ipt.psc.tpd.rgsr.vo.PscTpdCmnsVo">
      /* updatePscTpdCmns */
      UPDATE  TB_PSCI_TPD_CMNS SET 
              LAST_CHPR_ID = #{lastChprId}                /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , LAST_CHG_DTTM = SYSTIMESTAMP                /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
              <if test="cmnsNm != null and cmnsNm != ''">
                CMNS_NM = #{cmnsNm}                         /** Nom du composant !== 부품명 ==! */
              </if>
              <if test="cmnsGcnt != null and cmnsGcnt != ''">
              , CMNS_GCNT = #{cmnsGcnt}                     /** Nombre de composants !== 부품개수 ==! */
              </if>
              <if test="cmnsNo != null and cmnsNo != ''">
              , CMNS_NO = #{cmnsNo}                         /** Numéro du composant !== 부품번호 ==! */
              </if>
              <if test="cmnsBrndNm != null and cmnsBrndNm != ''">
              , CMNS_BRND_NM = #{cmnsBrndNm}                /** Marque du composant !== 부품브랜드명 ==! */
              </if>
              <if test="cmnsSpftCn != null and cmnsSpftCn != ''">
              , CMNS_SPFT_CN = #{cmnsSpftCn}                /** Caractéristiques du composant !== 부품특징내용 ==! */
              </if>
              <if test="cmnsCapcLir != null and cmnsCapcLir != ''">
              , CMNS_CAPC_LIR = #{cmnsCapcLir}              /** Capacité du composant(litre) !== 부품용량리터 ==! */
              </if>
         WHERE  DEL_YN = 'N'                                /** Suppression ON !== 삭제여부 ==! */
           AND  TPD_TEMP_NO = #{tpdTempNo}                  /** Numéro provisoire de TPD !== TPD임시번호 ==! */
           AND  PDLS_SRNO = #{pdlsSrno}                     /** N° de séquence de l'article !== 품목일련번호 ==! */
           AND  CMNS_SRNO = #{cmnsSrno}                     /** N° de série du composant !== 부품일련번호 ==! */
  </update>


  <!--
  @TODO:번역필요 !== TPD부품 삭제 ==!
  (deKim)
  -->
  <update id="deletePscTpdCmns" parameterType="alpass.ipt.psc.tpd.rgsr.vo.PscTpdCmnsVo">
      /* deletePscTpdCmns */
      DELETE  TB_PSCI_TPD_CMNS 
    WHERE  1=1
    AND  TPD_TEMP_NO = #{tpdTempNo}                    /** Numéro provisoire de TPD !== TPD임시번호 ==! */
  </update>



</mapper>