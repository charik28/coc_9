<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
Mapper : !==  무관세통관허가증 관리 Mapper. ==!
(deKim)
-->
<mapper namespace="alpass.ipt.psc.cufr.mgmt.mapper.PscCufrBscsMapper">

 <!--
  @TODO:번역필요 !== 무관세통관허가증 목록 조회 ==!
  -->
  <select id="selectPscCufrBscsList"  
    parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo" 
    resultType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo"> 
      /* selectPscCufrBscsList */
      <include refid="pagination.header" ></include>
          SELECT
                A.CUFR_CSCL_WRPM_ID          /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
              , A.CSTM_CD                    /** Code Du Bureau !== 세관코드 ==! */
              , A.RQST_REGM_CD               /** Code de régime de demande !== 신청레짐코드 ==! */
              , A.BFCY_FMNM                  /** @TODO : 번역필요 !== 수혜자성 ==! */
              , A.BFCY_GVNM_NM               /** Prénom du bénéficiaire !== 수혜자이름명 ==! */
              , A.BFCY_BRDY                  /** Date de naissance du bénéficiaire !== 수혜자생년월일 ==! */
              , A.BFCY_BIRT_REGN_NM          /** Lieu de naissance du bénéficiaire !== 수혜자출생지역명 ==! */
              , A.BFCY_PSPR_NO               /** Numéro de passeport du bénéficiaire !== 수혜자여권번호 ==! */
              , A.BFCY_DZA_ADDR              /** Adresse du bénéficiaire en Algérie !== 수혜자알제리주소 ==! */
              , A.BFCY_OVRS_ADDR             /** Adresse du bénéficiaire à l'étranger !== 수혜자해외주소 ==! */
              , A.BFCY_PSPR_NO_ISS_DT        /** Date de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급일자 ==! */
              , A.BFCY_PSPR_NO_ISS_ITT       /** Lieu de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급기관 ==! */
              , A.CUFR_CSCL_WRPM_PRID        /** Durée accordée de l'acquit à caution !== 무관세통관허가증기간 ==! */
              , TO_CHAR(TO_DATE(A.CUFR_CSCL_WRPM_PRID, 'YYYYMMDD'), 'DD/MM/YYYY') AS CUFR_CSCL_WRPM_PRID_DT
              , A.CUFR_CSCL_WRPM_PRID        /** Durée accordée de l'acquit à caution !== 무관세통관허가증기간 ==! */
              , A.CUFR_CSCL_WRPM_TP_CD       /** Code de cadre de l'acquit à caution !== 무관세통관허가증구분코드 ==! */
              , A.CUFR_CSCL_WRPM_DTRM_NO       /** @TODO : 번역필요 !== 무관세통관허가증결정번호 ==! */
              , A.CUFR_CSCL_WRPM_DTRM_DT       /** Date de décision de l'acquit à caution !== 무관세통관허가증결정일자 ==! */
              , A.RCNT_LIPL_NO               /** Dernière immatriculation !== 최근번호판번호 ==! */
              , A.SPEL_ADMN_PCDR_CN          /** @TODO : 번역필요 !== 특별행정절차내용 ==! */
              , A.PERM_DOC_NM                /** Libellé de l'autorisation !== 허가문서명 ==! */
              , A.PERM_DOC_ID                /** Identifiant de l'autorisation !== 허가문서ID ==! */
              , A.PERM_DOC_ISS_DT            /** Date de délivrance de l'autorisation !== 허가문서발급일자 ==! */
              , A.PERM_DOC_ISS_ITT_NM        /** Autorité de délivrance de l'autorisation !== 허가문서발급기관명 ==! */
              , A.REFF_NO                    /** N° De Référence !== 참조번호 ==! */
              , DECODE(A.REFF_NO,'','N',NULL,'N','Y') AS VHCL_YN
              , A.ATCH_FILE_ID               /** Id Du Fichier Joint !== 첨부파일ID ==! */
              , A.CUFR_OTPT_CD               /** Code d'impression de l'acquit à caution !== 무관세출력코드 ==! */
              , A.CUFR_BFCY_CD               /** Code de bénéficiaire de l'acquit à caution !== 무관세수혜자코드 ==! */
              , A.BFCY_NAT_CD                /** Code de nationalité de bénéficiaire  !== 수혜자국적코드 ==! */
              , A.END_CSTM_CD                /** Lieu de Bureau d'apurement  !== 종료세관코드 ==! */
              , FN_GET_ORGN_NM(A.END_CSTM_CD) AS END_CSTM_CD_NM               
              , TO_CHAR(A.BSOP_END_DTTM,'DD/MM/YYYY HH24:MI')              /** Date et heure de fin de service  !== 업무종료일시 ==! */
              , A.TPD_END_TP_CD               /** Code de type d'apurement de TPD  !== TPD종료구분코드 ==! */
              , A.RGSR_EMP_ID                 /** Identifiant De La Personne Chargée De L'Enregistrement  !== 등록직원ID ==! */
              , A.RMRK_CN                     /** Contenu De Remarque  !== 비고내용 ==! */
              , A.CUFR_RQST_STTS_CD           /** Code de statut de la demande de l'acquit à caution  !== 무관세신청상태코드 ==! */
              , A.DEL_YN                     /** Suppression On !== 삭제여부 ==! */
              ,( SELECT EMP_NM
                FROM TB_POTI_EMP
                 WHERE  PBSR_NO = A.FRST_REGST_ID
               ) AS FRST_REGST_ID  
              , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY') AS FRST_RGSR_DTTM
              , A.LAST_CHPR_ID               /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , A.LAST_CHG_DTTM              /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
          FROM   TB_PSCI_CUFR_CSCL_BSCS A
         WHERE  A.DEL_YN = 'N'                                /** Suppression ON !== 삭제여부 ==! */
         <if test='cstmCd != null and cstmCd != "" '>
         AND A.CSTM_CD = #{cstmCd}                 
         </if>
         <if test="sctrCd != null and sctrCd != ''">
         AND A.CSTM_CD LIKE SUBSTRING(#{sctrCd},1,3) || '%'
         </if>         
         <if test="cufrCsclWrpmId != null and cufrCsclWrpmId != ''">
         AND  A.CUFR_CSCL_WRPM_ID = REPLACE(#{cufrCsclWrpmId}, '-', '')       /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
         </if>
         <if test="dclrNo != null and dclrNo != ''">
         AND  A.DCLR_NO = REPLACE(#{dclrNo}, '-', '')     
         </if>
         <if test="bfcyPsprNo != null and bfcyPsprNo != ''">
         AND  A.BFCY_PSPR_NO = #{bfcyPsprNo}
         </if>
         <if test="bfcyNatCd != null and bfcyNatCd != ''">
         AND  A.BFCY_NAT_CD = #{bfcyNatCd}
         </if>
         <if test="cufrCsclWrpmTpCd != null and cufrCsclWrpmTpCd != ''">
         AND  A.CUFR_CSCL_WRPM_TP_CD = #{cufrCsclWrpmTpCd}
         </if>
         <if test='"Y".equals(xpirYn)'>
         AND  A.CUFR_CSCL_WRPM_PRID <![CDATA[ < ]]> TO_CHAR(sysdate,'YYYYMMDD')
         </if>
         <if test='"N".equals(xpirYn)'>
         AND  A.CUFR_CSCL_WRPM_PRID <![CDATA[ >= ]]> TO_CHAR(sysdate,'YYYYMMDD')
         </if>
         <if test='(dclrDtFrom != null and !"".equals(dclrDtFrom)) and (dclrDtTo != null and !"".equals(dclrDtTo))'>
         AND TO_CHAR(A.FRST_RGSR_DTTM, 'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(REPLACE(#{dclrDtFrom}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD') AND TO_CHAR(TO_DATE(REPLACE(#{dclrDtTo}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD')
         </if>
         ORDER BY A.FRST_RGSR_DTTM DESC
      <include refid="pagination.footer" ></include>
  </select>

  <select id="selectPscCufrBscs"  
    parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo" 
    resultType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo"> 
      /* selectPscCufrBscs */
      
          SELECT 
                A.CUFR_CSCL_WRPM_ID          /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
              , ( SELECT ORG.ORGN_NM  FROM ALPASSINT.TB_POTI_ORGN ORG WHERE ORG.ORGN_MGMT_CD = 
                (SELECT FN_GET_UPR_ORGN_CD(ORGN_MGMT_CD,'DIR') FROM ALPASSINT.TB_POTI_ORGN WHERE ORGN_CD = A.CSTM_CD ) 
                ) AS DRD_CD                    /** Code de direction régionale des douanes !== 지역본부세관코드 ==! */              
              , A.CSTM_CD                    /** Code Du Bureau !== 세관코드 ==! */
              , FN_GET_ORGN_NM(A.CSTM_CD) AS CSTM_CD_NM               /**  !== 세관명 ==! */
              , ( SELECT ORG.ORGN_NM  FROM ALPASSINT.TB_POTI_ORGN ORG WHERE ORG.ORGN_MGMT_CD =
                (SELECT EMP.ORGN_MGMT_CD  FROM ALPASSINT.TB_POTI_EMP EMP WHERE EMP.PBSR_NO = A.FRST_REGST_ID)
                ) AS DEPT_NM
              , A.RQST_REGM_CD               /** Code de régime de demande !== 신청레짐코드 ==! */
              , A.BFCY_FMNM                  /** @TODO : 번역필요 !== 수혜자성 ==! */
              , A.BFCY_GVNM_NM               /** Prénom du bénéficiaire !== 수혜자이름명 ==! */
              , A.BFCY_BRDY                  /** Date de naissance du bénéficiaire !== 수혜자생년월일 ==! */
              , A.BFCY_BIRT_REGN_NM          /** Lieu de naissance du bénéficiaire !== 수혜자출생지역명 ==! */
              , A.BFCY_PSPR_NO               /** Numéro de passeport du bénéficiaire !== 수혜자여권번호 ==! */
              , A.BFCY_DZA_ADDR              /** Adresse du bénéficiaire en Algérie !== 수혜자알제리주소 ==! */
              , A.BFCY_OVRS_ADDR             /** Adresse du bénéficiaire à l'étranger !== 수혜자해외주소 ==! */
              , A.BFCY_PSPR_NO_ISS_DT        /** Date de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급일자 ==! */
              , A.BFCY_PSPR_NO_ISS_ITT       /** Lieu de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급기관 ==! */
              , A.CUFR_CSCL_WRPM_PRID        /** Durée accordée de l'acquit à caution !== 무관세통관허가증기간 ==! */
              , A.CUFR_CSCL_WRPM_TP_CD       /** Code de cadre de l'acquit à caution !== 무관세통관허가증구분코드 ==! */
              , A.CUFR_CSCL_WRPM_DTRM_NO       /** @TODO : 번역필요 !== 무관세통관허가증결정번호 ==! */
              , A.CUFR_CSCL_WRPM_DTRM_DT       /** Date de décision de l'acquit à caution !== 무관세통관허가증결정일자 ==! */
              , A.RCNT_LIPL_NO               /** Dernière immatriculation !== 최근번호판번호 ==! */
              , A.SPEL_ADMN_PCDR_CN          /** @TODO : 번역필요 !== 특별행정절차내용 ==! */
              , A.PERM_DOC_NM                /** Libellé de l'autorisation !== 허가문서명 ==! */
              , A.PERM_DOC_ID                /** Identifiant de l'autorisation !== 허가문서ID ==! */
              , A.PERM_DOC_ISS_DT            /** Date de délivrance de l'autorisation !== 허가문서발급일자 ==! */
              , A.PERM_DOC_ISS_ITT_NM        /** Autorité de délivrance de l'autorisation !== 허가문서발급기관명 ==! */
              , A.REFF_NO                    /** N° De Référence !== 참조번호 ==! */
              , DECODE(A.REFF_NO,'','N',NULL,'N','Y') AS VHCL_YN
              , A.ATCH_FILE_ID               /** Id Du Fichier Joint !== 첨부파일ID ==! */
              , A.CUFR_OTPT_CD               /** Code d'impression de l'acquit à caution !== 무관세출력코드 ==! */
              , A.CUFR_BFCY_CD               /** Code de bénéficiaire de l'acquit à caution !== 무관세수혜자코드 ==! */
              , A.BFCY_NAT_CD                /** Code de nationalité de bénéficiaire  !== 수혜자국적코드 ==! */
              , A.END_CSTM_CD                /** Lieu de Bureau d'apurement  !== 종료세관코드 ==! */
              , FN_GET_ORGN_NM(A.END_CSTM_CD) AS END_CSTM_CD_NM               
              , TO_CHAR(A.BSOP_END_DTTM,'DD/MM/YYYY HH24:MI')              /** Date et heure de fin de service  !== 업무종료일시 ==! */
              , A.TPD_END_TP_CD               /** Code de type d'apurement de TPD  !== TPD종료구분코드 ==! */
              , A.RGSR_EMP_ID                 /** Identifiant De La Personne Chargée De L'Enregistrement  !== 등록직원ID ==! */
              , A.RMRK_CN                     /** Contenu De Remarque  !== 비고내용 ==! */
              , A.CUFR_RQST_STTS_CD           /** Code de statut de la demande de l'acquit à caution  !== 무관세신청상태코드 ==! */
              , TO_CHAR(A.FRST_RGSR_DTTM,'DD/MM/YYYY') AS RGSR_DT
              , A.DCLR_NO                     /**   N° De La Déclaration  !==  신고서번호 ==! */
              , A.DEL_YN                     /** Suppression On !== 삭제여부 ==! */
              , A.FRST_RGSR_DTTM
              , A.LAST_CHPR_ID               /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , A.LAST_CHG_DTTM              /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
          FROM   TB_PSCI_CUFR_CSCL_BSCS A
         WHERE  A.DEL_YN = 'N'                                /** Suppression ON !== 삭제여부 ==! */
         AND  A.CUFR_CSCL_WRPM_ID = #{cufrCsclWrpmId}       /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */

  </select>
  
  <!--
  @TODO:번역필요 !== 무관세통관허가증 등록 ==!
  (deKim)
  -->
  <insert id="insertPscCufrBscs" parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo">
      /* insertPscCufrBscs */
        INSERT INTO TB_PSCI_CUFR_CSCL_BSCS
              (
                CUFR_CSCL_WRPM_ID            /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
              , CSTM_CD                      /** Code Du Bureau !== 세관코드 ==! */
              , RQST_REGM_CD                 /** Code de régime de demande !== 신청레짐코드 ==! */
              , BFCY_FMNM                    /** @TODO : 번역필요 !== 수혜자성 ==! */
              , BFCY_GVNM_NM                 /** Prénom du bénéficiaire !== 수혜자이름명 ==! */
              , BFCY_BRDY                    /** Date de naissance du bénéficiaire !== 수혜자생년월일 ==! */
              , BFCY_BIRT_REGN_NM            /** Lieu de naissance du bénéficiaire !== 수혜자출생지역명 ==! */
              , BFCY_PSPR_NO                 /** Numéro de passeport du bénéficiaire !== 수혜자여권번호 ==! */
              , BFCY_DZA_ADDR                /** Adresse du bénéficiaire en Algérie !== 수혜자알제리주소 ==! */
              , BFCY_OVRS_ADDR               /** Adresse du bénéficiaire à l'étranger !== 수혜자해외주소 ==! */
              , BFCY_PSPR_NO_ISS_DT          /** Date de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급일자 ==! */
              , BFCY_PSPR_NO_ISS_ITT         /** Lieu de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급기관 ==! */              
              , CUFR_CSCL_WRPM_PRID          /** Durée accordée de l'acquit à caution !== 무관세통관허가증기간 ==! */
              , CUFR_CSCL_WRPM_TP_CD         /** Code de cadre de l'acquit à caution !== 무관세통관허가증구분코드 ==! */
              , CUFR_CSCL_WRPM_DTRM_NO       /** @TODO : 번역필요 !== 무관세통관허가증결정번호 ==! */
              , CUFR_CSCL_WRPM_DTRM_DT       /** Date de décision de l'acquit à caution !== 무관세통관허가증결정일자 ==! */
              , RCNT_LIPL_NO                 /** Dernière immatriculation !== 최근번호판번호 ==! */
              , SPEL_ADMN_PCDR_CN            /** @TODO : 번역필요 !== 특별행정절차내용 ==! */
              , PERM_DOC_NM                  /** Libellé de l'autorisation !== 허가문서명 ==! */
              , PERM_DOC_ID                  /** Identifiant de l'autorisation !== 허가문서ID ==! */
              , PERM_DOC_ISS_DT              /** Date de délivrance de l'autorisation !== 허가문서발급일자 ==! */
              , PERM_DOC_ISS_ITT_NM          /** Autorité de délivrance de l'autorisation !== 허가문서발급기관명 ==! */
              , REFF_NO                      /** N° De Référence !== 참조번호 ==! */
              , ATCH_FILE_ID                 /** Id Du Fichier Joint !== 첨부파일ID ==! */
              , CUFR_OTPT_CD               /** Code d'impression de l'acquit à caution !== 무관세출력코드 ==! */
              , CUFR_BFCY_CD               /** Code de bénéficiaire de l'acquit à caution !== 무관세수혜자코드 ==! */
              , BFCY_NAT_CD                /** Code de nationalité de bénéficiaire  !== 수혜자국적코드 ==! */
              , CUFR_RQST_STTS_CD           /** Code de statut de la demande de l'acquit à caution  !== 무관세신청상태코드 ==! */
              , DCLR_NO                     /**   N° De La Déclaration  !==  신고서번호 ==! */
              , DEL_YN                       /** Suppression On !== 삭제여부 ==! */
              , FRST_REGST_ID                /** Id Du Premier Enregistrant  !== 최초등록자ID ==! */
              , FRST_RGSR_DTTM               /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
              , LAST_CHPR_ID                 /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , LAST_CHG_DTTM                /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
              )
              VALUES
              (
                #{cufrCsclWrpmId}            /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
              , #{cstmCd}                    /** Code Du Bureau !== 세관코드 ==! */
              , #{rqstRegmCd}                /** Code de régime de demande !== 신청레짐코드 ==! */
              , #{bfcyFmnm}                  /** @TODO : 번역필요 !== 수혜자성 ==! */
              , #{bfcyGvnmNm}                /** Prénom du bénéficiaire !== 수혜자이름명 ==! */
              , #{bfcyBrdy}                  /** Date de naissance du bénéficiaire !== 수혜자생년월일 ==! */
              , #{bfcyBirtRegnNm}            /** Lieu de naissance du bénéficiaire !== 수혜자출생지역명 ==! */
              , #{bfcyPsprNo}                /** Numéro de passeport du bénéficiaire !== 수혜자여권번호 ==! */
              , #{bfcyDzaAddr}               /** Adresse du bénéficiaire en Algérie !== 수혜자알제리주소 ==! */
              , #{bfcyOvrsAddr}              /** Adresse du bénéficiaire à l'étranger !== 수혜자해외주소 ==! */
              , #{bfcyPsprNoIssDt}           /** Date de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급일자 ==! */
              , #{bfcyPsprNoIssItt}          /** Lieu de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급기관 ==! */
              , #{cufrCsclWrpmPrid}          /** Durée accordée de l'acquit à caution !== 무관세통관허가증기간 ==! */
              , #{cufrCsclWrpmTpCd}          /** Code de cadre de l'acquit à caution !== 무관세통관허가증구분코드 ==! */
              , #{cufrCsclWrpmDtrmNo}        /** @TODO : 번역필요 !== 무관세통관허가증결정번호 ==! */
              , #{cufrCsclWrpmDtrmDt}        /** Date de décision de l'acquit à caution !== 무관세통관허가증결정일자 ==! */
              , #{rcntLiplNo}                /** Dernière immatriculation !== 최근번호판번호 ==! */
              , #{spelAdmnPcdrCn}            /** @TODO : 번역필요 !== 특별행정절차내용 ==! */
              , #{permDocNm}                 /** Libellé de l'autorisation !== 허가문서명 ==! */
              , #{permDocId}                 /** Identifiant de l'autorisation !== 허가문서ID ==! */
              , #{permDocIssDt}              /** Date de délivrance de l'autorisation !== 허가문서발급일자 ==! */
              , #{permDocIssIttNm}           /** Autorité de délivrance de l'autorisation !== 허가문서발급기관명 ==! */
              , #{reffNo}                    /** N° De Référence !== 참조번호 ==! */
              , #{atchFileId}                /** Id Du Fichier Joint !== 첨부파일ID ==! */
              , #{cufrOtptCd}                /** Code d'impression de l'acquit à caution !== 무관세출력코드 ==! */
              , #{cufrBfcyCd}                /** Code de bénéficiaire de l'acquit à caution !== 무관세수혜자코드 ==! */
              , #{bfcyNatCd}                 /** Code de nationalité de bénéficiaire  !== 수혜자국적코드 ==! */
              , #{cufrRqstSttsCd }           /** Code de statut de la demande de l'acquit à caution  !== 무관세신청상태코드 ==! */
              , REPLACE(#{dclrNo }, '-', '')                  /**   N° De La Déclaration  !==  신고서번호 ==! */
              , 'N'                          /** Suppression On !== 삭제여부 ==! */
              , #{frstRegstId}               /** Id Du Premier Enregistrant  !== 최초등록자ID ==! */
              , SYSTIMESTAMP                 /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
              , #{lastChprId}                /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , SYSTIMESTAMP                 /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
              )
  </insert>


  <!--
  @TODO:번역필요 !== 무관세통관허가증 수정 ==!
  (deKim)
  -->
  <update id="updatePscCufrBscs" parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo">
      /* updatePscCufrBscs */
      UPDATE  TB_PSCI_CUFR_CSCL_BSCS SET 
               LAST_CHPR_ID = #{lastChprId}                /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , LAST_CHG_DTTM = SYSTIMESTAMP                /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
              <if test="cstmCd != null and cstmCd != ''">
               ,CSTM_CD = #{cstmCd}                         /** Code Du Bureau !== 세관코드 ==! */
              </if>
              <if test="rqstRegmCd != null and rqstRegmCd != ''">
              , RQST_REGM_CD = #{rqstRegmCd}                /** Code de régime de demande !== 신청레짐코드 ==! */
              </if>
              <if test="bfcyFmnm != null and bfcyFmnm != ''">
              , BFCY_FMNM = #{bfcyFmnm}                     /** @TODO : 번역필요 !== 수혜자성 ==! */
              </if>
              <if test="bfcyGvnmNm != null and bfcyGvnmNm != ''">
              , BFCY_GVNM_NM = #{bfcyGvnmNm}                /** Prénom du bénéficiaire !== 수혜자이름명 ==! */
              </if>
              <if test="bfcyBrdy != null and bfcyBrdy != ''">
              , BFCY_BRDY = #{bfcyBrdy}                     /** Date de naissance du bénéficiaire !== 수혜자생년월일 ==! */
              </if>
              <if test="bfcyBirtRegnNm != null and bfcyBirtRegnNm != ''">
              , BFCY_BIRT_REGN_NM = #{bfcyBirtRegnNm}       /** Lieu de naissance du bénéficiaire !== 수혜자출생지역명 ==! */
              </if>
              <if test="bfcyPsprNo != null and bfcyPsprNo != ''">
              , BFCY_PSPR_NO = #{bfcyPsprNo}                /** Numéro de passeport du bénéficiaire !== 수혜자여권번호 ==! */
              </if>
              <if test="bfcyDzaAddr != null and bfcyDzaAddr != ''">
              , BFCY_DZA_ADDR = #{bfcyDzaAddr}              /** Adresse du bénéficiaire en Algérie !== 수혜자알제리주소 ==! */
              </if>
              <if test="bfcyOvrsAddr != null and bfcyOvrsAddr != ''">
              , BFCY_OVRS_ADDR = #{bfcyOvrsAddr}            /** Adresse du bénéficiaire à l'étranger !== 수혜자해외주소 ==! */
              </if>
              <if test="bfcyPsprNoIssDt != null and bfcyPsprNoIssDt != ''">
              , BFCY_PSPR_NO_ISS_DT = #{bfcyPsprNoIssDt}           
              </if>              
              <if test="bfcyPsprNoIssItt != null and bfcyPsprNoIssItt != ''">
              , BFCY_PSPR_NO_ISS_ITT = #{bfcyPsprNoIssItt}            
              </if>              
              <if test="cufrCsclWrpmPrid != null and cufrCsclWrpmPrid != ''">
              , CUFR_CSCL_WRPM_PRID = #{cufrCsclWrpmPrid}   /** Durée accordée de l'acquit à caution !== 무관세통관허가증기간 ==! */
              </if>
              <if test="cufrCsclWrpmTpCd != null and cufrCsclWrpmTpCd != ''">
              , CUFR_CSCL_WRPM_TP_CD = #{cufrCsclWrpmTpCd}  /** Code de cadre de l'acquit à caution !== 무관세통관허가증구분코드 ==! */
              </if>
              <if test="cufrCsclWrpmDtrmNo != null and cufrCsclWrpmDtrmNo != ''">
              , CUFR_CSCL_WRPM_DTRM_NO = #{cufrCsclWrpmDtrmNo}  /** @TODO : 번역필요 !== 무관세통관허가증결정번호 ==! */
              </if>
              <if test="cufrCsclWrpmDtrmDt != null and cufrCsclWrpmDtrmDt != ''">
              , CUFR_CSCL_WRPM_DTRM_DT = #{cufrCsclWrpmDtrmDt}  /** Date de décision de l'acquit à caution !== 무관세통관허가증결정일자 ==! */
              </if>
              <if test="rcntLiplNo != null and rcntLiplNo != ''">
              , RCNT_LIPL_NO = #{rcntLiplNo}                /** Dernière immatriculation !== 최근번호판번호 ==! */
              </if>
              <if test="spelAdmnPcdrCn != null and spelAdmnPcdrCn != ''">
              , SPEL_ADMN_PCDR_CN = #{spelAdmnPcdrCn}       /** @TODO : 번역필요 !== 특별행정절차내용 ==! */
              </if>
              <if test="permDocNm != null and permDocNm != ''">
              , PERM_DOC_NM = #{permDocNm}                  /** Libellé de l'autorisation !== 허가문서명 ==! */
              </if>
              <if test="permDocId != null and permDocId != ''">
              , PERM_DOC_ID = #{permDocId}                  /** Identifiant de l'autorisation !== 허가문서ID ==! */
              </if>
              <if test="permDocIssDt != null and permDocIssDt != ''">
              , PERM_DOC_ISS_DT = #{permDocIssDt}           /** Date de délivrance de l'autorisation !== 허가문서발급일자 ==! */
              </if>
              <if test="permDocIssIttNm != null and permDocIssIttNm != ''">
              , PERM_DOC_ISS_ITT_NM = #{permDocIssIttNm}    /** Autorité de délivrance de l'autorisation !== 허가문서발급기관명 ==! */
              </if>
              <if test="reffNo != null and reffNo != ''">
              , REFF_NO = #{reffNo}                         /** N° De Référence !== 참조번호 ==! */
              </if>
              <if test='atchFileId != null and atchFileId != ""'>    
              , ATCH_FILE_ID = #{atchFileId}                /** Id Du Fichier Joint !== 첨부파일ID ==! */
              </if>
              <if test='cufrOtptCd != null and cufrOtptCd != ""'>  
              , CUFR_OTPT_CD =  #{cufrOtptCd}                /** Code d'impression de l'acquit à caution !== 무관세출력코드 ==! */
              </if>
              <if test='cufrBfcyCd != null and cufrBfcyCd != ""'>
              , CUFR_BFCY_CD = #{cufrBfcyCd}                /** Code de bénéficiaire de l'acquit à caution !== 무관세수혜자코드 ==! */
              </if>
              <if test='bfcyNatCd != null and bfcyNatCd != ""'>
              , BFCY_NAT_CD = #{bfcyNatCd}                 /** Code de nationalité de bénéficiaire  !== 수혜자국적코드 ==! */
              </if>
         WHERE  DEL_YN = 'N'                                /** Suppression ON !== 삭제여부 ==! */
           AND  CUFR_CSCL_WRPM_ID = #{cufrCsclWrpmId}       /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
  </update>


  <!--
  @TODO:번역필요 !== 무관세통관허가증 삭제 ==!
  (deKim)
  -->
  <update id="deletePscCufrBscs" parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo">
      /* deletePscCufrBscs */
      UPDATE  TB_PSCI_CUFR_CSCL_BSCS SET 
              DEL_YN = 'Y'                                  /** Suppression ON !== 삭제여부 ==! */
           ,  LAST_CHPR_ID = #{lastChprId}                  /** ID du modificateur final !== 최종변경자ID ==! */
           ,  LAST_CHG_DTTM = SYSTIMESTAMP                  /** Date et heure de modification finale !== 최종변경일시 ==! */
       WHERE  DEL_YN = 'N'                                  /** Suppression ON !== 삭제여부 ==! */
         AND  CUFR_CSCL_WRPM_ID = #{cufrCsclWrpmId}         /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
  </update>
	

  <update id="updatePscCufrBscsEnd" parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo">
      /* updatePscCufrBscsEnd */
      UPDATE  TB_PSCI_CUFR_CSCL_BSCS SET 
               LAST_CHPR_ID = #{lastChprId}                /** Id Du Modificateur Final !== 최종변경자ID ==! */
              , LAST_CHG_DTTM = SYSTIMESTAMP                /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
              <if test="endCstmCd != null and endCstmCd != ''">
               ,END_CSTM_CD = #{endCstmCd}                        
              </if>
               ,BSOP_END_DTTM = SYSDATE   
              <if test="tpdEndTpCd != null and tpdEndTpCd != ''">
               ,TPD_END_TP_CD = #{tpdEndTpCd}                        
              </if>
              <if test="rgsrEmpId != null and rgsrEmpId != ''">
               ,RGSR_EMP_ID = #{rgsrEmpId}                        
              </if>              
              <if test="rmrkCn != null and rmrkCn != ''">
               ,RMRK_CN = #{rmrkCn}                        
              </if>  
              <if test="cufrRqstSttsCd != null and cufrRqstSttsCd != ''">
               ,CUFR_RQST_STTS_CD = #{cufrRqstSttsCd}                        
              </if>                
              
         WHERE  DEL_YN = 'N'                                /** Suppression ON !== 삭제여부 ==! */
           AND  CUFR_CSCL_WRPM_ID = #{cufrCsclWrpmId}       /** Identifiant de l'acquit à caution  !== 무관세통관허가증ID ==! */
  </update>
  
  <select id="selectBfcyInfo" parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo"
  resultType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo">
      /* selectBfcyInfo */
        SELECT * FROM (
          SELECT  DRVR_GVNM_NM AS BFCY_FMNM
              , DRVR_FMNM AS BFCY_GVNM_NM
              , DRVR_BRDY AS BFCY_BRDY
              , DRVR_BIRT_REGN_NM AS BFCY_BIRT_REGN_NM
              , DRVR_PSPR_NO AS BFCY_PSPR_NO
              , DRVR_ADDR AS BFCY_DZA_ADDR
              , DRVR_OVRS_ADDR AS BFCY_OVRS_ADDR
              , DRVR_PSPR_NO_ISS_DT AS BFCY_PSPR_NO_ISS_DT
              , DRVR_PSPR_NO_ISS_ITT AS BFCY_PSPR_NO_ISS_ITT
              , DRVR_NAT_CD AS BFCY_NAT_CD
              , 2 AS GUBUN
              , FRST_RGSR_DTTM
          FROM TB_PSCI_TPD_PSNR_BSCS
          WHERE DRVR_PSPR_NO = #{bfcyPsprNo}
          
          UNION ALL
          
          SELECT PSNR_FMNM AS BFCY_FMNM
              , PSNR_GVNM_NM AS BFCY_GVNM_NM
              , BRDY AS BFCY_BRDY
              , BIRT_REGN_NM AS BFCY_BIRT_REGN_NM
              , PSPR_NO AS BFCY_PSPR_NO
              , DZA_ADDR AS BFCY_DZA_ADDR
              , OVRS_RSDN_ADDR AS BFCY_OVRS_ADDR
              , PSPR_NO_ISS_DT AS BFCY_PSPR_NO_ISS_DT
              , PSPR_NO_ISS_ITT AS BFCY_PSPR_NO_ISS_ITT
              , NAT_CD AS BFCY_NAT_CD
              , 3 AS GUBUN
              , FRST_RGSR_DTTM
          FROM TB_PSCI_PSNR_BLGG_IPRT
          WHERE PSPR_NO = #{bfcyPsprNo}
          
          UNION ALL
          SELECT  A.BFCY_FMNM                  /** @TODO : 번역필요 !== 수혜자성 ==! */
                , A.BFCY_GVNM_NM               /** Prénom du bénéficiaire !== 수혜자이름명 ==! */
                , A.BFCY_BRDY                  /** Date de naissance du bénéficiaire !== 수혜자생년월일 ==! */
                , A.BFCY_BIRT_REGN_NM          /** Lieu de naissance du bénéficiaire !== 수혜자출생지역명 ==! */
                , A.BFCY_PSPR_NO               /** Numéro de passeport du bénéficiaire !== 수혜자여권번호 ==! */
                , A.BFCY_DZA_ADDR              /** Adresse du bénéficiaire en Algérie !== 수혜자알제리주소 ==! */
                , A.BFCY_OVRS_ADDR             /** Adresse du bénéficiaire à l'étranger !== 수혜자해외주소 ==! */
                , A.BFCY_PSPR_NO_ISS_DT        /** Date de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급일자 ==! */
                , A.BFCY_PSPR_NO_ISS_ITT       /** Lieu de délivrance du passeport du bénéficiaire !== 수혜자여권번호발급기관 ==! */
                , A.BFCY_NAT_CD                /** Code de nationalité de bénéficiaire  !== 수혜자국적코드 ==! */ 
                , 1 AS GUBUN
                , A.FRST_RGSR_DTTM
          FROM TB_PSCI_CUFR_CSCL_BSCS A 
          WHERE A.BFCY_PSPR_NO = #{bfcyPsprNo}
        
        )
        ORDER BY GUBUN , FRST_RGSR_DTTM DESC 
        LIMIT 1
 
  </select>
  

  <select id="selectDedInfo"  
    parameterType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo" 
    resultType="alpass.ipt.psc.cufr.mgmt.vo.PscCufrBscsVo"> 
      /* selectDedInfo */      
           SELECT 
                 COMN.DTL_DCSH_NO AS DCLR_NO 
                ,COMN.ACPT_YN AS VHCL_YN
           FROM TB_CLRI_DED_COMN COMN, TB_CLRI_DED_VHCL VHCL 
           WHERE COMN.DTL_DCSH_NO = VHCL.DTL_DCSH_NO 
           AND VHCL.TPD_MGMT_NO = #{reffNo}
           LIMIT 1

  </select>  
  
  
</mapper>