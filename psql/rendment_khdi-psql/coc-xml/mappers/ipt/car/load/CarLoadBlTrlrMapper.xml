<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="alpass.ipt.car.load.mapper.CarLoadBlTrlrMapper">

    <!--
    Voir la liste des Demande de Remorque !==트레일러 목록 조회==!
    -->
    <select id="selectCarLoadBlTrlrList"
            parameterType="alpass.ipt.car.load.vo.CarLoadBlTrlrVo"
            resultType="alpass.ipt.car.load.vo.CarLoadBlTrlrVo">
        /* selectCarLoadBlTrlrList */
        <if test="pagination != null and  pagination == true ">
        SELECT #{totBlTrlrCnt} AS TOT_CNT
             , SQLRSLT.*
             , ROWNUM as RNUM
          FROM (
        </if>
        SELECT A.LOAD_RQST_NO			 /** !==적재신청번호==! */
	         , A.BL_SRNO                 /** N° De Séquence De Ble !== BL일련번호 ==! */
	         , A.TRLR_SRNO               /** Numéro de série de la remorque !== 트레일러일련번호 ==! */
	         , A.VHCL_RGSR_NO            /** VOYAGE VEHICULES VEHICULE NUMERO_IMMATRICULATION !== 차량등록번호 ==! */
	         , A.CHSS_NO                 /** N° De Châssis !== 차대번호 ==! */
	         , A.TRLR_STSZ               /** Gabarit De Remorque !== 트레일러규격 ==! */
	         , A.DEL_YN
	         , A.FRST_REGST_ID
	         , TO_CHAR(A.FRST_RGSR_DTTM,'DD/MM/YYYY HH24:MI:SS') AS FRST_RGSR_DTTM
	         , A.LAST_CHPR_ID
	         , TO_CHAR(A.LAST_CHG_DTTM,'DD/MM/YYYY HH24:MI:SS') AS LAST_CHG_DTTM
							FROM TB_CARI_LOAD_BL_TRLR A
						    WHERE A.DEL_YN = 'N'
							AND A.LOAD_RQST_NO = #{loadRqstNo}
							<if test="blSrno != null and blSrno != ''">
							AND	A.BL_SRNO = #{blSrno}
							</if>
							<if test="vhclRgsrNo != null and vhclRgsrNo != ''">
       AND	UPPER(A.VHCL_RGSR_NO) LIKE UPPER(#{vhclRgsrNo})||'%'
       </if>
							ORDER BY A.VHCL_RGSR_NO
							<include refid="pagination.footer" ></include>
    </select>

    <!--
    Enregistrement de la déclaration de Remorque !==트레일러 정보를 저장한다==!
    -->
    <insert id="insertCarLoadBlTrlr" parameterType="alpass.ipt.car.load.vo.CarLoadBlTrlrVo">
        /* insertCarLoadBlTrlr */
        INSERT INTO TB_CARI_LOAD_BL_TRLR (
        	  LOAD_RQST_NO       	  /** !== 적재신청번호 ==! */
	        , BL_SRNO                 /** N° De Séquence De Ble !== BL일련번호 ==! */
	        , TRLR_SRNO               /** Numéro de série de la remorque !== 트레일러일련번호 ==! */
	        , VHCL_RGSR_NO            /** VOYAGE VEHICULES VEHICULE NUMERO_IMMATRICULATION !== 차량등록번호 ==! */
	        , CHSS_NO                 /** N° De Châssis !== 차대번호 ==! */
	        , TRLR_STSZ               /** Gabarit De Remorque !== 트레일러규격 ==! */
	        , DEL_YN
            , FRST_REGST_ID
            , FRST_RGSR_DTTM
            , LAST_CHPR_ID
            , LAST_CHG_DTTM
        ) VALUES (
              #{loadRqstNo}
			, #{blSrno}                       /** N° De Séquence De Ble !== BL일련번호 ==! */
			, #{trlrSrno}                   /** Numéro de série de la remorque !== 트레일러일련번호 ==! */
			, #{vhclRgsrNo}                 /** VOYAGE VEHICULES VEHICULE NUMERO_IMMATRICULATION !== 차량등록번호 ==! */
			, #{chssNo}                     /** N° De Châssis !== 차대번호 ==! */
			, #{trlrStsz}                   /** Gabarit De Remorque !== 트레일러규격 ==! */
			, 'N'
            , #{frstRegstId}
            , SYSTIMESTAMP
            , #{lastChprId}
            , SYSTIMESTAMP
        )
    </insert>

    <!--
    Supprimer la  déclaration de Remorque  !==트레일러 정보를 삭제한다.==!
    -->
    <update id="deleteCarLoadBlTrlr" parameterType="alpass.ipt.car.load.vo.CarLoadBlVo" >
        /* deleteCarLoadBlTrlr */
        DELETE FROM TB_CARI_LOAD_BL_TRLR
        WHERE DEL_YN = 'N'
        AND LOAD_RQST_NO = #{loadRqstNo}
        AND	BL_SRNO = #{blSrno}
    </update>

</mapper>

























