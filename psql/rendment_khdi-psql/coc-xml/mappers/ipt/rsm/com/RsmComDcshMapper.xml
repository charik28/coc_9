<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
  Mapper : Gestion de risques commun
  !== 위험관리 공통 Mapper ==!
-->
<mapper namespace="alpass.ipt.rsm.com.mapper.RsmComDcshMapper">

    <!-- commun de la déclaration en détail(douane) !== DED 공통 조회 ==!   -->
	<select id="selectDedDcshComn" parameterType="alpass.ipt.rsm.iprt.vo.RsmComDedDcshSearchVo" resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedComnVo">
		/* selectDedDcshComn */
		SELECT
			  A.DTL_DCSH_NO                /* Numero du DED !== DED번호 ==! */
			, TO_CHAR(TO_DATE(A.DCLR_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS DCLR_DT   /** Date de DED !== DED 신고일자 ==! */
			, A.REFF_NO               /** N° de référence !== 참조번호  ==! */
			, A.MDFY_DGCNT            /** Nombre de fois de la modification !== 정정차수  ==! */
			, A.DCLR_PT_CD            /** Code de type de déclaration !== 신고유형코드   ==! */
		    , A.EPC_CD ||' | ' ||(SELECT EPC_NM FROM TB_CLRI_EPC_CD WHERE EPC_CD = A.EPC_CD AND DEL_YN = 'N' AND NVL(A.RQST_DT,TO_CHAR(CURRENT_DATE,'YYYYMMDD')) BETWEEN EPC_APLY_STRT_DT AND EPC_APLY_END_DT) AS EPC_CD    /** Description du code EPC !== EPC명 ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0004' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DCLR_PT_CD) AS DCLR_TP_NM
			, A.DCLR_CSTM_CD          /**  Code de bureau de déclaration  !== 신고세관코드 ==! */
			, (SELECT ORGN_NM FROM  TB_POTI_ORGN WHERE DEL_YN = 'N' AND ORGN_CD =  A.DCLR_CSTM_CD AND ROWNUM = 1) AS DCLR_CSTM_NM /**  Nom de bureau de déclaration  !== 신고세관코드명 ==! */
			, A.CSCL_PLN_CD           /**  Code de plan de dédouanement  !== 통관계획코드      ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0006' AND LANG_CD = #{langCd} AND CD_VDVAL = A.CSCL_PLN_CD) AS CSCL_PLN_NM
			, A.DCSH_FM_CD            /**  Code de formulaire de la déclaration  !== 신고서양식코드       ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0007' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DCSH_FM_CD) AS DCSH_FM_NM
			, A.PDLS_GCNT             /**  Nombre d'articles  !== 품목개수         ==! */
			, A.PCKG_TGCNT            /**  Nombre total de colis  !== 포장총개수         ==! */
			, A.CNTR_CAG_YN           /**  Cargaison conteneurisée ON   !== 컨테이너화물여부   ==! */
			, A.AL_TTWG               /**  Poids brut total   !== 전체총중량   ==! */
			, A.AL_NTWG               /**  Poids net total   !== 전체순중량    ==! */
			, A.EXPPN_IDFY_NO_TP_CD   /**  Code de type du N° d'identification de l'exportateur   !== 수출자식별번호구분코드   ==! */
			, A.EXPPN_IDFY_NO         /**  N° d'identification de l'exportateur !== 수출자식별번호   ==! */
			, A.IMPPN_IDFY_NO_TP_CD   /**  Code de type du N° d'identification de l'importateur !== 수입자식별번호구분코드   ==! */
			, A.IMPPN_IDFY_NO         /**  N° d'identification de l'importateur !== 수입자식별번호  ==! */
			, A.TXPR_IDFY_NO          /**  NIU !== 납세자식별번호   ==! */
			, A.DCER_CD               /**  Code du déclarant !== 신고인코드  ==! */
			, A.CSM_CNTY_CD           /**  Code de pays d'expédition !== 탁송국가코드  ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'COM_0002' AND LANG_CD = #{langCd} AND CD_VDVAL = A.CSM_CNTY_CD) AS CSM_CNTY_NM
			, A.TRDE_DLNG_CNTY_CD     /**  Code de pays de transaction !== 무역거래국가코드   ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'COM_0002' AND LANG_CD = #{langCd} AND CD_VDVAL = A.TRDE_DLNG_CNTY_CD) AS TRDE_DLNG_CNTY_NM
			, A.EXP_CNTY_CD           /**  Code de pays exportateur !== 수출국가코드    ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'COM_0002' AND LANG_CD = #{langCd} AND CD_VDVAL = A.EXP_CNTY_CD) AS EXP_CNTY_NM
			, A.DSTN_CNTY_CD          /**  Code de pays destinataire !== 목적지국가코드     ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'COM_0002' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DSTN_CNTY_CD) AS DSTN_CNTY_NM
			, A.DSTN_REGN_CD          /**  Code de région destinataire !== 목적지지역코드      ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0008' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DSTN_REGN_CD) AS DSTN_REGN_NM
			, A.TRNP_METH_KND_CD      /**  Code de type du moyen de transport !== 운송수단종류코드    ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CAR_0013' AND LANG_CD = #{langCd} AND CD_VDVAL = A.TRNP_METH_KND_CD) AS TRNP_METH_KND_NM
			, A.TRNP_METH_IDFY_NO     /**  N° d'identification du moyen de transport !== 운송수단식별번호  ==! */
			, A.TRNP_METH_NAT_CD      /**  Code de pays du moyen de transport  !==  운송수단국적코드  ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'COM_0002' AND LANG_CD = #{langCd} AND CD_VDVAL = A.TRNP_METH_NAT_CD) AS TRNP_METH_NAT_NM
			, A.SHIP_NM               /**  Nom du navire  !== 선박명  ==! */
			, A.CAG_MGMT_NO           /**  CRN  !== 화물관리번호   ==! */
			, A.BL_NO                 /**  N° de BL !== BL번호    ==! */
			, TO_CHAR(TO_DATE(A.ARVL_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS ARVL_DT
			, A.DIVD_CSCL_TP_CD       /** Code d'indicateur du dédouanement partiel !== 분할통관구분코드    ==! */ 
			, A.LDNP_CD               /** Code de lieu de chargement !== 선적지코드    ==! */
			, A.CNTR_GCNT             /** Nombre de conteneurs !== 컨테이너개수    ==! */
			, A.DISPR_CD              /** Code de lieu de déchargement !== 하역지코드   ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0008' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DISPR_CD) AS DISPR_NM
			, TO_CHAR(TO_DATE(A.LDUN_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS LDUN_DT  /** Date de déchargement !== 하역일자   ==! */
			, A.RLBR_CSTM_CD          /** Code du bureau d'entrée et de sortie !== 반출입세관코드   ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'COM_0005' AND LANG_CD = #{langCd} AND CD_VDVAL = A.RLBR_CSTM_CD) AS RLBR_CSTM_NM
		    , A.CMDT_STGE_LOCT_CD     /** Code De Localisation De Stockage !== 물품장치위치코드   ==! */
			, A.BNBN_CMDT_WRHS_CD     /** Code D'Entrepôt De La Marchandise Sous Douane !== 보세물품창고코드   ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CAR_0003' AND LANG_CD = #{langCd} AND CD_VDVAL = A.BNBN_CMDT_WRHS_CD) AS BNBN_WRHS_NM
			, A.BF_BNBN_CMDT_WRHS_CD  /** Code De L'Entrepôt Précédent De La Marchandise Sous Douane !== 이전보세물품창고코드   ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CAR_0003' AND LANG_CD = #{langCd} AND CD_VDVAL = A.BF_BNBN_CMDT_WRHS_CD) AS BF_BNBN_WRHS_NM
			, A.PSMGT_FFMN_XPIR_PRID  /** Période d'échéance de l'apurement de régime suspensif !== 사후관리이행만료기간  ==! */
			, A.DLVR_COND_CD          /** Code de la condition de livraison !== 인도조건코드  ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0009' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DLVR_COND_CD) AS DLVR_COND_NM
			, A.DLVR_PLC_CD           /** Code du lieu de livraison !== 인도장소코드  ==! */
			, A.INVC_NO               /** N° de facture !== 송장번호  ==! */
			, TO_CHAR(TO_DATE(A.INVC_PBLS_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS INVC_PBLS_DT  /** Date de l'émission de la facture !== 송장발행일자  ==! */
			, A.PYMN_MEAN_CD          /** Code de mode de paiement !== 지불방법코드  ==! */
			, A.PYMN_BNK_CD           /** Code de banque de paiement !== 지불은행코드 ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0011' AND LANG_CD = #{langCd} AND CD_VDVAL = A.PYMN_BNK_CD) AS PYMN_BNK_NM
			, A.PYMN_BNK_BRNH_CD      /** Code d'agnce de banque de paiement !== 지불은행지점코드 ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0012' AND LANG_CD = #{langCd} AND CD_VDVAL = A.PYMN_BNK_BRNH_CD) AS PYMN_BNK_BRNH_NM
			, A.PYMN_AC_NO            /** N° de compte de paiement !== 지불계좌번호 ==! */
			, A.DLNG_COND1_CD         /** Code de condition de transaction 1 !== 거래조건1코드 ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0014' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DLNG_COND1_CD) AS DLNG_COND1_NM
			, A.DLNG_COND2_CD         /** Code de condition de transaction 2 !== 거래조건2코드 ==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0015' AND LANG_CD = #{langCd} AND CD_VDVAL = A.DLNG_COND1_CD) AS DLNG_COND2_NM
			, A.PRC_DCSH_WRTE_YN      /** Déclaration de la valeur saisie ON !== 가격신고서기재여부 ==! */
			, A.OWHS_PRC_EV_YN        /** Auto-liquidation ON !== 자가가격평가여부 ==! */
			, A.DCER_WRTE_CN          /** Texte libre réservé au déclarant !== 신고인기재내용 ==! */
			, A.PRCS_STTS_CD          /** Code de statut de traitement !== 처리상태코드==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'CLR_0049' AND LANG_CD = #{langCd} AND CD_VDVAL = A.PRCS_STTS_CD) AS PRCS_STTS_NM
			, A.DEPT_CD               /** Code de section !== 부서코드==! */
			, A.AUDT_EMP_ID           /** ID de la personne vérifiant !== 심사직원ID==! */
			, (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.AUDT_EMP_ID) AS AUDT_EMP_NM      /** Nom du la personne vérifiant !== 심사직원명==! */
			, A.INSC_EMP_ID             /** ID de l'inspecteur !==검사직원ID==! */
			, (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.INSC_EMP_ID) AS INSC_EMP_NM      /** Nom du l'inspecteur !==검사직원명==! */
			, A.SELC_RSLT_CD          /** Code de résultat de ciblage !== 선별결과코드==! */
			, (SELECT CD_VDVAL_NM FROM TB_COM_COMN_CD_D_LANG WHERE COMN_CD = 'RSM_0001' AND LANG_CD = #{langCd} AND CD_VDVAL = A.SELC_RSLT_CD) AS SELC_RSLT_NM
			, A.PSMGT_TRGT_YN         /** Cible du suivi ON !== 사후관리대상여부==! */
			, A.PSMGT_FFMN_CMPL_YN    /** Régime suspensif apuré ON !== 사후관리이행완료여부==! */
			, TO_CHAR(TO_DATE(A.PSMGT_FFMN_CMPL_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS PSMGT_FFMN_CMPL_DT  /** Date de l'apurement de régime suspensif !== 사후관리이행완료일자==! */
			, A.PSMGT_FFMN_XPIR_PRID  /** Période d'échéance de l'apurement de régime suspensif !== 사후관리이행만료기간==! */
			, A.HIST_SRNO             /** N° de séquence de l'histoire !== 이력일련번호==! */
			, TO_CHAR(TO_DATE(A.EXP_FFMN_CMPL_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS EXP_FFMN_CMPL_DT  /** Date de l'accomplissement de l'apurement d'exportation !== 수출이행완료일자==! */
			, TO_CHAR(TO_DATE(A.EXP_FFMN_XPIR_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS EXP_FFMN_XPIR_DT  /** Date d'échéance de l'apurement d'exportation !== 수출이행만료일자==! */
			, TO_CHAR(TO_DATE(A.ASMT_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS ASMT_DT  /** Date de la liquidation !== 가격평가심사일자==! */
			, A.ACPT_YN               /** Enlèvement autorisé ON !== 수리여부==! */
			, TO_CHAR(TO_DATE(A.ACPT_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS ACPT_DT /** Date de l'autorisation d'enlèvement des marchandises !== 수리일자==! */
			, A.RLSE_YN               /** Enlevé ON !== 반출여부==! */
			, TO_CHAR(TO_DATE(A.RLSE_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS RLSE_DT  /** Date d'enlèvement !== 반출일자==! */
			, A.ATR_DCLR_RCPN_YN      /** Déclaration modifiée reçue ON !== 수정신고수신여부==! */
			, A.CNCL_DCLR_RCPN_YN     /** Déclaration de l'annulation reçue ON !== 취소신고수신여부==! */
			, A.CSCL_PSTP_YN          /** Dédouanement suspendu ON !== 통관보류여부==! */
			, A.DPUT_YN               /** Contentieux ON !== 쟁송여부==! */
			, A.PRVI_DCLR_APRE_YN     /** Déclaration provisoire autorisée ON !== 잠정신고승인여부==! */
			, A.NEW_SYS_YN            /** Nouveau système ON !== 신규시스템여부==! */
			, A.DEL_YN                /** Suppression ON !== 삭제여부==! */
			, TO_CHAR(TO_DATE(A.RQST_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS RQST_DT /** Date de demande !== 신청일자==! */
			, TO_CHAR(FRST_RGSR_DTTM, 'DD/MM/YYYY') AS FRST_RGSR_DTTM  /** Date et heure de premier enregistrement !== 최초등록일시==! */
			, FRST_REGST_ID           /** ID du premier enregistrant  !== 최초등록자ID==! */
			, (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM          /* Nom du premier enregistrant  !== 최초등록자이름 ==! */
			, TO_CHAR(LAST_CHG_DTTM, 'DD/MM/YYYY') AS LAST_CHG_DTTM   /** Date et heure de modification finale !== 최종변경일시==! */
			, LAST_CHPR_ID            /** ID du modificateur final  !== 최종변경자IDID==! */
			, (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM          /* Nom du modificateur final !== 최종변경자이름 ==! */
		FROM TB_CLRI_DED_COMN A
		WHERE A.DTL_DCSH_NO = #{dtlDcshNo} 			/** Numero de la déclaration en détail !== 상세신고서번호 ==! */
		AND A.DEL_YN = 'N'
	
	</select>
	
	<!-- Consulter la liste des articles de la DeD !==DED 품목 목록 조회==! -->
	<select id="selectDedDcshPdls" parameterType="alpass.ipt.rsm.iprt.vo.RsmComDedDcshSearchVo" resultType="alpass.ipt.rsm.iprt.vo.RsmDedPdlsChnlMgmtVo">
		/* selectDedDcshPdls */
		SELECT
			  'false' AS CHK_SEL
			, A.DTL_DCSH_NO               /* Numero du DED !== DED번호 ==! */
			, A.PDLS_NO                   /** N° d'article !== 품목번호  ==! */
			, ( SELECT NVL(MAX(CHG_SRNO), 0)+1
			    FROM   TB_RSMI_SELC_CHG_MGMT
			    WHERE  DTL_DCSH_NO = A.DTL_DCSH_NO
			    AND    PDLS_NO = A.PDLS_NO
			  ) as CHG_SRNO
			, A.HS_CD                     /** Code SH !== HS코드  ==! */
			, A.CMDT_CLSF_SPEL_CD         /** Code spécifique de classification de marchandise !== 물품분류특별코드  ==! */
			, A.PDLS_NM                   /** Nom de l'article !== 품목명  ==! */
			, A.DLNG_PDLS_NM              /** Nom de l'article de transaction !== 거래품목명  ==! */
			, A.NWPR_SCAR_CMDT_CD         /** Code de produit neuf et usagé !== 신상품중고물품코드  ==! */
			, A.PCKG_SHMR_MARK_NO         /** N° de marque d'expédition du colis !== 포장화인마크번호  ==! */
			, A.PCKG_DESC                 /** Description du colis !== 포장설명  ==! */
			, A.ORCY_CNTY_CD              /** Code de pays d'origine !== 원산지국가코드  ==! */
			, A.APC_CD                    /** Code APC !== APC코드  ==! */
		    , (SELECT APC_NM FROM TB_CLRI_APC_CD WHERE APC_CD = A.APC_CD AND DEL_YN = 'N') AS APC_NM    /** Description du code APC !== APC명 ==! */
			, B.EPC_CD||' '||A.APC_CD AS CPC_CD
			, A.PRVL_CD                   /** Code de préférence !== 특혜코드  ==! */
			, A.QTA_APRE_NO               /** N° d'autorisation du quota !== 쿼터승인번호  ==! */
			, A.MG_DSCN_APRE_NO           /** N° d'autorisation de l'abattement sur la caution !== 담보할인승인번호  ==! */
			, A.PRC_DTRM_MEAN_CD          /** Code de méthode d'évaluation de valeur !== 가격결정방법코드  ==! */
			, A.BRND_NM                   /** Nom de la marque !== 브랜드명  ==! */
			, A.BF_DTL_DCSH_NO                 /** N° de DED précédent !== 이전DED번호  ==! */
			, TO_CHAR(TO_DATE(A.BF_DTL_DCSH_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS BF_DED_DT  /** Date de DED précédent !== 이전DED일자  ==! */
			, A.BF_PDLS_NO                /** N° d'article précédent !== 이전품목번호  ==! */
			, A.DIVD_FFMN_TP_CD           /** Code d'indicateur de l'apurement partiel !== 분할이행구분코드  ==! */
			, A.QTY                       /** Quantité !== 수량  ==! */
			, A.QTY_UT_CD                 /** Code de l'unité de quantité !== 수량단위코드  ==! */
			, A.TRIF_BASE_VAL             /** Valeur statistique !== 관세기준값  ==! */
			, A.PDLS_TTWG                 /** Poids brut de l'article !== 품목총중량  ==! */
			, A.PDLS_NTWG                 /** Poids net de l'article !== 품목순중량  ==! */
			, A.PDLS_PCKG_GCNT            /** Nombre de colis de l'article !== 품목포장개수  ==! */
			, A.PDLS_PCKG_UT_CD           /** Code d'unité de colis de l'article !== 품목포장단위코드  ==! */
			, A.VHCL_YN                   /** Véhicule ON !== 차량여부  ==! */
			, A.PDLS_PSMGT_TRGT_YN        /** Objet de suivi de l'article ON !== 품목사후관리대상여부  ==! */
			, A.PDLS_PSMGT_FFMN_CMPL_YN   /** Apurement de régime suspensif accompli ON !== 품목사후관리이행완료여부 ==! */
			, TO_CHAR(TO_DATE(A.PDLS_PSMGT_FFMN_CMPL_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS PDLS_PSMGT_FFMN_CMPL_DT /** Date de l'accomplissement de l'apurement de régime suspensif de l'article !== 품목사후관리이행완료일자 ==! */
			, A.PDLS_PSMGT_CONC_RSN_CD    /** Code de clôture de suivi de l'article !== 품목사후관리종결사유코드 ==! */
			, A.DEL_YN                    /** Suppression ON !== 삭제여부 ==! */
			, C.SELC_RSLT_CD AS SELC_RSLT_CD              /** Code de résultat de ciblage !== 선별결과코드 ==! */
			, NVL(C.SELC_CHG_YN,'N') AS SELC_CHG_YN               /** Circuit rerouté O/N !== 선별변경여부 ==! */
			, ( SELECT PDLS_TXBS_USD_AMT
			    FROM   TB_CLRI_DED_VLUT_PDLS AA
			    WHERE  AA.DTL_DCSH_NO  = A.DTL_DCSH_NO
			    AND    AA.PDLS_NO = A.PDLS_NO
			    AND    AA.DEL_YN  = 'N'
			  ) AS PDLS_TXBS_USD_AMT      /** Montant USD de la base taxable de l'article !== 품목과세기준USD금액 ==! */
			, ( SELECT PDLS_TXBS_NCY_AMT
			    FROM   TB_CLRI_DED_VLUT_PDLS AA
			    WHERE  AA.DTL_DCSH_NO  = A.DTL_DCSH_NO
			    AND    AA.PDLS_NO = A.PDLS_NO
			    AND    AA.DEL_YN  = 'N'
			  ) AS PDLS_TXBS_NCY_AMT     /** Montant NCY de la base taxable de l'article !== 품목과세기준NCY금액 ==! */

		FROM  TB_CLRI_DED_PDLS A
			, TB_CLRI_DED_COMN B
			, TB_RSMI_DED_PDLS_CHNL C
		WHERE A.DTL_DCSH_NO     = #{dtlDcshNo} 				/** Numero de la déclaration en détail !== 상세신고서번호 ==! */
		AND   A.DTL_DCSH_NO     = B.DTL_DCSH_NO
		AND   A.DEL_YN          = 'N' 						/** Suppression ON !== 삭제여부 ==! */
		AND   C.DTL_DCSH_NO(+)  = A.DTL_DCSH_NO
		AND   C.PDLS_NO(+)      = A.PDLS_NO 				/** N° D'Article !== 품목번호 ==! */
		ORDER BY TO_NUMBER(A.PDLS_NO) ASC
	</select>

	<!-- Consulter détaillé des articles de la DeD !== DED 품목 상세 조회==! -->
	<select id="selectDedDcshPdlsDtl" parameterType="alpass.ipt.rsm.iprt.vo.RsmComDedDcshSearchVo"
			                          resultType="alpass.ipt.rsm.iprt.vo.RsmDedPdlsChnlMgmtVo">
		/* selectDedDcshPdlsDtl */
		SELECT
			  'false' AS CHK_SEL
			, A.DTL_DCSH_NO               /* Numero du DED !== DED번호 ==! */
			, A.PDLS_NO                   /** N° d'article !== 품목번호  ==! */
			, ( SELECT NVL(MAX(CHG_SRNO), 0)+1
			    FROM   TB_RSMI_SELC_CHG_MGMT
			    WHERE  DTL_DCSH_NO = A.DTL_DCSH_NO
			    AND    PDLS_NO = A.PDLS_NO
			  ) as CHG_SRNO
			, A.HS_CD                     /** Code SH !== HS코드  ==! */
			, A.CMDT_CLSF_SPEL_CD         /** Code spécifique de classification de marchandise !== 물품분류특별코드  ==! */
			, A.PDLS_NM                   /** Nom de l'article !== 품목명  ==! */
			, A.DLNG_PDLS_NM              /** Nom de l'article de transaction !== 거래품목명  ==! */
			, A.NWPR_SCAR_CMDT_CD         /** Code de produit neuf et usagé !== 신상품중고물품코드  ==! */
			, A.PCKG_SHMR_MARK_NO         /** N° de marque d'expédition du colis !== 포장화인마크번호  ==! */
			, A.PCKG_DESC                 /** Description du colis !== 포장설명  ==! */
			, A.ORCY_CNTY_CD              /** Code de pays d'origine !== 원산지국가코드  ==! */
			, A.APC_CD                    /** Code APC !== APC코드  ==! */
		    , (SELECT APC_NM FROM TB_CLRI_APC_CD WHERE APC_CD = A.APC_CD AND DEL_YN = 'N') AS APC_NM    /** Description du code APC !== APC명 ==! */
			, B.EPC_CD||' '||A.APC_CD AS CPC_CD
			, A.PRVL_CD                   /** Code de préférence !== 특혜코드  ==! */
			, A.QTA_APRE_NO               /** N° d'autorisation du quota !== 쿼터승인번호  ==! */
			, A.MG_DSCN_APRE_NO           /** N° d'autorisation de l'abattement sur la caution !== 담보할인승인번호  ==! */
			, A.PRC_DTRM_MEAN_CD          /** Code de méthode d'évaluation de valeur !== 가격결정방법코드  ==! */
			, A.BRND_NM                   /** Nom de la marque !== 브랜드명  ==! */
			, A.BF_DTL_DCSH_NO                 /** N° de DED précédent !== 이전DED번호  ==! */
			, TO_CHAR(TO_DATE(A.BF_DTL_DCSH_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS BF_DED_DT  /** Date de DED précédent !== 이전DED일자  ==! */
			, A.BF_PDLS_NO                /** N° d'article précédent !== 이전품목번호  ==! */
			, A.DIVD_FFMN_TP_CD           /** Code d'indicateur de l'apurement partiel !== 분할이행구분코드  ==! */
			, A.QTY                       /** Quantité !== 수량  ==! */
			, A.QTY_UT_CD                 /** Code de l'unité de quantité !== 수량단위코드  ==! */
			, A.TRIF_BASE_VAL             /** Valeur statistique !== 관세기준값  ==! */
			, A.PDLS_TTWG                 /** Poids brut de l'article !== 품목총중량  ==! */
			, A.PDLS_NTWG                 /** Poids net de l'article !== 품목순중량  ==! */
			, A.PDLS_PCKG_GCNT            /** Nombre de colis de l'article !== 품목포장개수  ==! */
			, A.PDLS_PCKG_UT_CD           /** Code d'unité de colis de l'article !== 품목포장단위코드  ==! */
			, A.VHCL_YN                   /** Véhicule ON !== 차량여부  ==! */
			, A.PDLS_PSMGT_TRGT_YN        /** Objet de suivi de l'article ON !== 품목사후관리대상여부  ==! */
			, A.PDLS_PSMGT_FFMN_CMPL_YN   /** Apurement de régime suspensif accompli ON !== 품목사후관리이행완료여부 ==! */
			, TO_CHAR(TO_DATE(A.PDLS_PSMGT_FFMN_CMPL_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS PDLS_PSMGT_FFMN_CMPL_DT /** Date de l'accomplissement de l'apurement de régime suspensif de l'article !== 품목사후관리이행완료일자 ==! */
			, A.PDLS_PSMGT_CONC_RSN_CD    /** Code de clôture de suivi de l'article !== 품목사후관리종결사유코드 ==! */
			, A.DEL_YN                    /** Suppression ON !== 삭제여부 ==! */
			, NVL(C.SELC_RSLT_CD, B.SELC_RSLT_CD) AS SELC_RSLT_CD              /** Code de résultat de ciblage !== 선별결과코드 ==! */
			, NVL(C.SELC_CHG_YN,'N') AS SELC_CHG_YN               /** Circuit rerouté O/N !== 선별변경여부 ==! */
			, ( SELECT PDLS_TXBS_USD_AMT
			    FROM   TB_CLRI_DED_VLUT_PDLS AA
			    WHERE  AA.DTL_DCSH_NO  = A.DTL_DCSH_NO
			    AND    AA.PDLS_NO = A.PDLS_NO
			    AND    AA.DEL_YN  = 'N'
			  ) AS PDLS_TXBS_USD_AMT      /** Montant USD de la base taxable de l'article !== 품목과세기준USD금액 ==! */
			, ( SELECT PDLS_TXBS_NCY_AMT
			    FROM   TB_CLRI_DED_VLUT_PDLS AA
			    WHERE  AA.DTL_DCSH_NO  = A.DTL_DCSH_NO
			    AND    AA.PDLS_NO = A.PDLS_NO
			    AND    AA.DEL_YN  = 'N'
			  ) AS PDLS_TXBS_NCY_AMT     /** Montant NCY de la base taxable de l'article !== 품목과세기준NCY금액 ==! */
			, (
				SELECT COUNT(1)
				FROM TB_RSMI_SELC_CHG_MGMT T
				WHERE T.DTL_DCSH_NO = A.DTL_DCSH_NO
				AND T.PDLS_NO = A.PDLS_NO
				AND (SELECT APRV_PRCS_STTS_CD FROM TB_POTI_APRV WHERE APRV_ID = T.APRV_ID) = 'I04'
			) AS CHG_CNT
		FROM  TB_CLRI_DED_PDLS A
			, TB_CLRI_DED_COMN B
			, TB_RSMI_DED_PDLS_CHNL C
		WHERE A.DTL_DCSH_NO     = #{dtlDcshNo} 		/** Numero de la déclaration en détail !== 상세신고서번호 ==! */
		AND   A.DTL_DCSH_NO     = B.DTL_DCSH_NO
		AND   A.DEL_YN          = 'N' 				/** Suppression On !== 삭제여부 ==! */
		AND   C.DTL_DCSH_NO(+)  = A.DTL_DCSH_NO
		AND   C.PDLS_NO(+)      = A.PDLS_NO
		AND   A.PDLS_NO         = #{pdlsNo} 		/** N° D'Article !== 품목번호 ==! */
		ORDER BY TO_NUMBER(A.PDLS_NO) ASC
	</select>

	<!-- Informations des opérateurs de la DeD !== DED 업체정보 조회 ==! -->
 	<select id="selectDedCoInfo" parameterType="alpass.ipt.rsm.iprt.vo.RsmComDedDcshSearchVo" resultType="alpass.ipt.clr.pdr.dre.vo.ClrDedCoVo">
		/* selectDedCoInfo */
	 	SELECT
			  A.DTL_DCSH_NO        		/** Numero du DED !== DED번호 ==! */
			, A.EXPPN_CO_NM        		/** Nom de société de l'exportateur !== 수출자업체명  ==! */
			, A.EXPPN_ADDR         		/** Adresse de l'exportateur !== 수출자주소  ==! */
			, A.IMPPN_CO_NM        		/** Nom de société de l'importateur !== 수입자업체명  ==! */
			, A.IMPPN_ADDR         		/** Adresse de l'importateur !== 수입자주소  ==! */
			, A.TXPR_CO_NM         		/** Nom de société contribuable !== 납세자업체명  ==! */
			, A.TXPR_ADDR          		/** Adresse du contribuable !== 납세자주소  ==! */
			, A.TXPR_TLPH_NO       		/** N° de téléphone du contribuable !== 납세자전화번호  ==! */
			, A.TXPR_EML           		/** E-mail du contribuable !== 납세자이메일  ==! */
			, A.DCER_CO_NM         		/** Nom de société du déclarant !== 신고인업체명  ==! */
			, A.DCER_ADDR          		/** Adresse du déclarant !== 신고인주소  ==! */
		FROM  TB_CLRI_DED_CO A
		WHERE A.DTL_DCSH_NO = #{dtlDcshNo} 		/** Numero de la déclaration en détail !== 상세신고서번호 ==! */
	 	AND   A.DEL_YN = 'N' 					/** Suppression On !== 삭제여부 ==! */
 	
 	</select>
    
</mapper>
    
    

