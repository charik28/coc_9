<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="alpass.ipt.rsm.selc.mapper.RsmSelcBaseComnMapper">

    <!--
    [Gestion du ciblage] Consulter la liste !== [선별관리] 목록조회 ==!
    --> 
    <select id="selectBaseMgmtComList" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo" resultType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
        /* selectBaseMgmtComList */
        <include refid="pagination.header"/>
        SELECT ROWNUM NO
             , BASE_RGSR_NO                                                 /* Numéro d'enregistrement !== 기준등록번호 ==! */
             , RQST_BASE_CLSF_CD                                            /* Code de classification du critère renseigné !== 신청기준분류코드 ==! */
             , APLY_BASE_CLSF_CD                                            /* Code de classification de critère en vigueur !== 적용기준분류코드 ==! */
             , BASE_RQST_TP_CD                                              /* Code de type de renseignement  !== 기준신청구분코드 ==! */
             , BASE_PRCS_STTS_CD                                            /* Code de statut de critère  !== 기준처리상태코드 ==! */
             , APRV_BSOP_TP_CD                                              /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
             , APRV_ID                                                      /* ID d'approbation  !== 결재ID ==! */
             , ( SELECT TO_CHAR(APRV_PRCS_DTTM, 'DD/MM/YYYY') AS APRV_PRCS_DTTM
                 FROM TB_POTI_APRV_D X
                 WHERE APRV_ID = A.APRV_ID
                 AND APRV_SRNO = (SELECT MAX(APRV_SRNO) FROM TB_POTI_APRV_D Y WHERE Y.APRV_ID = X.APRV_ID)
                 AND APRV_RSLT_CD = 'J01'
               ) AS APRE_DT                                                 /* Date d'autorisation !== 승인일자 ==!*/
             , BASE_APLY_YN                                                 /* En vigueur O/N !== 기준적용여부 ==! */
             , DCSH_TP_CD                                                   /* Code de type de déclaration !== 신고서구분코드 ==! */
             , BSOP_TP_CD                                                   /* Code de type de l'opération !== 업무구분코드 ==! */
             , APLY_STRT_DT                                                 /* Date de départ de l'application !== 적용시작일자 ==! */
             , APLY_END_DT                                                  /* Date de fin de l'application !== 적용종료일자 ==! */
             , TO_CHAR(TO_DATE(A.APLY_STRT_DT, 'YYYYMMDD'),'DD/MM/YYYY')||'~'||TO_CHAR(TO_DATE(A.APLY_END_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS APLY_DT
             , ( SELECT LISTAGG(DCLR_PT_CD, ',') WITHIN GROUP (ORDER BY DCLR_PT_CD)
                 FROM TB_RSMI_DCLR_PT_BASE
                 WHERE BASE_RGSR_NO=A.BASE_RGSR_NO
               ) AS DCLR_PT_CD                                              /* Code de type de déclaration !== 신고유형코드 ==! */
             , APLY_CSTM_TP_CD                                              /* Code de type de bureau  !== 적용세관구분코드 ==! */
             , GRN_SELC_RT                                                  /* Taux de déclaration en circuit vert  !== 녹색선별율 ==! */
             , BLU_SELC_RT                                                  /* Taux de déclaration en circuit bleu  !== 파랑선별율 ==! */
             , ORE_SELC_RT                                                  /* Taux de ciblage vers le circuit orange !== 오렌지선별율 ==! */
             , RED_SELC_RT                                                  /* Taux de déclaration en circuit rouge !== 빨강선별율 ==! */
             , CO_WGVL_APLY_YN                                              /* Application du pondérateur d'opérateur O/N !== 업체가중치적용여부 ==! */
             , SELC_WGVL_APLY_YN                                            /* Pondérateur du critrèe général  !== 선별가중치적용여부 ==! */
             , CASE WHEN CO_WGVL_APLY_YN = 'Y' OR SELC_WGVL_APLY_YN = 'Y' THEN 'Y'
                    ELSE 'N'
               END AS WGVL_APLY_YN                                          /* Pondérateur O/N !== 가중치적용여부 ==! */
             , APLY_PROR_RNK                                                /* Priorité de l'application !== 적용우선순위 ==! */
             , BASE_DESC                                                    /* Description de critère !== 기준설명 ==! */
             , INSC_GDLN_CN                                                 /* Directives d'inspection  !== 검사지침내용 ==! */
             , RQST_RSN_CD                                                  /* Code de renseignement !== 신청사유코드 ==! */
             , RTRN_RSN_CN                                                  /* Motif De Rejet !== 반려 사유 내용 ==! */
             , OPRN_SQL_CN                                                  /* Requête du système en vigueur !== 운영SQL내용 ==! */
             , SMLT_SQL_CN                                                  /* Requête de la simulation !== 시뮬레이션SQL내용 ==! */
             , DLPY_BASE_AMT                                                /* Montant critèredes arriérés !== 체납기준금액 ==! */
             , RNDM_GOAL_SELC_RT                                            /* Taux objectif (RA) !== 랜덤목표선별율 ==!  */
             , CHPN_ID                                                      /* ID du responsable !== 담당자ID ==! */
             , DEL_YN                                                       /* Suppression ON !== 삭제여부 ==! */
             , FRST_REGST_ID                                                /* ID du premier enregistrant  !== 최초등록자ID ==! */
             , ( SELECT EMP_NM
                 FROM TB_POTI_EMP
                 WHERE PBSR_NO = A.FRST_REGST_ID
               ) AS FRST_REGST_NM                                           /* Nom du premier enregistrant  !== 최초등록자이름 ==! */
             , FRST_RGSR_DTTM                                               /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
             , LAST_CHPR_ID                                                 /* ID du modificateur final !== 최종변경자ID ==! */
             , ( SELECT EMP_NM
                 FROM TB_POTI_EMP
                 WHERE PBSR_NO = A.LAST_CHPR_ID
               ) AS LAST_CHPR_NM                                            /* Nom du modificateur final !== 최종변경자이름 ==! */
             , LAST_CHG_DTTM                                                /* Date et heure de modification finale !== 최종변경일시 ==! */
            <if test="rqstBaseClsfCd != null and rqstBaseClsfCd == 'PR' ">
             ,(SELECT PRGM_TP_CD FROM TB_RSMI_PRGM_BASE WHERE BASE_RGSR_NO = A.BASE_RGSR_NO AND ROWNUM = 1) AS PRGM_TP_CD                                        /* Code de type de programme !== 프로그램구분코드 ==! */
            </if>
             , DECODE(A.ORBS_RGSR_NO, NULL, NULL, '', NULL, ( SELECT LISTAGG( AA.BASE_RGSR_NO||' ( '||TO_CHAR(AA.FRST_RGSR_DTTM, 'DD/MM/YYYY')||' ) ',',    ') WITHIN GROUP( ORDER BY AA.FRST_RGSR_DTTM DESC )
				                                            FROM   TB_RSMI_BASE_MGMT_COMN AA
        		                                            WHERE  AA.DEL_YN = 'N'
			                                                AND    AA.BASE_RGSR_NO = A.ORBS_RGSR_NO
            		                                       )
             ) OPRN_MOCK_BASE_RGSR_NO
         FROM  TB_RSMI_BASE_MGMT_COMN A
         WHERE DEL_YN = 'N'                                                 /* Suppression ON !== 삭제여부 ==! */

         <if test="rqstBaseClsfCd != null and rqstBaseClsfCd != '' ">
         AND   RQST_BASE_CLSF_CD = #{rqstBaseClsfCd}                        /* Code de classification du critère renseigné !== 신청기준분류코드 ==! */
         </if>

         <if test='(aplyStrtDt != null and !"".equals(aplyStrtDt)) and (aplyEndDt != null and !"".equals(aplyEndDt))'>
         AND A.APLY_STRT_DT <![CDATA[ <= ]]> TO_CHAR(TO_DATE(#{aplyEndDt}, 'DD/MM/YYYY'), 'YYYYMMDD') AND A.APLY_END_DT <![CDATA[ >= ]]> TO_CHAR(TO_DATE(#{aplyStrtDt}, 'DD/MM/YYYY'), 'YYYYMMDD')
         </if>

         <if test="basePrcsSttsCd != null and basePrcsSttsCd != ''">
             <if test="'00' != basePrcsSttsCd">
         AND   BASE_PRCS_STTS_CD = #{basePrcsSttsCd}                        /* Code de statut de critère  !== 기준처리상태코드 ==! */
             </if>
         </if>

         <if test="baseRqstTpCd != null and baseRqstTpCd != '' ">
         AND   BASE_RQST_TP_CD = #{baseRqstTpCd}                            /* Code de type de renseignement  !== 기준신청구분코드 ==! */
         </if>

         <if test="baseAplyYn != null and baseAplyYn != '' ">
         AND   BASE_APLY_YN = #{baseAplyYn}                                 /* En vigueur O/N !== 기준적용여부 ==! */
         </if>

         <if test="dcshTpCd != null and dcshTpCd != '' ">
         AND   DCSH_TP_CD = #{dcshTpCd}                                     /* Code de type de déclaration !== 신고서구분코드 ==! */
         </if>

         <if test='bsopTpCd != null and bsopTpCd == "E" '>                  
         AND EXISTS(SELECT 1 FROM TB_RSMI_DCLR_PT_BASE X WHERE X.BASE_RGSR_NO=A.BASE_RGSR_NO AND X.DCLR_PT_CD IN ( SELECT DETAIL.CD_VDVAL         AS DCLR_PT_CD /* CODE DE TYPE DE DÉCLARATION !== 신고유형코드 ==! */
                                                                                                                     FROM TB_COM_COMN_CD   CD , TB_COM_COMN_CD_D DETAIL
                                                                                                                    WHERE CD.DEL_YN               = 'N' AND CD.USE_YN ='Y'
                                                                                                                      AND CD.COMN_CD              = 'RSM_0052'
                                                                                                                      AND CD.COMN_CD              = DETAIL.COMN_CD
                                                                                                                      AND DETAIL.DEL_YN           = 'N' AND DETAIL.USE_YN ='Y'
                                                                                                                      AND DETAIL.USER_DEFN_VDVAL1 = 'EXP')) /* Exportation !== 수출 ==! */
        </if>
        <if test='bsopTpCd != null and bsopTpCd == "I" '>
        AND EXISTS(SELECT 1 FROM TB_RSMI_DCLR_PT_BASE X WHERE X.BASE_RGSR_NO=A.BASE_RGSR_NO AND X.DCLR_PT_CD IN ( SELECT DETAIL.CD_VDVAL         AS DCLR_PT_CD /* CODE DE TYPE DE DÉCLARATION !== 신고유형코드 ==! */
                                                                                                                    FROM TB_COM_COMN_CD   CD , TB_COM_COMN_CD_D DETAIL
                                                                                                                   WHERE CD.DEL_YN               = 'N' AND CD.USE_YN ='Y'
                                                                                                                     AND CD.COMN_CD              = 'RSM_0052'
                                                                                                                     AND CD.COMN_CD              = DETAIL.COMN_CD
                                                                                                                     AND DETAIL.DEL_YN           = 'N' AND DETAIL.USE_YN ='Y'
                                                                                                                     AND DETAIL.USER_DEFN_VDVAL1 = 'IMP'))  /* Importation !== 수입 ==! */
        </if>

         <if test="baseDesc != null and baseDesc != '' ">
         AND   BASE_DESC LIKE '%' || #{baseDesc} || '%'                     /* Description de critère !== 기준설명 ==! */
         </if>

        <if test='wgvlAplyYn != null and wgvlAplyYn != ""'>
            <choose>
                <when test='rqstBaseClsfCd == "RA"'>
                    AND   A.CO_WGVL_APLY_YN = #{wgvlAplyYn}                 /** Application Du Pondérateur D'Opérateur O/N !== 업체가중치적용여부 ==! */
                </when>
                <when test='rqstBaseClsfCd == "HR"'>
                    AND   (A.CO_WGVL_APLY_YN = #{wgvlAplyYn} OR A.SELC_WGVL_APLY_YN = #{wgvlAplyYn})
                </when>
                <when test='rqstBaseClsfCd == "FT"'>
                    AND   A.SELC_WGVL_APLY_YN = #{wgvlAplyYn}               /** Pondérateur Du Critrèe Général  !== 선별가중치적용여부 ==! */
                </when>
            </choose>
        </if>

         <if test="sortOrdr != null and sortOrdr != '' ">
             <if test="sortOrdr == 1 ">
                 ORDER BY LAST_CHG_DTTM DESC, BASE_RGSR_NO DESC             /* Numéro d'enregistrement !== 기준등록번호 ==! */
             </if>
             <if test="sortOrdr == 2 ">
                 ORDER BY APLY_STRT_DT DESC                                 /* Date de départ de l'application !== 적용시작일자 ==! */
             </if>
             <if test="sortOrdr == 3 ">
                 ORDER BY APLY_END_DT DESC                                  /* Date de fin de l'application !== 적용종료일자 ==! */
             </if>
         </if>

        <include refid="pagination.footer" />

    </select>

    <!--
    [Gestion du ciblage] Enregistrer !== [선별관리] 등록 ==!
    -->
    <insert id="insertBaseMgmtCom" parameterType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
        /* insertBaseMgmtCom */
        INSERT INTO TB_RSMI_BASE_MGMT_COMN (
            BASE_RGSR_NO                     /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , RQST_BASE_CLSF_CD                /* Code de classification du critère renseigné !== 신청기준분류코드 ==! */
            , APLY_BASE_CLSF_CD                /* Code de classification de critère en vigueur !== 적용기준분류코드 ==! */
            , BASE_RQST_TP_CD                  /* Code de type de renseignement  !== 기준신청구분코드 ==! */
            , BASE_PRCS_STTS_CD                /* Code de statut de critère  !== 기준처리상태코드 ==! */
            , APRV_BSOP_TP_CD                  /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
            , APRV_ID                          /* ID d'approbation  !== 결재ID ==! */
            , BASE_APLY_YN                     /* En vigueur O/N !== 기준적용여부 ==! */
            , DCSH_TP_CD                       /* Code de type de déclaration !== 신고서구분코드 ==! */
            , BSOP_TP_CD                       /* Code de type de l'opération !== 업무구분코드 ==! */
            , APLY_STRT_DT                     /* Date de départ de l'application !== 적용시작일자 ==! */
            , APLY_END_DT                      /* Date de fin de l'application !== 적용종료일자 ==! */
            , APLY_CSTM_TP_CD                  /* Code de type de bureau  !== 적용세관구분코드 ==! */
            , GRN_SELC_RT                      /* Taux de déclaration en circuit vert  !== 녹색선별율 ==! */
            , BLU_SELC_RT                      /* Taux de déclaration en circuit bleu  !== 파랑선별율 ==! */
            , ORE_SELC_RT                      /* Taux de ciblage vers le circuit orange !== 오렌지선별율 ==! */
            , RED_SELC_RT                      /* Taux de déclaration en circuit rouge !== 빨강선별율 ==! */
            , CO_WGVL_APLY_YN                  /* Application du pondérateur d'opérateur O/N !== 업체가중치적용여부 ==! */
            , SELC_WGVL_APLY_YN                /* Pondérateur du critrèe général  !== 선별가중치적용여부 ==! */
            , APLY_PROR_RNK                    /* Priorité de l'application !== 적용우선순위 ==! */
            , BASE_DESC                        /* Description de critère !== 기준설명 ==! */
            , INSC_GDLN_CN                     /* Directives d'inspection  !== 검사지침내용 ==! */
            , RQST_RSN_CD                      /* Code de renseignement !== 신청사유코드 ==! */
            , RTRN_RSN_CN                      /* Motif De Rejet !== 반려 사유 내용 ==! */
            , OPRN_SQL_CN                      /* Requête du système en vigueur !== 운영SQL내용 ==! */
            , SMLT_SQL_CN                      /* Requête de la simulation !== 시뮬레이션SQL내용 ==! */
            , ORBS_RGSR_NO                     /* Numéro d'enregistrement du critère en version initiale !== 원기준등록번호 ==!*/
            , RSK_INFO_NO                      /* Numéro de données sur les risques !== 위험정보번호 ==! */
            , RSK_FTOR_NO                      /* Numéro d'élément de risque !== 위험요소번호 ==! */
            , DLPY_BASE_AMT                    /* Montant critèredes arriérés !== 체납기준금액 ==! */
            , RNDM_GOAL_SELC_RT                /* Taux objectif (RA) !== 랜덤목표선별율 ==!  */
            , DEL_YN                           /* Suppression ON !== 삭제여부 ==! */
            , FRST_REGST_ID                    /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , FRST_RGSR_DTTM                   /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , LAST_CHPR_ID                     /* ID du modificateur final !== 최종변경자ID ==! */
            , LAST_CHG_DTTM                    /* Date et heure de modification finale !== 최종변경일시 ==! */
        ) VALUES (
              #{baseRgsrNo}                    /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , #{rqstBaseClsfCd}                /* Code de classification du critère renseigné !== 신청기준분류코드 ==! */
            , #{aplyBaseClsfCd}                /* Code de classification de critère en vigueur !== 적용기준분류코드 ==! */
            , #{baseRqstTpCd}                  /* Code de type de renseignement  !== 기준신청구분코드 ==! */
            , #{basePrcsSttsCd}                /* Code de statut de critère  !== 기준처리상태코드 ==! */
            , #{aprvBsopTpCd}                  /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
            , #{aprvId}                        /* ID d'approbation  !== 결재ID ==! */
            , #{baseAplyYn}                    /* En vigueur O/N !== 기준적용여부 ==! */
            , #{dcshTpCd}                      /* Code de type de déclaration !== 신고서구분코드 ==! */
            , #{bsopTpCd}                      /* Code de type de l'opération !== 업무구분코드 ==! */
            , #{aplyStrtDt}                    /* Date de départ de l'application !== 적용시작일자 ==! */
            , #{aplyEndDt}                     /* Date de fin de l'application !== 적용종료일자 ==! */
            , #{aplyCstmTpCd}                  /* Code de type de bureau  !== 적용세관구분코드 ==! */
            , #{grnSelcRt}                     /* Taux de déclaration en circuit vert  !== 녹색선별율 ==! */
            , #{bluSelcRt}                     /* Taux de déclaration en circuit bleu  !== 파랑선별율 ==! */
            , #{oreSelcRt}                     /* Taux de ciblage vers le circuit orange !== 오렌지선별율 ==! */
            , #{redSelcRt}                     /* Taux de déclaration en circuit rouge !== 빨강선별율 ==! */
            , #{coWgvlAplyYn}                  /* Application du pondérateur d'opérateur O/N !== 업체가중치적용여부 ==! */
            , #{selcWgvlAplyYn}                /* Pondérateur du critrèe général  !== 선별가중치적용여부 ==! */
            , #{aplyProrRnk}                   /* Priorité de l'application !== 적용우선순위 ==! */
            , #{baseDesc}                      /* Description de critère !== 기준설명 ==! */
            , #{inscGdlnCn}                    /* Directives d'inspection  !== 검사지침내용 ==! */
            , #{rqstRsnCd}                     /* Code de renseignement !== 신청사유코드 ==! */
            , #{rtrnRsnCn}                     /* Motif De Rejet !== 반려 사유 내용 ==! */
            , #{oprnSqlCn}                     /* Requête du système en vigueur !== 운영SQL내용 ==! */
            , #{smltSqlCn}                     /* Requête de la simulation !== 시뮬레이션SQL내용 ==! */
            , #{orbsRgsrNo}                    /* Numéro d'enregistrement du critère en version initiale !== 원기준등록번호 ==!*/
            , #{rskInfoNo}                     /* Numéro de données sur les risques !== 위험정보번호 ==! */
            , #{rskFtorNo}                     /* Numéro d'élément de risque !== 위험요소번호 ==! */
            , #{dlpyBaseAmt}                   /* Montant critèredes arriérés !== 체납기준금액 ==! */
            , #{rndmGoalSelcRt}                /* Taux objectif (RA) !== 랜덤목표선별율 ==!  */
            , #{delYn}                         /* Suppression ON !== 삭제여부 ==! */
            , #{frstRegstId}                   /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , SYSTIMESTAMP                     /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , #{lastChprId}                    /* ID du modificateur final !== 최종변경자ID ==! */
            , SYSTIMESTAMP                     /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>
    
    <!--
    [Gestion du ciblage] Modifier !== [선별관리] 수정 ==!
    -->
    <update id="updateBaseMgmtCom" parameterType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
        /* updateBaseMgmtCom */
        UPDATE TB_RSMI_BASE_MGMT_COMN SET
             RQST_BASE_CLSF_CD = #{rqstBaseClsfCd}         /* Code de classification du critère renseigné !== 신청기준분류코드 ==! */
           , APLY_BASE_CLSF_CD = #{aplyBaseClsfCd}         /* Code de classification de critère en vigueur !== 적용기준분류코드 ==! */
           , BASE_RQST_TP_CD = #{baseRqstTpCd}             /* Code de type de renseignement  !== 기준신청구분코드 ==! */
           , BASE_PRCS_STTS_CD = #{basePrcsSttsCd}         /* Code de statut de critère  !== 기준처리상태코드 ==! */
           , APRV_BSOP_TP_CD = #{aprvBsopTpCd}             /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/ 
           , BASE_APLY_YN = #{baseAplyYn}                  /* En vigueur O/N !== 기준적용여부 ==! */
           , DCSH_TP_CD = #{dcshTpCd}                      /* Code de type de déclaration !== 신고서구분코드 ==! */
           , BSOP_TP_CD = #{bsopTpCd}                      /* Code de type de l'opération !== 업무구분코드 ==! */
           , APLY_STRT_DT = #{aplyStrtDt}                  /* Date de départ de l'application !== 적용시작일자 ==! */
           , APLY_END_DT = #{aplyEndDt}                    /* Date de fin de l'application !== 적용종료일자 ==! */
           , APLY_CSTM_TP_CD = #{aplyCstmTpCd}             /* Code de type de bureau  !== 적용세관구분코드 ==! */
           , GRN_SELC_RT = #{grnSelcRt}                    /* Taux de déclaration en circuit vert  !== 녹색선별율 ==! */
           , BLU_SELC_RT = #{bluSelcRt}                    /* Taux de déclaration en circuit bleu  !== 파랑선별율 ==! */
           , ORE_SELC_RT = #{oreSelcRt}                    /* Taux de ciblage vers le circuit orange !== 오렌지선별율 ==! */
           , RED_SELC_RT = #{redSelcRt}                    /* Taux de déclaration en circuit rouge !== 빨강선별율 ==! */
           , CO_WGVL_APLY_YN = #{coWgvlAplyYn}             /* Application du pondérateur d'opérateur O/N !== 업체가중치적용여부 ==! */
           , SELC_WGVL_APLY_YN = #{selcWgvlAplyYn}         /* Pondérateur du critrèe général  !== 선별가중치적용여부 ==! */
           , APLY_PROR_RNK = #{aplyProrRnk}                /* Priorité de l'application !== 적용우선순위 ==! */
           , BASE_DESC = #{baseDesc}                       /* Description de critère !== 기준설명 ==! */
           , INSC_GDLN_CN = #{inscGdlnCn}                  /* Directives d'inspection  !== 검사지침내용 ==! */
           , RQST_RSN_CD = #{rqstRsnCd}                    /* Code de renseignement !== 신청사유코드 ==! */
           , RTRN_RSN_CN = #{rtrnRsnCn}                    /* Motif De Rejet !== 반려 사유 내용 ==! */
           , OPRN_SQL_CN = #{oprnSqlCn}                    /* Requête du système en vigueur !== 운영SQL내용 ==! */ 
           , SMLT_SQL_CN = #{smltSqlCn}                    /* Requête de la simulation !== 시뮬레이션SQL내용 ==! */
           , RSK_INFO_NO = #{rskInfoNo}                    /* Numéro de données sur les risques !== 위험정보번호 ==! */
           , RSK_FTOR_NO = #{rskFtorNo}                    /* Numéro d'élément de risque !== 위험요소번호 ==! */
           , DLPY_BASE_AMT = #{dlpyBaseAmt}                /* Montant critèredes arriérés !== 체납기준금액 ==! */
           , RNDM_GOAL_SELC_RT = #{rndmGoalSelcRt}         /* Taux objectif (RA) !== 랜덤목표선별율 ==!  */
           , LAST_CHPR_ID = #{lastChprId}                  /* ID du modificateur final !== 최종변경자ID ==! */
           , LAST_CHG_DTTM = SYSTIMESTAMP                  /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE 1 = 1
        AND BASE_RGSR_NO = #{baseRgsrNo}                   /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
    [Gestion du ciblage] Supprimer !== [선별관리] 삭제 ==!
    -->
    <delete id="deleteBaseMgmtCom" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo">
        /* deleteBaseMgmtCom */
        DELETE FROM TB_RSMI_BASE_MGMT_COMN 
        WHERE BASE_RGSR_NO = #{baseRgsrNo}    /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </delete>

    <!--
    [Gestion du ciblage] Supprimer !== [선별관리] 삭제 ==!
    -->
    <update id="updateDelYnBaseMgmtCom" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo">
        /* updateDelYnBaseMgmtCom */
        UPDATE TB_RSMI_BASE_MGMT_COMN
        SET    DEL_YN = 'Y'                     /* Suppression ON !== 삭제여부 ==! */
             , LAST_CHPR_ID = #{lastChprId}     /* ID du modificateur final !== 최종변경자ID ==! */
             , LAST_CHG_DTTM = SYSTIMESTAMP     /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE  BASE_RGSR_NO = #{baseRgsrNo}     /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
    [Critères renseignés en attente d'approbation] Renvoyer
    !== [기준사용 상신관리] 반려 ==!
    -->
    <update id="updateBasePrcsSttsCd" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo">
    /* updateBasePrcsSttsCd */
        UPDATE TB_RSMI_BASE_MGMT_COMN 
        SET
               APRV_ID = #{aprvId}                      /* ID d'approbation  !== 결재ID ==! */
             , BASE_PRCS_STTS_CD = #{basePrcsSttsCd}    /* Code de statut de critère  !== 기준처리상태코드 ==! */
          <if test="rtrnRsnCn != null and rtrnRsnCn != '' ">
             , RTRN_RSN_CN = #{rtrnRsnCn}               /* Motif De Rejet !== 반려 사유 내용 ==! */
          </if>
             , APRV_BSOP_TP_CD = #{aprvBsopTpCd}        /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/ 
             , LAST_CHPR_ID = #{lastChprId}             /* ID du modificateur final !== 최종변경자ID ==! */
             , LAST_CHG_DTTM = SYSTIMESTAMP             /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE BASE_RGSR_NO = #{baseRgsrNo}              /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
    [Gestion du ciblage] Traitement après l'approbation !== [선별관리] 결재 후처리 ==!
    -->
    <update id="processAprvAfJob" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo">
    /* processAprvAfJob */
        UPDATE TB_RSMI_BASE_MGMT_COMN 
        SET
             BASE_PRCS_STTS_CD = #{basePrcsSttsCd}      /* Code de statut de critère  !== 기준처리상태코드 ==! */
           , APRV_BSOP_TP_CD = #{aprvBsopTpCd}          /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
           , APRV_ID = #{aprvId}                        /* ID d'approbation  !== 결재ID ==! */
           
           <if test="baseRqstTpCd != null and baseRqstTpCd != '' ">
           , BASE_RQST_TP_CD = #{baseRqstTpCd}          /* Code de type de renseignement  !== 기준신청구분코드 ==! */
           </if>
           
           <if test="baseAplyYn != null and baseAplyYn != '' ">
           , BASE_APLY_YN = #{baseAplyYn}               /* En vigueur O/N !== 기준적용여부 ==! */
           </if>
           <if test="aplyEndDt != null and aplyEndDt != '' ">
           , APLY_END_DT = NVL(                         /* Date De Fin De L'Application !== 적용종료일자 ==! */
                           (
                            SELECT APLY_END_DT FROM TB_RSMI_BASE_RQST_H X1
                            WHERE APRV_BSOP_TP_CD = 'E04' 
                            AND   BASE_RGSR_NO = #{baseRgsrNo}
                            AND   BASE_PRCS_STTS_CD = 'K01' 
                            AND   HIST_SRNO = (SELECT MAX(HIST_SRNO) FROM TB_RSMI_BASE_RQST_H X2 
                                               WHERE X2.APRV_BSOP_TP_CD = X1.APRV_BSOP_TP_CD 
                                               AND   X2.BASE_RGSR_NO = X1.BASE_RGSR_NO 
                                               AND   X2.BASE_PRCS_STTS_CD = X1.BASE_PRCS_STTS_CD)
                                   
                           ), (SELECT APLY_END_DT FROM TB_RSMI_BASE_MGMT_COMN X WHERE X.BASE_RGSR_NO = #{baseRgsrNo}))                       /* Date de fin de l'application !== 적용종료일자 ==! */
           </if>
        WHERE BASE_RGSR_NO = #{baseRgsrNo}              /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>
    
    <!--
    [Gestion du ciblage] Consulter les détails !== [선별관리] 상세조회 ==!
    -->
    <select id="selectBaseMgmtCom" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo" resultType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
        /* selectBaseMgmtCom */
        SELECT
              BASE_RGSR_NO                  /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , RQST_BASE_CLSF_CD             /* Code de classification du critère renseigné !== 신청기준분류코드 ==! */
            , APLY_BASE_CLSF_CD             /* Code de classification de critère en vigueur !== 적용기준분류코드 ==! */
            , BASE_RQST_TP_CD               /* Code de type de renseignement  !== 기준신청구분코드 ==! */
            , BASE_PRCS_STTS_CD             /* Code de statut de critère  !== 기준처리상태코드 ==! */
            , APRV_BSOP_TP_CD               /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/ 
            , APRV_ID                       /* ID d'approbation  !== 결재ID ==! */
            , BASE_APLY_YN                  /* En vigueur O/N !== 기준적용여부 ==! */
            , DCSH_TP_CD                    /* Code de type de déclaration !== 신고서구분코드 ==! */
            , BSOP_TP_CD                    /* Code de type de l'opération !== 업무구분코드 ==! */
            , APLY_STRT_DT                  /* Date de départ de l'application !== 적용시작일자 ==! */
            , APLY_END_DT                   /* Date de fin de l'application !== 적용종료일자 ==! */
            , (SELECT APLY_END_DT FROM TB_RSMI_BASE_RQST_H X 
               WHERE X.APRV_BSOP_TP_CD='E04' 
               AND   X.BASE_RGSR_NO=A.BASE_RGSR_NO 
               AND   X.BASE_PRCS_STTS_CD='K01' 
               AND   HIST_SRNO=(SELECT MAX(HIST_SRNO) FROM TB_RSMI_BASE_RQST_H Y WHERE Y.APRV_BSOP_TP_CD='E04' AND Y.BASE_RGSR_NO=A.BASE_RGSR_NO AND Y.BASE_PRCS_STTS_CD='K01')) AS XTNS_DT /** Nouvelle échéance !== 연장일자 ==!*/
            , APLY_CSTM_TP_CD               /* Code de type de bureau  !== 적용세관구분코드 ==! */
            , GRN_SELC_RT                   /* Taux de déclaration en circuit vert  !== 녹색선별율 ==! */
            , BLU_SELC_RT                   /* Taux de déclaration en circuit bleu  !== 파랑선별율 ==! */
            , ORE_SELC_RT                   /* Taux de ciblage vers le circuit orange !== 오렌지선별율 ==! */
            , RED_SELC_RT                   /* Taux de déclaration en circuit rouge !== 빨강선별율 ==! */
            , CO_WGVL_APLY_YN               /* Application du pondérateur d'opérateur O/N !== 업체가중치적용여부 ==! */
            , SELC_WGVL_APLY_YN             /* Pondérateur du critrèe général  !== 선별가중치적용여부 ==! */
            , APLY_PROR_RNK                 /* Priorité de l'application !== 적용우선순위 ==! */
            , BASE_DESC                     /* Description de critère !== 기준설명 ==! */
            , INSC_GDLN_CN                  /* Directives d'inspection  !== 검사지침내용 ==! */
            , RQST_RSN_CD                   /* Code de renseignement !== 신청사유코드 ==! */
            , RTRN_RSN_CN                   /* Motif De Rejet !== 반려 사유 내용 ==! */
            , OPRN_SQL_CN                   /* Requête du système en vigueur !== 운영SQL내용 ==! */ 
            , SMLT_SQL_CN                   /* Requête de la simulation !== 시뮬레이션SQL내용 ==! */
            , NVL(CHPN_ID,'') AS CHPN_ID    /* ID du responsable !== 담당자ID ==! */
            , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.CHPN_ID) AS CHPN_NM /** Charge !== 담당자 ==! */
            , RSK_INFO_NO                   /* Numéro de données sur les risques !== 위험정보번호 ==! */
            , RSK_FTOR_NO                   /* Numéro d'élément de risque !== 위험요소번호 ==! */
            , DLPY_BASE_AMT                 /* Montant critèredes arriérés !== 체납기준금액 ==! */
            , RNDM_GOAL_SELC_RT             /* Taux objectif (RA) !== 랜덤목표선별율 ==!  */
            , DEL_YN                        /* Suppression ON !== 삭제여부 ==! */
            , FRST_REGST_ID                                                /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM        /* Nom du premier enregistrant  !== 최초등록자이름 ==! */
            , FRST_RGSR_DTTM                                               /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , LAST_CHPR_ID                                                 /* ID du modificateur final !== 최종변경자ID ==! */
            , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM          /* Nom du modificateur final !== 최종변경자이름 ==! */
            , LAST_CHG_DTTM                                                /* Date et heure de modification finale !== 최종변경일시 ==! */
            , DECODE(A.ORBS_RGSR_NO, NULL, NULL, '', NULL, ( SELECT LISTAGG( AA.BASE_RGSR_NO||' ( '||TO_CHAR(AA.FRST_RGSR_DTTM, 'DD/MM/YYYY')||' ) ',',    ') WITHIN GROUP( ORDER BY AA.FRST_RGSR_DTTM DESC )
				                                           FROM   TB_RSMI_BASE_MGMT_COMN AA
        		                                           WHERE  AA.DEL_YN = 'N'
			                                               AND AA.BASE_RGSR_NO = A.ORBS_RGSR_NO
            		                                      )
             ) OPRN_MOCK_BASE_RGSR_NO
        FROM TB_RSMI_BASE_MGMT_COMN A
        WHERE 1 = 1
        AND BASE_RGSR_NO = #{baseRgsrNo}    /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </select>

    <!-- 
    [Gestion du ciblage] Appliquer / Désappliquer !== [선별관리] 적용 / 미적용 ==!
    -->
    <update id="updateBaseAplyYn" parameterType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
    /* updateBaseAplyYn */
    UPDATE TB_RSMI_BASE_MGMT_COMN
    SET    BASE_APLY_YN = #{baseAplyYn}    /* En vigueur O/N !== 기준적용여부 ==! */
         , LAST_CHPR_ID = #{lastChprId}    /* ID du modificateur final !== 최종변경자ID ==! */
         , LAST_CHG_DTTM = SYSTIMESTAMP    /* Date et heure de modification finale !== 최종변경일시 ==! */
    WHERE  BASE_RGSR_NO = #{baseRgsrNo}    /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!-- 
    [Pondérateur de sélectivité] Appliquer / Désappliquer !== [선별가중치관리] 적용 / 미적용 ==!
    -->
    <update id="updateCoWgvlAplyYn" parameterType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
    /* updateCoWgvlAplyYn */
    UPDATE TB_RSMI_BASE_MGMT_COMN
    SET    CO_WGVL_APLY_YN      = #{coWgvlAplyYn}       /** Application Du Pondérateur D'Opérateur O/N !== 업체가중치적용여부 ==! */
         , LAST_CHPR_ID         = #{lastChprId}         /* ID du modificateur final !== 최종변경자ID ==! */
         , LAST_CHG_DTTM        = SYSTIMESTAMP          /* Date et heure de modification finale !== 최종변경일시 ==! */
    WHERE  BASE_RGSR_NO         = #{baseRgsrNo}         /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
      [Pondérateur de sélectivité] Prolonger !== [선별가중치관리] 기간연장 ==!
    -->
    <update id="updateAplyDt" parameterType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
    /* updateAplyDt */
    UPDATE TB_RSMI_BASE_MGMT_COMN
    SET    APLY_STRT_DT         = #{aplyStrtDt}         /** Date De Début De L'Application !== 적용시작일자 ==! */
         , APLY_END_DT          = #{aplyEndDt}          /** Date De Fin De L'Application !== 적용종료일자 ==! */
         , LAST_CHPR_ID         = #{lastChprId}         /* ID du modificateur final !== 최종변경자ID ==! */
         , LAST_CHG_DTTM        = SYSTIMESTAMP          /* Date et heure de modification finale !== 최종변경일시 ==! */
    WHERE  BASE_RGSR_NO         = #{baseRgsrNo}         /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
    [Gestion du ciblage] Consulter la liste des critères de RULEBASE !== [선별관리] RULEBASE기준 목록 조회 ==!
    -->
    <select id="selectRlbsBaseList" parameterType="alpass.ipt.rsm.com.vo.RsmRlbsBaseVo" resultType="alpass.ipt.rsm.com.vo.RsmRlbsBaseVo">
        /* selectRlbsBaseList */
        SELECT
              A.TBL_NM                    /* Nom de la table !== 테이블명 ==! */
            , A.COL_NM                    /* Nom de la colonne !== 컬럼명 ==! */
            , CASE WHEN A.TBL_NM = 'TB_RSMI_ILST_BSCS' THEN 'RSMI_InList' 
                   WHEN A.TBL_NM = 'TB_RSMI_LBCR_PSNR_MGMT' THEN 'Gestion des voyageurs à risque' 
              ELSE (SELECT TBL_DESC FROM TB_RSMI_DCSH_TBL_MGMT WHERE TBL_NM=A.TBL_NM) END AS TBL_DESC   /** Description De Table !== 테이블설명 ==! */
            , CASE WHEN A.TBL_NM = 'TB_RSMI_ILST_BSCS' THEN (SELECT ILST_NM FROM TB_RSMI_ILST_BSCS WHERE ILST_NO=A.COL_NM)
                   WHEN A.TBL_NM = 'TB_RSMI_LBCR_PSNR_MGMT' THEN 'N° passeport'
              ELSE (SELECT COL_DESC FROM TB_RSMI_DCSH_COL_MGMT WHERE TBL_NM=A.TBL_NM AND COL_NM = A.COL_NM) END AS COL_DESC    /** Description De La Colonne  !== 컬럼설명 ==! */
            , CASE WHEN A.TBL_NM = 'TB_RSMI_ILST_BSCS' THEN '' 
                   WHEN A.TBL_NM = 'TB_RSMI_LBCR_PSNR_MGMT' THEN ''
              ELSE (SELECT RFER_CD FROM TB_RSMI_DCSH_COL_MGMT WHERE TBL_NM=A.TBL_NM AND COL_NM = A.COL_NM) END AS RFER_CD      /** Code De Référence  !== 참조코드 ==! */
            , CASE WHEN A.TBL_NM = 'TB_RSMI_ILST_BSCS' THEN 'INLIST' 
                   WHEN A.TBL_NM = 'TB_RSMI_LBCR_PSNR_MGMT' THEN 'PSNR' 
              ELSE (SELECT REFF_TP_CD FROM TB_RSMI_DCSH_COL_MGMT WHERE TBL_NM=A.TBL_NM AND COL_NM = A.COL_NM) END AS REFF_TP_CD     /** Code De Type De Référence !== 참조구분코드 ==! */
            , A.BASE_SRNO                 /* N° de séquence de la base !== 기준일련번호 ==! */
            , A.OPER_CD                   /* Code d'opérateur !== 연산자코드 ==! */
            , A.VAL                       /* Code SH saisi O/N !== 값 ==! */
            , NVL(A.VAL_DESC,'') AS VAL_DESC  /* Description de Valeur !== 값설명 ==! */
            , CASE WHEN A.TBL_NM = 'TB_RSMI_ILST_BSCS' THEN (SELECT DECODE(COUNT(X.ILST_NO),0,'N','Y') FROM 
                                                             TB_RSMI_ILST_BSCS X WHERE X.BASE_RQST_TP_CD='O' 
                                                             AND X.ILST_NO=A.COL_NM) ELSE 'Y' END AS OPRN_INLIST_YN /*  !== 운영 inList 여부 ==! */
        FROM TB_RSMI_RLBS_BASE A
           , (
                SELECT A.TBL_NM
                     , A.APLY_PROR_RNK AS TBL_RNK
                     , B.COL_NM
                     , B.APLY_PROR_RNK AS COL_RNK
                FROM TB_RSMI_DCSH_TBL_MGMT A
                   , TB_RSMI_DCSH_COL_MGMT B
                WHERE A.DEL_YN = 'N'
		        AND B.DEL_YN = 'N'
		        AND A.TBL_NM = B.TBL_NM
		        AND A.DCSH_TP_CD = ( SELECT DCSH_TP_CD
                                     FROM TB_RSMI_BASE_MGMT_COMN
                                     WHERE DEL_YN = 'N'
                                     AND BASE_RGSR_NO = #{baseRgsrNo}
                                   )
                ORDER BY TO_NUMBER(A.APLY_PROR_RNK) ASC , TO_NUMBER(B.APLY_PROR_RNK) ASC
             ) B
        WHERE 1 = 1
        AND A.BASE_RGSR_NO = #{baseRgsrNo}  /* Numéro d'enregistrement !== 기준등록번호 ==! */
        AND A.DEL_YN = 'N'                  /* Suppression ON !== 삭제여부 ==! */
        AND A.TBL_NM = B.TBL_NM(+)          /* Nom de la table !== 테이블명 ==! */
        AND A.COL_NM = B.COL_NM(+)          /* Nom de la colonne !== 컬럼명 ==! */
        ORDER BY TO_NUMBER(B.TBL_RNK) ASC, TO_NUMBER(B.COL_RNK) ASC
    </select>

    <!--
    [Gestion du ciblage] Enregistrer le critère de RULEBASE !== [선별관리] RULEBASE기준 등록 ==!
    -->
    <insert id="insertRlbsBase" parameterType="alpass.ipt.rsm.com.vo.RsmRlbsBaseVo">
        /* insertRlbsBase */
        INSERT INTO TB_RSMI_RLBS_BASE (
             BASE_RGSR_NO          /* Numéro d'enregistrement !== 기준등록번호 ==! */ 
           , TBL_NM                /* Nom de la table !== 테이블명 ==! */
           , COL_NM                /* Nom de la colonne !== 컬럼명 ==! */
           , BASE_SRNO             /* N° de séquence de la base !== 기준일련번호 ==! */
           , OPER_CD               /* Code d'opérateur !== 연산자코드 ==! */
           , VAL                   /* Code SH saisi O/N !== 값 ==! */
           , VAL_DESC              /* Description de Valeur !== 값설명 ==! */
           , DEL_YN                /* Suppression ON !== 삭제여부 ==! */ 
           , FRST_REGST_ID         /* ID du premier enregistrant  !== 최초등록자ID ==! */  
           , FRST_RGSR_DTTM        /* Date et heure de premier enregistrement !== 최초등록일시 ==! */ 
           , LAST_CHPR_ID          /* ID du modificateur final !== 최종변경자ID ==! */ 
           , LAST_CHG_DTTM         /* Date et heure de modification finale !== 최종변경일시 ==! */ 
        ) VALUES (
             #{baseRgsrNo}         /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , #{tblNm}              /* Nom de la table !== 테이블명 ==! */
           , #{colNm}              /* Nom de la colonne !== 컬럼명 ==! */
           , #{baseSrno}           /* N° de séquence de la base !== 기준일련번호 ==! */
           , #{operCd}             /* Code d'opérateur !== 연산자코드 ==! */
           , #{val}                /* Code SH saisi O/N !== 값 ==! */
           , #{valDesc}            /* Description de Valeur !== 값설명 ==! */
           , #{delYn}              /* Suppression ON !== 삭제여부 ==! */
           , #{frstRegstId}        /* ID du premier enregistrant  !== 최초등록자ID ==! */ 
           , SYSTIMESTAMP          /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
           , #{lastChprId}         /* ID du modificateur final !== 최종변경자ID ==! */
           , SYSTIMESTAMP          /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>

    <!--
      [Gestion du ciblage] Supprimer le critère de RULEBASE !== [선별관리] RULEBASE기준 삭제 ==!
    -->
    <delete id="deleteRlbsBase" parameterType="alpass.ipt.rsm.com.vo.RsmRlbsBaseVo">
        /* deleteRlbsBase */
        DELETE FROM TB_RSMI_RLBS_BASE
        WHERE BASE_RGSR_NO = #{baseRgsrNo}      /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </delete>

    <!--
      [Gestion du ciblage] Supprimer le critère de RULEBASE !== [선별관리] RULEBASE기준 삭제 ==!
    -->
    <update id="updateDelYnRlbsBase" parameterType="alpass.ipt.rsm.com.vo.RsmRlbsBaseVo">
        /* updateDelYnRlbsBase */
        UPDATE TB_RSMI_RLBS_BASE
        SET    DEL_YN           = 'Y'               /* Suppression ON !== 삭제여부 ==! */
             , LAST_CHPR_ID     = #{lastChprId}     /* ID du modificateur final !== 최종변경자ID ==! */
             , LAST_CHG_DTTM    = SYSTIMESTAMP      /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE  BASE_RGSR_NO = #{baseRgsrNo}         /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
      [Gestion du ciblage] Consulter la nature de la déclaration  !== [선별관리] 신고유형기준 조회 ==!
    -->
    <select id="selectRegmBaseList" parameterType="alpass.ipt.rsm.com.vo.RsmRegmBaseVo" resultType="alpass.ipt.rsm.com.vo.RsmRegmBaseVo">
        /* selectRegmBaseList */
        SELECT
              BASE_RGSR_NO                      /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , DCLR_PT_CD                        /* Code de type de déclaration !== 신고유형코드 ==! */
            , DEL_YN                            /* Suppression ON !== 삭제여부 ==! */
            , FRST_REGST_ID                     /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , FRST_RGSR_DTTM                    /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , LAST_CHPR_ID                      /* ID du modificateur final !== 최종변경자ID ==! */
            , LAST_CHG_DTTM                     /* Date et heure de modification finale !== 최종변경일시 ==! */
        FROM  TB_RSMI_DCLR_PT_BASE
        WHERE DEL_YN = 'N'                      /* Suppression ON !== 삭제여부 ==! */
        AND   BASE_RGSR_NO = #{baseRgsrNo}      /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </select>

    <!--
      [Gestion du ciblage] Supprimer la nature de la déclaration !== [선별관리] 신고유형기준 삭제 (물리삭제) ==!
    -->
    <delete id="deleteRegmBase" parameterType="alpass.ipt.rsm.com.vo.RsmRegmBaseVo">
        /* deleteRegmBase */
        DELETE FROM TB_RSMI_DCLR_PT_BASE
        WHERE  BASE_RGSR_NO = #{baseRgsrNo}      /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </delete>

    <!--
      [Gestion du ciblage] Supprimer la nature de la déclaration !== [선별관리] 신고유형기준 삭제 (논리삭제) ==!
    -->
    <update id="updateDelYnRegmBase" parameterType="alpass.ipt.rsm.com.vo.RsmRegmBaseVo">
        /* updateDelYnRegmBase */
        UPDATE TB_RSMI_DCLR_PT_BASE
        SET    DEL_YN           = 'Y'               /* Suppression ON !== 삭제여부 ==! */
             , LAST_CHPR_ID     = #{lastChprId}     /* ID du modificateur final !== 최종변경자ID ==! */
             , LAST_CHG_DTTM    = SYSTIMESTAMP      /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE  BASE_RGSR_NO = #{baseRgsrNo}         /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
      [Gestion du ciblage] Enregistrer la nature de la déclaration  !== [선별관리] 신고유형기준 등록 ==!
    -->
    <insert id="insertRegmBase" parameterType="alpass.ipt.rsm.com.vo.RsmRegmBaseVo">
        /* insertRegmBase */
        INSERT INTO TB_RSMI_DCLR_PT_BASE (
             BASE_RGSR_NO                       /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , DCLR_PT_CD                         /* Code de type de déclaration !== 신고유형코드 ==! */
           , DEL_YN                             /* Suppression ON !== 삭제여부 ==! */
           , FRST_REGST_ID                      /* ID du premier enregistrant  !== 최초등록자ID ==! */
           , FRST_RGSR_DTTM                     /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
           , LAST_CHPR_ID                       /* ID du modificateur final !== 최종변경자ID ==! */
           , LAST_CHG_DTTM                      /* Date et heure de modification finale !== 최종변경일시 ==! */
        ) VALUES (
             #{baseRgsrNo}                      /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , #{dclrPtCd}                        /* Code de type de déclaration !== 신고유형코드 ==! */
           , #{delYn}                           /* Suppression ON !== 삭제여부 ==! */
           , #{frstRegstId}                     /* ID du premier enregistrant  !== 최초등록자ID ==! */
           , SYSTIMESTAMP                       /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
           , #{lastChprId}                      /* ID du modificateur final !== 최종변경자ID ==! */
           , SYSTIMESTAMP                       /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>

    <!--
      [Gestion du ciblage] Consulter le bureau de douane sur lequel est appliqué le ciblage  !== [선별관리] 선별적용세관 조회 ==!
    -->
    <select id="selectSelcBaseAplyCstm" parameterType="alpass.ipt.rsm.com.vo.RsmSelcBaseAplyCstmVo" resultType="alpass.ipt.rsm.com.vo.RsmSelcBaseAplyCstmVo">
        /* selectSelcBaseAplyCstm */
        SELECT
              BASE_RGSR_NO                      /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , APLY_CSTM_BASE_CLSF_CD            /* Code de classification de critère par bureau !== 적용세관기준분류코드 ==! */
            , CSTM_CD                           /* Code du bureau !== 세관코드 ==! */
            , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE DEL_YN = 'N' AND ORGN_CD = A.CSTM_CD) AS CSTM_NM
            , SELC_RT                           /* Taux de ciblage !== 선별율 ==! */
            , DEL_YN                            /* Suppression ON !== 삭제여부 ==! */
            , FRST_REGST_ID                     /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , FRST_RGSR_DTTM                    /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , LAST_CHPR_ID                      /* ID du modificateur final !== 최종변경자ID ==! */
            , LAST_CHG_DTTM                     /* Date et heure de modification finale !== 최종변경일시 ==! */
        FROM  TB_RSMI_SELC_BASE_APLY_CSTM A
        WHERE DEL_YN = 'N'                      /* Suppression ON !== 삭제여부 ==! */
        AND   BASE_RGSR_NO = #{baseRgsrNo}      /* Numéro d'enregistrement !== 기준등록번호 ==! */
        <if test='aplyCstmBaseClsfCd != null and !"".equals(aplyCstmBaseClsfCd)'>
        AND   APLY_CSTM_BASE_CLSF_CD = #{aplyCstmBaseClsfCd}        /* Code de classification de critère par bureau !== 적용세관기준분류코드 ==! */
        </if>
    </select>

    <!--
      [Gestion du ciblage] Enregistrer le bureau de douane sur lequel est appliqué le ciblage  !== [선별관리] 선별적용세관 등록 ==!
    -->
    <insert id="insertSelcBaseAplyCstm" parameterType="alpass.ipt.rsm.com.vo.RsmSelcBaseAplyCstmVo">
        /* insertSelcBaseAplyCstm */
        INSERT INTO TB_RSMI_SELC_BASE_APLY_CSTM (
             BASE_RGSR_NO                       /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , APLY_CSTM_BASE_CLSF_CD             /* Code de classification de critère par bureau !== 적용세관기준분류코드 ==! */
           , CSTM_CD                            /* Code du bureau !== 세관코드 ==! */
           , SELC_RT                            /* Taux de ciblage !== 선별율 ==! */
           , DEL_YN                             /* Suppression ON !== 삭제여부 ==! */
           , FRST_REGST_ID                      /* ID du premier enregistrant  !== 최초등록자ID ==! */
           , FRST_RGSR_DTTM                     /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
           , LAST_CHPR_ID                       /* ID du modificateur final !== 최종변경자ID ==! */
           , LAST_CHG_DTTM                      /* Date et heure de modification finale !== 최종변경일시 ==! */
        ) VALUES (
             #{baseRgsrNo}                      /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , #{aplyCstmBaseClsfCd}              /* Code de classification de critère par bureau !== 적용세관기준분류코드 ==! */
           , #{cstmCd}                          /* Code du bureau !== 세관코드 ==! */
           , #{selcRt}                          /* Taux de ciblage !== 선별율 ==! */
           , #{delYn}                           /* Suppression ON !== 삭제여부 ==! */
           , #{frstRegstId}                     /* ID du premier enregistrant  !== 최초등록자ID ==! */
           , SYSTIMESTAMP                       /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
           , #{lastChprId}                      /* ID du modificateur final !== 최종변경자ID ==! */
           , SYSTIMESTAMP                       /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>

    <!--
      [Gestion du ciblage] Supprimer le bureau de douane sur lequel est appliqué le ciblage  !== [선별관리] 선별적용세관 삭제 ==!
    -->
    <delete id="deleteSelcBaseAplyCstm" parameterType="alpass.ipt.rsm.com.vo.RsmSelcBaseAplyCstmVo">
        /* deleteSelcBaseAplyCstm */
        DELETE FROM TB_RSMI_SELC_BASE_APLY_CSTM
        WHERE BASE_RGSR_NO = #{baseRgsrNo}      /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </delete>

    <!--
      [Gestion du ciblage] Supprimer le bureau de douane sur lequel est appliqué le ciblage  !== [선별관리] 선별적용세관 삭제 ==!
    -->
    <update id="updateDelYnSelcBaseAplyCstm" parameterType="alpass.ipt.rsm.com.vo.RsmSelcBaseAplyCstmVo">
        /* updateDelYnSelcBaseAplyCstm */
        UPDATE TB_RSMI_SELC_BASE_APLY_CSTM
        SET    DEL_YN           = 'Y'               /* Suppression ON !== 삭제여부 ==! */
             , LAST_CHPR_ID     = #{lastChprId}     /* ID du modificateur final !== 최종변경자ID ==! */
             , LAST_CHG_DTTM    = SYSTIMESTAMP      /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE  BASE_RGSR_NO = #{baseRgsrNo}         /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
      [Gestion du ciblage] Consulter l'élément de détection !== [선별관리] 적발항목 조회 ==!
    -->
    <select id="selectSelcRskFtorBaseList" parameterType="alpass.ipt.rsm.com.vo.RsmRskFtorBaseVo" resultType="alpass.ipt.rsm.com.vo.RsmRskFtorBaseVo">
        /* selectSelcRskFtorBaseList */
        SELECT
              BASE_RGSR_NO                  /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , CLUS_CLSF_CD                  /* Code de classification d'élément de détection !== 적발항목분류코드 ==! */
            , DEL_YN                        /* Suppression ON !== 삭제여부 ==! */
            , FRST_REGST_ID                 /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , FRST_RGSR_DTTM                /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , LAST_CHPR_ID                  /* ID du modificateur final !== 최종변경자ID ==! */
            , LAST_CHG_DTTM                 /* Date et heure de modification finale !== 최종변경일시 ==! */
        FROM TB_RSMI_DSCL_CLUS_BASE
        WHERE 1 = 1
        AND BASE_RGSR_NO = #{baseRgsrNo}    /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </select>

    <!--
      [Gestion du ciblage] Supprimer l'élément de détection !== [선별관리] 적발항목 삭제 ==!
    -->
    <delete id="deleteRskFtorBase" parameterType="alpass.ipt.rsm.com.vo.RsmRskFtorBaseVo">
        /* deleteRskFtorBase */
        DELETE FROM TB_RSMI_DSCL_CLUS_BASE
        WHERE BASE_RGSR_NO = #{baseRgsrNo}    /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </delete>

    <!--
      [Gestion du ciblage] Supprimer l'élément de détection !== [선별관리] 적발항목 삭제 ==!
    -->
    <update id="updateDelYnRskFtorBase" parameterType="alpass.ipt.rsm.com.vo.RsmRskFtorBaseVo">
        /* updateDelYnRskFtorBase */
        UPDATE TB_RSMI_DSCL_CLUS_BASE
        SET    DEL_YN           = 'Y'               /* Suppression ON !== 삭제여부 ==! */
             , LAST_CHPR_ID     = #{lastChprId}     /* ID du modificateur final !== 최종변경자ID ==! */
             , LAST_CHG_DTTM    = SYSTIMESTAMP      /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE BASE_RGSR_NO = #{baseRgsrNo}          /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!--
      [Gestion du ciblage] Enregistrer l'élément de détection !== [선별관리] 적발항목 등록 ==!
    -->
    <insert id="insertRskFtorBase" parameterType="alpass.ipt.rsm.com.vo.RsmRskFtorBaseVo">
        /* insertRskFtorBase */
        INSERT INTO TB_RSMI_DSCL_CLUS_BASE (
             BASE_RGSR_NO             /* Numéro d'enregistrement !== 기준등록번호 ==! */ 
           , CLUS_CLSF_CD             /* Code de classification d'élément de détection !== 적발항목분류코드 ==! */
           , DEL_YN                   /* Suppression ON !== 삭제여부 ==! */ 
           , FRST_REGST_ID            /* ID du premier enregistrant  !== 최초등록자ID ==! */ 
           , FRST_RGSR_DTTM           /* Date et heure de premier enregistrement !== 최초등록일시 ==! */ 
           , LAST_CHPR_ID             /* ID du modificateur final !== 최종변경자ID ==! */  
           , LAST_CHG_DTTM            /* Date et heure de modification finale !== 최종변경일시 ==! */ 
        ) VALUES (
             #{baseRgsrNo}            /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , #{clusClsfCd}            /* Code de classification d'élément de détection !== 적발항목분류코드 ==! */
           , #{delYn}                 /* Suppression ON !== 삭제여부 ==! */
           , #{frstRegstId}           /* ID du premier enregistrant  !== 최초등록자ID ==! */
           , SYSTIMESTAMP             /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
           , #{lastChprId}            /* ID du modificateur final !== 최종변경자ID ==! */
           , SYSTIMESTAMP             /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>

    <!-- 
      [Gestion du ciblage] Consulter le critère de programme !== [선별관리] 프로그램기준 조회 ==!
    -->
    <select id="selectPrgmBase" parameterType="alpass.ipt.rsm.com.vo.RsmPrgmBaseVo" resultType="alpass.ipt.rsm.com.vo.RsmPrgmBaseVo">
        /* selectPrgmBase */
        SELECT
              BASE_RGSR_NO         /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , PRGM_TP_CD           /* Code de type de programme !== 프로그램구분코드 ==! */
            , DEL_YN               /* Suppression ON !== 삭제여부 ==! */
            , FRST_REGST_ID        /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , FRST_RGSR_DTTM       /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , LAST_CHPR_ID         /* ID du modificateur final !== 최종변경자ID ==! */
            , LAST_CHG_DTTM        /* Date et heure de modification finale !== 최종변경일시 ==! */
        FROM TB_RSMI_PRGM_BASE
        WHERE 1 = 1
        AND BASE_RGSR_NO = #{baseRgsrNo}   /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </select>

    <!-- 
      [Gestion du ciblage] Enregistrer le critère de programme !== [선별관리] 프로그램기준 등록 ==!
    -->
    <insert id="insertPrgmBase" parameterType="alpass.ipt.rsm.com.vo.RsmPrgmBaseVo">
        /* insertPrgmBase */
        INSERT INTO TB_RSMI_PRGM_BASE (
             BASE_RGSR_NO         /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , PRGM_TP_CD           /* Code de type de programme !== 프로그램구분코드 ==! */ 
           , DEL_YN               /* Suppression ON !== 삭제여부 ==! */ 
           , FRST_REGST_ID        /* ID du premier enregistrant  !== 최초등록자ID ==! */  
           , FRST_RGSR_DTTM       /* Date et heure de premier enregistrement !== 최초등록일시 ==! */ 
           , LAST_CHPR_ID         /* ID du modificateur final !== 최종변경자ID ==! */
           , LAST_CHG_DTTM        /* Date et heure de modification finale !== 최종변경일시 ==! */ 
        ) VALUES (
             #{baseRgsrNo}        /* Numéro d'enregistrement !== 기준등록번호 ==! */
           , #{prgmTpCd}          /* Code de type de programme !== 프로그램구분코드 ==! */
           , #{delYn}             /* Suppression ON !== 삭제여부 ==! */
           , #{frstRegstId}       /* ID du premier enregistrant  !== 최초등록자ID ==! */
           , SYSTIMESTAMP         /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
           , #{lastChprId}        /* ID du modificateur final !== 최종변경자ID ==! */
           , SYSTIMESTAMP         /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>

    <!-- 
      [Gestion du ciblage] Modifier le critère de programme !== [선별관리] 프로그램기준 수정 ==!
    -->
    <update id="updatePrgmBase" parameterType="alpass.ipt.rsm.com.vo.RsmPrgmBaseVo">
        /* updatePrgmBase */
        UPDATE TB_RSMI_PRGM_BASE SET
             PRGM_TP_CD = #{prgmTpCd}             /* Code de type de programme !== 프로그램구분코드 ==! */
           , LAST_CHPR_ID = #{lastChprId}         /* ID du modificateur final !== 최종변경자ID ==! */
           , LAST_CHG_DTTM = SYSTIMESTAMP         /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE 1 = 1
        AND BASE_RGSR_NO = #{baseRgsrNo}          /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>

    <!-- 
      [Gestion du ciblage] Supprimer le critère de programme !== [선별관리] 프로그램기준 삭제 ==!
    -->
    <delete id="deletePrgmBase" parameterType="alpass.ipt.rsm.com.vo.RsmPrgmBaseVo">
        /* deletePrgmBase */
        DELETE FROM TB_RSMI_PRGM_BASE
        WHERE BASE_RGSR_NO = #{baseRgsrNo}        /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </delete>

    <!-- 
      [Gestion du ciblage] Enregistrer l'historique de traitement d'un critère !== [선별관리] 기준신청이력 등록 ==!
    -->
    <insert id="insertBaseRqstH" parameterType="alpass.ipt.rsm.com.vo.RsmBaseRqstHVo">
        /* insertBaseRqstH */
        INSERT INTO TB_RSMI_BASE_RQST_H (
          BASE_RGSR_NO                    /* Numéro d'enregistrement !== 기준등록번호 ==! */
        , HIST_SRNO                       /* N° de séquence de l'histoire  !== 이력일련번호 ==! */
        , APRV_BSOP_TP_CD                 /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
        , APRV_ID                         /* ID d'approbation  !== 결재ID ==! */
        , BASE_PRCS_STTS_CD               /* Code de statut de critère  !== 기준처리상태코드 ==! */
        , APLY_STRT_DT                    /* Date de départ de l'application !== 적용시작일자 ==! */
        , APLY_END_DT                     /* Date de fin de l'application !== 적용종료일자 ==! */
        , PRCS_OPIN_CN                    /* Avis du chef  !== 처리의견내용 ==! */
        , DEL_YN                          /* Suppression ON !== 삭제여부 ==! */
        , FRST_REGST_ID                   /* ID du premier enregistrant  !== 최초등록자ID ==! */
        , FRST_RGSR_DTTM                  /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
        , LAST_CHPR_ID                    /* ID du modificateur final !== 최종변경자ID ==! */
        , LAST_CHG_DTTM                   /* Date et heure de modification finale !== 최종변경일시 ==! */
        ) VALUES (
          #{baseRgsrNo}                   /* Numéro d'enregistrement !== 기준등록번호 ==! */
        , (SELECT NVL(MAX(HIST_SRNO)+1,1) FROM TB_RSMI_BASE_RQST_H WHERE BASE_RGSR_NO = #{baseRgsrNo})        /* N° de séquence de l'histoire  !== 이력일련번호 ==! */
        , #{aprvBsopTpCd}                 /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
        , #{aprvId}                       /* ID d'approbation  !== 결재ID ==! */
        , #{basePrcsSttsCd}               /* Code de statut de critère  !== 기준처리상태코드 ==! */
        , (SELECT APLY_STRT_DT FROM TB_RSMI_BASE_MGMT_COMN WHERE BASE_RGSR_NO = #{baseRgsrNo})                 /* Date de départ de l'application !== 적용시작일자 ==! */

        <if test="xtnsDt != null and xtnsDt != '' and aprvBsopTpCd != null and aprvBsopTpCd == 'E04' and aprvPrcsSttsCd != null and aprvPrcsSttsCd == 'I01'">
            , #{xtnsDt}
        </if>
        <if test="aprvPrcsSttsCd != 'I01' or aprvBsopTpCd != 'E04' or xtnsDt == null or xtnsDt == '' ">
            , (SELECT APLY_END_DT FROM TB_RSMI_BASE_MGMT_COMN WHERE BASE_RGSR_NO = #{baseRgsrNo})                  /* Date de fin de l'application !== 적용종료일자 ==! */
        </if>


        <if test="aprvPrcsSttsCd != null and aprvPrcsSttsCd == 'I01' ">
            , NVL((SELECT APRV_RQST_CN FROM TB_POTI_APRV WHERE APRV_ID = #{aprvId} AND APRV_RQST_EMP_PBSR_NO = #{frstRegstId}),'-')                         /* Avis du chef  !== 처리의견내용 ==! */
        </if>
        <if test="aprvPrcsSttsCd != null and aprvPrcsSttsCd != 'I01' ">
            , NVL((SELECT APRV_OPIN_CN FROM TB_POTI_APRV_D WHERE APRV_ID = #{aprvId} AND APRV_EMP_PBSR_NO = #{frstRegstId}),'-')                            /* Avis du chef  !== 처리의견내용 ==! */
        </if>


        , 'N'                           /* Suppression ON !== 삭제여부 ==! */
        , #{frstRegstId}                /* ID du premier enregistrant  !== 최초등록자ID ==! */
        , SYSTIMESTAMP                  /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
        , #{lastChprId}                 /* ID du modificateur final !== 최종변경자ID ==! */
        , SYSTIMESTAMP                  /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>

    <!-- 
      [Gestion du ciblage] Supprimer le critère de programme !== [선별관리] 프로그램기준 삭제 ==!
    -->
    <update id="updateDelYnPrgmBase" parameterType="alpass.ipt.rsm.com.vo.RsmPrgmBaseVo">
        /* updateDelYnPrgmBase */
        UPDATE TB_RSMI_PRGM_BASE
        SET    DEL_YN           = 'Y'               /* Suppression ON !== 삭제여부 ==! */
             , LAST_CHPR_ID     = #{lastChprId}     /* ID du modificateur final !== 최종변경자ID ==! */
             , LAST_CHG_DTTM    = SYSTIMESTAMP      /* Date et heure de modification finale !== 최종변경일시 ==! */
        WHERE  BASE_RGSR_NO = #{baseRgsrNo}         /* Numéro d'enregistrement !== 기준등록번호 ==! */
    </update>
    <!--         AND A.APRV_BSOP_TP_CD = #{aprvBsopTpCd}         /* Code de catégorie de l'opération d'approbation (Prolonger la durée de validité)  !== 결재업무구분코드 (기준기간연장)  ==!*/ -->
<!--         AND A.BASE_PRCS_STTS_CD = #{basePrcsSttsCd}     /* Code de statut de critère (Enregistré(e))  !== 처리상태코드 (등록) ==! */ -->

    <!-- 
     [Pop-up prolonger] Consulter l'historique
     !== [기간연장 팝업] 이력조회 ==!
    -->
    <select id="selectBaseRqstHList" parameterType="alpass.ipt.rsm.com.vo.RsmBaseRqstHVo" resultType="alpass.ipt.rsm.com.vo.RsmBaseRqstHVo">
        /* selectBaseRqstHList */
        SELECT
              A.BASE_RGSR_NO                    /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , B.BASE_PRCS_STTS_CD               /* Code de statut de critère  !== 처리상태코드 ==! */
            , B.BASE_APLY_YN                    /* En vigueur O/N !== 기준적용여부 ==! */
            , B.FRST_REGST_ID AS REGST_ID       /* Enregistré(e) par !== 등록자 ==! */
            , B.FRST_RGSR_DTTM AS RGSR_DTTM     /* Moment d'enregistrement !== 등록일시 ==! */
            , A.HIST_SRNO                       /* N° de séquence de l'histoire  !== 이력일련번호 ==! */
            , A.APRV_BSOP_TP_CD                 /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
            , A.APRV_ID                         /* ID d'approbation  !== 결재ID ==! */
            , A.BASE_PRCS_STTS_CD AS PRCS_STTS_CD               /* Code de statut de critère  !== 처리상태코드 ==! */
            , A.APLY_STRT_DT                    /* Date de départ de l'application !== 적용시작일자 ==! */
            , A.APLY_END_DT                     /* Date de fin de l'application !== 적용종료일자 ==! */
            , A.PRCS_OPIN_CN                    /* Avis du chef  !== 처리의견내용 ==! */
            , A.DEL_YN                          /* Suppression ON !== 삭제여부 ==! */
            , A.FRST_REGST_ID                                                /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM        /* Nom du premier enregistrant  !== 최초등록자이름 ==! */
            , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY HH24:mi:ss') AS FRST_RGSR_DTTM                     /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , A.LAST_CHPR_ID                                                 /* ID du modificateur final !== 최종변경자ID ==! */
            , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM          /* Nom du modificateur final !== 최종변경자이름 ==! */
            , A.LAST_CHG_DTTM                                                /* Date et heure de modification finale !== 최종변경일시 ==! */
        FROM TB_RSMI_BASE_RQST_H A, TB_RSMI_BASE_MGMT_COMN B
        WHERE 1 = 1
        AND A.BASE_RGSR_NO = B.BASE_RGSR_NO
        AND B.BASE_RGSR_NO = #{baseRgsrNo}   /* Numéro d'enregistrement !== 기준등록번호 ==! */
        AND A.DEL_YN = 'N'                   /* Suppression ON !== 삭제여부 ==! */

        <if test='(aprvBsopTpCd != null and !"".equals(aprvBsopTpCd)) and (basePrcsSttsCd != null and !"".equals(basePrcsSttsCd))'>
        AND EXISTS (
            SELECT
                  *
            FROM  TB_RSMI_BASE_RQST_H S
            WHERE S.BASE_RGSR_NO = #{baseRgsrNo}
            AND   S.HIST_SRNO = (
                      SELECT MAX(HIST_SRNO) FROM TB_RSMI_BASE_RQST_H WHERE BASE_RGSR_NO = #{baseRgsrNo} AND DEL_YN = 'N'
                  )
            AND   S.APRV_BSOP_TP_CD = #{aprvBsopTpCd}
            AND   S.BASE_PRCS_STTS_CD = #{basePrcsSttsCd}
            AND   A.HIST_SRNO = S.HIST_SRNO
        )
        </if>
        ORDER BY A.HIST_SRNO ASC

    </select>

    <!-- 
      [Gestion du ciblage] Enregistrer l'historique de traitement d'un critère !== [선별관리] 기준처리 이력 등록 ==!
    -->
    <insert id="insertBaseRqstH2" parameterType="alpass.ipt.rsm.com.vo.RsmBaseRqstHVo">
        /* insertBaseRqstH */
        INSERT INTO TB_RSMI_BASE_RQST_H (
            BASE_RGSR_NO                      /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , HIST_SRNO                       /* N° de séquence de l'histoire  !== 이력일련번호 ==! */
            , APRV_BSOP_TP_CD                 /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
            , APRV_ID                         /* ID d'approbation  !== 결재ID ==! */
            , BASE_PRCS_STTS_CD               /* Code de statut de critère  !== 기준처리상태코드 ==! */
            , APLY_STRT_DT                    /* Date de départ de l'application !== 적용시작일자 ==! */
            , APLY_END_DT                     /* Date de fin de l'application !== 적용종료일자 ==! */
            , PRCS_OPIN_CN                    /* Avis du chef  !== 처리의견내용 ==! */
            , DEL_YN                          /* Suppression ON !== 삭제여부 ==! */ 
            , FRST_REGST_ID                   /* ID du premier enregistrant  !== 최초등록자ID ==! */  
            , FRST_RGSR_DTTM                  /* Date et heure de premier enregistrement !== 최초등록일시 ==! */ 
            , LAST_CHPR_ID                    /* ID du modificateur final !== 최종변경자ID ==! */
            , LAST_CHG_DTTM                   /* Date et heure de modification finale !== 최종변경일시 ==! */
        ) VALUES (
            #{baseRgsrNo}                     /* Numéro d'enregistrement !== 기준등록번호 ==! */
            , (SELECT NVL(MAX(HIST_SRNO)+1,1) FROM TB_RSMI_BASE_RQST_H WHERE BASE_RGSR_NO = #{baseRgsrNo})        /* N° de séquence de l'histoire  !== 이력일련번호 ==! */
            , #{aprvBsopTpCd}                 /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
            , #{aprvId}                       /* ID d'approbation  !== 결재ID ==! */
            , #{basePrcsSttsCd}               /* Code de statut de critère  !== 기준처리상태코드 ==! */
            , #{aplyStrtDt}                   /* Date de départ de l'application !== 적용시작일자 ==! */
            , #{aplyEndDt}                    /* Date de fin de l'application !== 적용종료일자 ==! */

            <choose>
                <when test='prcsOpinCn != null and !"".equals(prcsOpinCn)'>
            , #{prcsOpinCn}
                </when>
                <otherwise>
                    <if test="aprvPrcsSttsCd != null and aprvPrcsSttsCd == 'I01' ">
            , NVL((SELECT APRV_RQST_CN FROM TB_POTI_APRV WHERE APRV_ID = #{aprvId} AND APRV_RQST_EMP_PBSR_NO = #{frstRegstId}),'-')                         /* Avis du chef  !== 처리의견내용 ==! */  
                    </if>
                    <if test="aprvPrcsSttsCd != null and aprvPrcsSttsCd != 'I01' ">
            , NVL((SELECT APRV_OPIN_CN FROM TB_POTI_APRV_D WHERE APRV_ID = #{aprvId} AND APRV_EMP_PBSR_NO = #{frstRegstId}),'-')                            /* Avis du chef  !== 처리의견내용 ==! */  
                    </if>
                </otherwise>
            </choose>

            , 'N'                           /* Suppression ON !== 삭제여부 ==! */
            , #{frstRegstId}                /* ID du premier enregistrant  !== 최초등록자ID ==! */
            , SYSTIMESTAMP                  /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
            , #{lastChprId}                 /* ID du modificateur final !== 최종변경자ID ==! */
            , SYSTIMESTAMP                  /* Date et heure de modification finale !== 최종변경일시 ==! */
        )
    </insert>

    <!-- 
    [Gestion du ciblage] Supprimer l'historique de traitement d'un critère !== [선별관리] 기준처리 이력 삭제 ==!
    -->
    <update id="deleteBaseRqstH" parameterType="alpass.ipt.rsm.com.vo.RsmBaseRqstHVo">
        /* deleteBaseRqstH */
        UPDATE TB_RSMI_BASE_RQST_H
        SET    DEL_YN = 'Y'                     /* Suppression ON !== 삭제여부 ==! */
        WHERE  BASE_RGSR_NO = #{baseRgsrNo}     /* Numéro d'enregistrement !== 기준등록번호 ==! */
        AND    HIST_SRNO = #{histSrno}          /* N° de séquence de l'histoire  !== 이력일련번호 ==! */
    </update>

    <!-- 
    [Code de résultat d'approbation] Consulter !== [결재결과코드] 조회 ==!
    -->
    <select id="selectLastAprvRsltCd" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo" resultType="java.lang.String">
        /* selectLastAprvRsltCd */
        SELECT 
             APRV_RSLT_CD                       /** Code De Résultat D'Approbation !== 결재결과코드 ==! */
        FROM TB_POTI_APRV_D A
        WHERE A.APRV_ID = #{aprvId}             /** Id D'Approbation  !== 결재ID ==! */
        AND APRV_SRNO = ( SELECT MAX(APRV_SRNO)             /** N° De Série De L'Approbation !== 결재일련번호 ==! */
                          FROM TB_POTI_APRV_D X
                          WHERE X.APRV_ID = A.APRV_ID
                        )
    </select>

    <!--  
      [Critères renseignés en attente d'approbation] Consulter la liste des personnes chargées du ciblage de la gestion des risques !== [기준사용 상신관리] RM선별담당자 목록조회 ==!
    -->
    <select id="selectRoleUserList" resultType="alpass.ipt.rsm.com.vo.RsmItemInfVo" >
        /* selectRoleUserList */
        SELECT
            USER_ID AS ITEM,                    /** item !== 아이템 ==! */
            (SELECT EMP_NM FROM TB_POTI_EMP X WHERE X.PBSR_NO=USER_ID) AS ITEM_NM           /** Nom de item  !== 아이템명 ==! */
        FROM
            (SELECT
                A.PBSR_NO AS USER_ID,
                B.ROLE_ID AS AUTHORITY 
            FROM
                TB_POTI_EMP A,
                TB_POTI_ORGN_ROLE_REL B 
            WHERE
                A.ORGN_MGMT_CD = B.ORGN_MGMT_CD 
            UNION
            SELECT
                PBSR_NO AS USER_ID,
                ROLE_ID AS AUTHORITY 
            FROM
                VW_POTI_ROLE_UNFC
        ) 
        WHERE AUTHORITY IN ('RSM002')
    </select>
    
    <!--
     Charger un ID de la boîte aux lettres 
     !== 사서함 ID 가져오기 ==!
    -->
    <select id="selectPobxId" parameterType="java.lang.String" resultType="java.lang.String">
        /** selectPobxId */
        SELECT MAX(CNTT_POBX_ID) AS POBX_ID     /** Id De La Boîte Aux Lettres !== 사서함ID ==! */
          FROM TB_POTE_POBX A
         WHERE CNTT_IDFY_CD = #{cnttIdfyCd}     /** Code De Catégorie D'Acteur De Transfert !== 연계식별코드 ==! */
           AND POBX_USG_TP_CD = '02'            /** Catégorie D'Utilisation De Boîte Aux Lettres !== 사서함용도구분코드 ==! */
           AND DEL_YN = 'N'
    </select>    
    
    <!--
    On voit les informations sur 'paramètres' 
    !== 파라미터 값 조회 ==!
    -->
    <select id="selectPrmtValue" parameterType="java.lang.String" resultType="java.lang.String">
        /* selectPrmtValue */
        SELECT PRMT_VAL_CN                      /** Contenu De La Valeur Du Paramètre !== 파라미터값내용 ==! */
          FROM TB_COM_PRMT
         WHERE PRMT_ID = #{prmtId}              /** Id Du Paramètre !== 파라미터ID ==! */
           AND DEL_YN = 'N' 
           AND ROWNUM = 1
    </select>    

    <!--
     [Vérifier un critère redondant] Rechercher !== [중복기준확인] 조회 ==!
    -->
    <select id="selectDupcBaseCfrm" parameterType="java.lang.String" resultType="alpass.ipt.rsm.com.vo.RsmRlbsBaseVo">
    	/* selectDupcBaseCfrm */
		SELECT A.BASE_RGSR_NO, A.COL_NM
		FROM (
			SELECT BB.BASE_RGSR_NO
			     , LISTAGG(BB.COL_NM, ',') WITHIN GROUP (ORDER BY BB.BASE_RGSR_NO, BB.COL_NM) AS COL_NM
			FROM   TB_RSMI_BASE_MGMT_COMN AA
			    ,  TB_RSMI_RLBS_BASE BB
			WHERE  AA.DEL_YN = 'N'
			and    AA.RQST_BASE_CLSF_CD in ('MA','HR')
			AND    AA.BASE_RGSR_NO != #{baseRgsrNo}
			AND    BB.BASE_RGSR_NO = AA.BASE_RGSR_NO
			AND    BB.DEL_YN = 'N'
			GROUP BY BB.BASE_RGSR_NO
		) A
		, (
			SELECT DD.BASE_RGSR_NO
			     , LISTAGG(DD.COL_NM, ',') WITHIN GROUP (ORDER BY DD.BASE_RGSR_NO, DD.COL_NM) AS COL_NM
			FROM   TB_RSMI_BASE_MGMT_COMN CC
			    ,  TB_RSMI_RLBS_BASE DD
			WHERE  CC.DEL_YN = 'N'
			AND    CC.BASE_RGSR_NO = #{baseRgsrNo}
			AND    DD.BASE_RGSR_NO = CC.BASE_RGSR_NO
			AND    DD.DEL_YN = 'N'
			GROUP BY DD.BASE_RGSR_NO
		) B
		WHERE  A.COL_NM = B.COL_NM

    </select>

    <!--
      [Vérifier un critère redondant] Consulter la liste !== [중복기준조회] 목록조회 ==!
    --> 
    <select id="selectDupcBaseCfrmList" parameterType="alpass.ipt.rsm.selc.vo.RsmSelcBaseComnVo" resultType="alpass.ipt.rsm.com.vo.RsmBaseMgmtComnVo">
        /* selectDupcBaseCfrmList */
        <include refid="pagination.header"/>
        SELECT ROWNUM NO
             , BASE_RGSR_NO                                                 /* Numéro d'enregistrement !== 기준등록번호 ==! */
             , RQST_BASE_CLSF_CD                                            /* Code de classification du critère renseigné !== 신청기준분류코드 ==! */
             , APLY_BASE_CLSF_CD                                            /* Code de classification de critère en vigueur !== 적용기준분류코드 ==! */
             , BASE_RQST_TP_CD                                              /* Code de type de renseignement  !== 기준신청구분코드 ==! */
             , BASE_PRCS_STTS_CD                                            /* Code de statut de critère  !== 기준처리상태코드 ==! */
             , APRV_BSOP_TP_CD                                              /* Code de catégorie de l'opération d'approbation  !== 결재업무구분코드  ==!*/
             , APRV_ID                                                      /* ID d'approbation  !== 결재ID ==! */
             , (SELECT TO_CHAR(APRV_PRCS_DTTM, 'DD/MM/YYYY') AS APRV_PRCS_DTTM FROM TB_POTI_APRV_D X
                WHERE APRV_ID = A.APRV_ID 
                AND APRV_SRNO = (SELECT MAX(APRV_SRNO) FROM TB_POTI_APRV_D Y WHERE Y.APRV_ID = X.APRV_ID) 
                AND APRV_RSLT_CD = 'J01') AS APRE_DT                        /* Date d'autorisation !== 승인일자 ==!*/
             , BASE_APLY_YN                                                 /* En vigueur O/N !== 기준적용여부 ==! */
             , DCSH_TP_CD                                                   /* Code de type de déclaration !== 신고서구분코드 ==! */
             , BSOP_TP_CD                                                   /* Code de type de l'opération !== 업무구분코드 ==! */
             , APLY_STRT_DT                                                 /* Date de départ de l'application !== 적용시작일자 ==! */
             , APLY_END_DT                                                  /* Date de fin de l'application !== 적용종료일자 ==! */
             , TO_CHAR(TO_DATE(A.APLY_STRT_DT, 'YYYYMMDD'),'DD/MM/YYYY')||'~'||TO_CHAR(TO_DATE(A.APLY_END_DT, 'YYYYMMDD'),'DD/MM/YYYY') AS APLY_DT
             , (SELECT LISTAGG(DCLR_PT_CD, ',') WITHIN GROUP (ORDER BY DCLR_PT_CD) FROM TB_RSMI_DCLR_PT_BASE WHERE BASE_RGSR_NO=A.BASE_RGSR_NO) AS DCLR_PT_CD      /* Code de type de déclaration !== 신고유형코드 ==! */
             , APLY_CSTM_TP_CD                                              /* Code de type de bureau  !== 적용세관구분코드 ==! */
             , GRN_SELC_RT                                                  /* Taux de déclaration en circuit vert  !== 녹색선별율 ==! */
             , BLU_SELC_RT                                                  /* Taux de déclaration en circuit bleu  !== 파랑선별율 ==! */
             , ORE_SELC_RT                                                  /* Taux de ciblage vers le circuit orange !== 오렌지선별율 ==! */
             , RED_SELC_RT                                                  /* Taux de déclaration en circuit rouge !== 빨강선별율 ==! */
             , CO_WGVL_APLY_YN                                              /* Application du pondérateur d'opérateur O/N !== 업체가중치적용여부 ==! */
             , SELC_WGVL_APLY_YN                                            /* Pondérateur du critrèe général  !== 선별가중치적용여부 ==! */
             , APLY_PROR_RNK                                                /* Priorité de l'application !== 적용우선순위 ==! */
             , BASE_DESC                                                    /* Description de critère !== 기준설명 ==! */
             , INSC_GDLN_CN                                                 /* Directives d'inspection  !== 검사지침내용 ==! */
             , RQST_RSN_CD                                                  /* Code de renseignement !== 신청사유코드 ==! */
             , RTRN_RSN_CN                                                  /* Motif De Rejet !== 반려 사유 내용 ==! */
             , OPRN_SQL_CN                                                  /* Requête du système en vigueur !== 운영SQL내용 ==! */
             , SMLT_SQL_CN                                                  /* Requête de la simulation !== 시뮬레이션SQL내용 ==! */
             , DLPY_BASE_AMT                                                /* Montant critèredes arriérés !== 체납기준금액 ==! */
             , RNDM_GOAL_SELC_RT                                            /* Taux objectif (RA) !== 랜덤목표선별율 ==!  */
             , CHPN_ID                                                      /* ID du responsable !== 담당자ID ==! */
             , DEL_YN                                                       /* Suppression ON !== 삭제여부 ==! */
             , FRST_REGST_ID                                                /* ID du premier enregistrant  !== 최초등록자ID ==! */
             , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM        /* Nom du premier enregistrant  !== 최초등록자이름 ==! */
             , FRST_RGSR_DTTM                                               /* Date et heure de premier enregistrement !== 최초등록일시 ==! */
             , LAST_CHPR_ID                                                 /* ID du modificateur final !== 최종변경자ID ==! */
             , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM          /* Nom du modificateur final !== 최종변경자이름 ==! */
             , LAST_CHG_DTTM                                                /* Date et heure de modification finale !== 최종변경일시 ==! */
         FROM  TB_RSMI_BASE_MGMT_COMN A
         WHERE DEL_YN = 'N'                                                 /* Suppression ON !== 삭제여부 ==! */

        <foreach item="baseRgsrNos" collection="baseRgsrNos" open="AND A.BASE_RGSR_NO IN (" close=")" separator=",">
            #{baseRgsrNos}
        </foreach>

    </select>

    <!--
      consulter la date de prolongation !== 기간연장일자 조회 ==!
    -->
    <select id="selectXtnsDt"
        parameterType="alpass.ipt.rsm.com.vo.RsmBaseRqstHVo"
        resultType="java.lang.String">
        /* selectXtnsDt */
        SELECT ( SELECT APLY_END_DT
                 FROM TB_RSMI_BASE_RQST_H X
                 WHERE X.DEL_YN = 'N'
                 AND   X.APRV_BSOP_TP_CD='E04'
                 AND   X.BASE_RGSR_NO=A.BASE_RGSR_NO
                 AND   X.BASE_PRCS_STTS_CD='K01'
                 AND   HIST_SRNO = ( SELECT MAX(HIST_SRNO)
								     FROM TB_RSMI_BASE_RQST_H Y
								     WHERE Y.DEL_YN = 'N'
                                     AND Y.APRV_BSOP_TP_CD='E04'
								     AND Y.BASE_RGSR_NO=A.BASE_RGSR_NO
								     AND Y.BASE_PRCS_STTS_CD='K01'
							       )
			   ) AS XTNS_DT
		FROM TB_RSMI_BASE_MGMT_COMN A
		WHERE A.DEL_YN = 'N'
        AND A.BASE_RGSR_NO = #{baseRgsrNo}
    </select>

    <!--
      [Gérer la fourchette de valeurs par code SH ] Consulter la liste !== [HS별단위가격관리] 목록조회 ==!
    -->
    <select id="selectHsPrUtPrcList" parameterType="alpass.ipt.rsm.com.vo.RsmHsPrcStatsVo" resultType="alpass.ipt.rsm.com.vo.RsmHsPrcStatsVo">
        /* selectHsPrUtPrcList */
        <include refid="pagination.header"/>
        WITH APLY_HS AS (
          SELECT
              HS_CD
            , HS_DESC AS HS_NM
            , TO_DATE(HS_APLY_STRT_DT, 'YYYYMMDD') AS HS_APLY_STRT_DT
            , TO_DATE(HS_APLY_END_DT, 'YYYYMMDD') AS HS_APLY_END_DT
          FROM
            TB_CLRI_HS_CD
          WHERE
            DEL_YN = 'N'
            AND LAST_YN = 'Y'
            AND TO_DATE(HS_APLY_STRT_DT, 'YYYYMMDD') <![CDATA[ <= ]]> SYSDATE
            AND TO_DATE(HS_APLY_END_DT, 'YYYYMMDD') <![CDATA[ >= ]]> SYSDATE
        )
        SELECT
          A.HS_CD,
          CHS.HS_NM,
          A.ORCY_CNTY_CD,
          A.QTY_UT_CD,
          A.LWST_UT_PRC,
          A.TOP_UT_PRC,
          A.AVG_UT_PRC,
          A.STND_DVTN_UT_PRC,
          A.LWLM_UT_PRC,
          A.UPLM_UT_PRC,
          A.APLY_DT,
          TO_CHAR(CHS.HS_APLY_STRT_DT, 'DD/MM/YYYY') AS APLY_DT_FROM,
          TO_CHAR(CHS.HS_APLY_END_DT, 'DD/MM/YYYY') AS APLY_DT_TO
        FROM
          TB_RSMI_HS_PRC_STATS A
          , APLY_HS CHS
        WHERE
          A.HS_CD = CHS.HS_CD(+)
        AND A.APLY_YN = 'Y'
        <if test='hsCd != null and !"".equals(hsCd)'>
        AND A.HS_CD = #{hsCd}
        </if>
        <if test='orcyCntyCd != null and !"".equals(orcyCntyCd)'>
        AND A.ORCY_CNTY_CD = #{orcyCntyCd}
        </if>
        ORDER BY A.HS_CD ASC

        <include refid="pagination.footer" />

    </select>

    <!--
      [Gérer la fourchette de valeurs par code SH ] Consulter la liste d'historique  !== [HS별단위가격관리] 이력 목록조회 ==!
    -->
    <select id="selectHsPrUtPrcHistList" parameterType="alpass.ipt.rsm.com.vo.RsmHsPrcStatsVo" resultType="alpass.ipt.rsm.com.vo.RsmHsPrcStatsVo">
        /* selectHsPrUtPrcHistList */
        SELECT  APLY_YN
              , APLY_DT
              , LWST_UT_PRC
              , TOP_UT_PRC
              , AVG_UT_PRC
              , STND_DVTN_UT_PRC
              , LWLM_UT_PRC
              , UPLM_UT_PRC
        FROM    TB_RSMI_HS_PRC_STATS
        WHERE   HS_CD = #{hsCd}
        AND     QTY_UT_CD = #{qtyUtCd}
        AND     ORCY_CNTY_CD = #{orcyCntyCd}
        ORDER BY APLY_DT DESC
        FETCH FIRST 10 ROWS ONLY
    </select>

</mapper>