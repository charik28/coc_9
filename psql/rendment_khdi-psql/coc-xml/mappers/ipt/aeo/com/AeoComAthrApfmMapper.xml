<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
Mapper : [OEA commun] Demandes d'agrément !==[AEO 공통] 공인신청서 Mapper==!
(wonjun.cha)
-->
<mapper namespace="alpass.ipt.aeo.com.mapper.AeoComAthrApfmMapper">

    <!--
    [OEA commun] Consulter la liste des demandes d'agrément !==[AEO 공통] 공인신청서 목록 조회==!
    -->
    <select id="selectAeoComAthrApfmList"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComAthrApfmList */
        <include refid="pagination.header"/>
        SELECT T.*
        FROM (
        SELECT TA.*
        FROM (
        SELECT 'ARQ' as ATHR_RQST_TP_CD /** Code de type de demande d'agrément !== 공인신청구분코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0004', 'ARQ', #{langCd}) AS ATHR_RQST_TP_NM /** Nom De Type De Demande !== 신청구분명 ==!
        */
        , AAR.AEO_ATHR_RQST_NO AS ATHR_MGMT_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , AAR.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , AAR.PRCS_STTS_CD /** Code De Statut De Traitement !== 처리상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0015', AAR.PRCS_STTS_CD, #{langCd}) AS PRCS_STTS_NM /** Code De Statut De Traitement
        !== 처리상태코드 ==! */
        , AAR.DTL_PRCS_STTS_CD /** Code d'état détaillé du traitement !== 상세처리상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0017', AAR.DTL_PRCS_STTS_CD, #{langCd}) AS DTL_PRCS_STTS_NM /** Code d'état détaillé
        du traitement !== 상세처리상태코드 ==! */
        , AAR.CO_CD /** Code De La Compagnie !== 업체코드 ==! */
        , AAR.CO_NM /** Nom De L'Entreprise !== 업체명 ==! */
        , AAR.NIF /** NIF !== 납세번호 ==! */
        , AAR.PLN_AUDT_DEPT_CD /** Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        , (SELECT AA.ORGN_NM FROM TB_POTI_ORGN AA WHERE AA.ORGN_MGMT_CD = UPPER(AAR.PLN_AUDT_DEPT_CD)) AS
        PLN_AUDT_DEPT_NM /** Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        , TO_CHAR(AAR.RQST_DTTM, 'DD/MM/YYYY') AS rqstDttm /** Date Et Heure De La Demande !== 신청일시 ==! */
        , TO_CHAR(AAR.ACAP_DTTM, 'DD/MM/YYYY') AS acapDttm /** Date De Réception !== 접수일시 ==! */
        , AAR.ACAP_CSTM_CD /** Code douanier de réception !== 접수세관코드 ==! */
        , (SELECT B.UPR_ORGN_MGMT_CD FROM TB_POTI_ORGN B WHERE B.DEL_YN = 'N' AND B.ORGN_MGMT_CD = AAR.ACAP_CSTM_CD) AS
        UPR_ORGN_MGMT_CD /** Code Du Service Supérieur !== 상위조직관리코드 ==! */
        , AAR.LAST_CHG_DTTM /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        , AAR.AEO_ATHR_NO /** Numéro d'OEA !== AEO공인번호 ==! */
        , '' AS MGMT_RQST_TP_CD /** Code de classification de gestion ultérieure d'OEA !== 사후관리신청구분코드 ==! */
        , (SELECT ATHR_STTS_CD FROM TB_AEOI_ATHR_CO CC WHERE CC.AEO_ATHR_NO= AAR.AEO_ATHR_NO) /** Code d'état d'agrément
        !== 공인상태코드 ==! */
        FROM TB_AEOI_ATHR_RQST AAR /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        WHERE AAR.DEL_YN = 'N' /** Suppression On !== 삭제여부 ==! */
        <if test='srchTodoYn != null and srchTodoYn.equals("Y")'>
            <if test='(srchRoleId != null and "AEO001".equals(srchRoleId))'>
                AND AAR.DTL_PRCS_STTS_CD IN ('U01', 'U02', 'U08', 'U09')
            </if>
            <if test='(srchRoleId != null and "AEO014".equals(srchRoleId))'>
                AND AAR.DTL_PRCS_STTS_CD IN ('U87')
            </if>
            <if test='(srchRoleId != null and "AEO002".equals(srchRoleId))'>
                AND AAR.DTL_PRCS_STTS_CD IN ('U60', 'U78')
            </if>
            <if test='(srchRoleId != null and "AEO004".equals(srchRoleId))'>
                AND AAR.DTL_PRCS_STTS_CD IN ('U03', 'U33', 'U59', 'U79')
            </if>
            <if test='(srchRoleId != null and "AEO006".equals(srchRoleId))'>
                AND AAR.DTL_PRCS_STTS_CD = 'U21'
            </if>
            <if test='(srchRoleId != null and "AEO003".equals(srchRoleId))'>
                AND AAR.DTL_PRCS_STTS_CD IN
                ('U05','U06','U12','U13','U14','U15','U16','U17','U18','U19','U22','U23','U32','U34','U83','U84','U85','U86')
            </if>
            <if test='(srchRoleId != null and "AEO011".equals(srchRoleId))'>
                AND AAR.DTL_PRCS_STTS_CD IN ('U20','U32')
            </if>
        </if>
        <if test='(srchStrtDt != null and !"".equals(srchStrtDt)) and (srchEndDt != null and !"".equals(srchEndDt))'>
            AND TO_CHAR(AAR.RQST_DTTM, 'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(REPLACE(#{srchStrtDt}, '/', ''), 'DDMMYYYY'),
            'YYYYMMDD') AND TO_CHAR(TO_DATE(REPLACE(#{srchEndDt}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD')
        </if>
        <if test='srchPrcsSttsCd != null and !"".equals(srchPrcsSttsCd)'>
            AND AAR.PRCS_STTS_CD = #{srchPrcsSttsCd} /** Code De Statut De Traitement !== 처리상태코드 ==! */
        </if>
        <if test='srchCoCd != null and !"".equals(srchCoCd)'>
            AND AAR.NIF = #{srchCoCd}
        </if>
        <if test='plnAudtDeptCd != null and !"".equals(plnAudtDeptCd)'>
            AND #{plnAudtDeptCd} = (SELECT C.AUDT_ORGN_MGMT_CD
            FROM TB_POTI_ORGN B
            , TB_AEOI_ATHR_AUDT_ORGN C
            WHERE B.UPR_ORGN_MGMT_CD = C.DRD_ORGN_MGMT_CD
            AND B.DEL_YN = 'N'
            AND C.DEL_YN = 'N'
            AND B.ORGN_MGMT_CD = AAR.ACAP_CSTM_CD)
        </if>
        <if test='audtPtCd != null and !"".equals(audtPtCd)'>
            AND AAR.AUDT_PT_CD = #{audtPtCd}
        </if>

        ) TA
        WHERE TA.ACAP_CSTM_CD IS NOT NULL
        <choose>
            <when test='srchCnfcAudtYn != null and srchCnfcAudtYn.equals("Y")'>
                <if test='(srchRoleId != null and "AEO004".equals(srchRoleId))'>
                    AND EXISTS ( SELECT 'X'
                    FROM TB_POTI_EMP D
                    , VW_POTI_ROLE_UNFC E
                    , TB_AEOI_ATHR_AUDT_ORGN F
                    , TB_AEOI_RQST_CO_POBS G
                    WHERE D.DEL_YN = 'N'
                    AND D.PBSR_NO = #{srchLoginId}
                    AND E.PBSR_NO = D.PBSR_NO
                    AND E.ROLE_ID = #{srchRoleId}
                    AND F.DEL_YN = 'N'
                    AND F.AUDT_ORGN_MGMT_CD = D.ORGN_MGMT_CD
                    AND G.DEL_YN = 'N'
                    AND G.JRSD_CSTM_CD = F.DRD_ORGN_MGMT_CD
                    AND G.AEO_ATHR_RQST_NO = TA.AEO_ATHR_RQST_NO
                    AND G.MNDA_CN IS NOT NULL
                    )
                </if>
                <if test='(srchRoleId != null and "AEO003".equals(srchRoleId))'>
                    AND EXISTS ( SELECT 'X'
                    FROM TB_AEOI_ADOR G
                    WHERE G.DEL_YN ='N'
                    AND G.AEO_RQST_NO = TA.AEO_ATHR_RQST_NO
                    AND G.ADOR_ID = #{srchLoginId}
                    AND G.ADOR_TP_CD ='CAO'
                    )
                </if>
                <if test='(srchRoleId != null and "AEO011".equals(srchRoleId))'>
                    AND EXISTS ( SELECT 'X'
                    FROM TB_POTI_EMP D
                    , VW_POTI_ROLE_UNFC E
                    , TB_AEOI_ATHR_AUDT_ORGN F
                    , TB_AEOI_RQST_CO_POBS G
                    WHERE D.DEL_YN = 'N'
                    AND D.PBSR_NO = #{srchLoginId}
                    AND E.PBSR_NO = D.PBSR_NO
                    AND E.ROLE_ID = #{srchRoleId}
                    AND F.DEL_YN = 'N'
                    AND F.AUDT_ORGN_MGMT_CD = (SELECT H.UPR_ORGN_MGMT_CD FROM TB_POTI_ORGN H WHERE H.ORGN_MGMT_CD =
                    D.ORGN_MGMT_CD )
                    AND G.DEL_YN = 'N'
                    AND G.JRSD_CSTM_CD = F.DRD_ORGN_MGMT_CD
                    AND G.AEO_ATHR_RQST_NO = TA.AEO_ATHR_RQST_NO
                    AND G.MNDA_CN IS NOT NULL
                    )
                </if>
            </when>
            <otherwise>
                <if test='(srchRoleId != null and ("AEO001".equals(srchRoleId) || "AEO014".equals(srchRoleId))) and (srchLoginId != null and !"".equals(srchLoginId))'>
                    AND TA.ACAP_CSTM_CD IN (
                    SELECT A.ORGN_MGMT_CD
                    FROM TB_POTI_EMP A
                    , VW_POTI_ROLE_UNFC B
                    WHERE A.DEL_YN = 'N'
                    AND A.PBSR_NO = #{srchLoginId} /** 로그인 ID */
                    AND B.PBSR_NO = A.PBSR_NO
                    AND B.ROLE_ID = #{srchRoleId}
                    )
                </if>
                <if test='(srchRoleId != null and "AEO002".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                    AND TA.UPR_ORGN_MGMT_CD IN (
                    SELECT A.ORGN_MGMT_CD
                    FROM TB_POTI_EMP A
                    , VW_POTI_ROLE_UNFC B
                    WHERE A.DEL_YN = 'N'
                    AND A.PBSR_NO = #{srchLoginId} /** 로그인 ID */
                    AND B.PBSR_NO = A.PBSR_NO
                    AND B.ROLE_ID = #{srchRoleId}
                    )
                </if>
                <if test='(srchRoleId != null and "AEO003".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                    AND EXISTS (
                    SELECT 'X'
                    FROM TB_AEOI_ADOR G
                    WHERE G.DEL_YN ='N'
                    AND G.AEO_RQST_NO = TA.AEO_ATHR_RQST_NO
                    AND G.ADOR_ID = #{srchLoginId} /** 로그인 ID */
                    )
                </if>
                <if test='(srchRoleId != null and "AEO004".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                    AND EXISTS (
                    SELECT 'X'
                    FROM TB_POTI_EMP D
                    , VW_POTI_ROLE_UNFC E
                    , TB_AEOI_ATHR_AUDT_ORGN F
                    WHERE D.DEL_YN = 'N'
                    AND D.PBSR_NO = #{srchLoginId}
                    AND E.PBSR_NO = D.PBSR_NO
                    AND E.ROLE_ID = #{srchRoleId}
                    AND F.DEL_YN = 'N'
                    AND F.AUDT_ORGN_MGMT_CD = D.ORGN_MGMT_CD
                    AND F.DRD_ORGN_MGMT_CD = TA.UPR_ORGN_MGMT_CD
                    )
                </if>
                <if test='(srchRoleId != null and "AEO011".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                    AND EXISTS (
                    SELECT 'X'
                    FROM TB_POTI_EMP D
                    , VW_POTI_ROLE_UNFC E
                    , TB_AEOI_ATHR_AUDT_ORGN F
                    WHERE D.DEL_YN = 'N'
                    AND D.PBSR_NO = #{srchLoginId}
                    AND E.PBSR_NO = D.PBSR_NO
                    AND E.ROLE_ID = #{srchRoleId}
                    AND F.DEL_YN = 'N'
                    AND F.AUDT_ORGN_MGMT_CD = (SELECT H.UPR_ORGN_MGMT_CD FROM TB_POTI_ORGN H WHERE H.ORGN_MGMT_CD =
                    D.ORGN_MGMT_CD )
                    )
                </if>
            </otherwise>
        </choose>
        <if test='(plnAudtDeptCd == null or "".equals(plnAudtDeptCd)) and (audtPtCd == null or "".equals(audtPtCd))'>
            UNION ALL
            SELECT TB.*
            FROM (
            SELECT 'PSM' as ATHR_RQST_TP_CD /** Code de type de demande d'agrément !== 공인신청구분코드 ==! */
            , FN_GET_CD_VDVAL_NM('AEO_0004', 'PSM', #{langCd}) AS ATHR_RQST_TP_NM /** Nom De Type De Demande !== 신청구분명
            ==! */
            , AAR.AEO_AFFC_MGMT_RQST_NO AS ATHR_MGMT_NO /** Numéro de demande de gestion ultérieure d'OEA !==
            AEO사후관리신청번호 ==! */
            , ( SELECT AA.AEO_ATHR_RQST_NO FROM TB_AEOI_ATHR_RQST AA WHERE AA.AEO_ATHR_NO = AAC.AEO_ATHR_NO ) AS
            AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
            , AAR.PRCS_STTS_CD /** Code De Statut De Traitement !== 처리상태코드 ==! */
            , FN_GET_CD_VDVAL_NM('AEO_0016', AAR.PRCS_STTS_CD, #{langCd}) AS PRCS_STTS_NM /** Code De Statut De
            Traitement !== 처리상태코드 ==! */
            , AAR.DTL_PRCS_STTS_CD /** Code d'etat detaille du traitement !== 상세처리상태코드 ==! */
            , FN_GET_CD_VDVAL_NM('AEO_0018', AAR.DTL_PRCS_STTS_CD, #{langCd}) AS DTL_PRCS_STTS_NM /** Code d'etat
            detaille du traitement !== 상세처리상태코드 ==! */
            , AAC.CO_CD /** Code De La Compagnie !== 업체코드 ==! */
            , ( SELECT CO_NM FROM TB_COM_CO AA WHERE AA.NIF = AAC.NIF ) AS CO_NM /** Nom De L'Entreprise !== 업체명 ==! */
            , AAC.NIF /** NIF !== 납세번호 ==! */
            , '' AS PLN_AUDT_DEPT_CD /** Service des controles a posteriori !== 계획심사부서코드 ==! */
            , '' AS PLN_AUDT_DEPT_NM /** Service des controles a posteriori !== 계획심사부서코드 ==! */
            , TO_CHAR(AAR.RQST_DTTM, 'DD/MM/YYYY') AS rqstDttm /** Date Et Heure De La Demande !== 신청일시 ==! */
            , '' AS acapDttm /** Date De Reception !== 접수일시 ==! */
            , AAR.ACAP_CSTM_CD /** Code douanier de réception !== 접수세관코드 ==! */
            , (SELECT B.UPR_ORGN_MGMT_CD FROM TB_POTI_ORGN B WHERE B.DEL_YN = 'N' AND B.ORGN_MGMT_CD = AAR.ACAP_CSTM_CD)
            AS UPR_ORGN_MGMT_CD /** Code Du Service Supérieur !== 상위조직관리코드 ==! */
            , AAR.LAST_CHG_DTTM /** Date Et Heure De Modification Finale !== 접수일시 ==! */
            , AAC.AEO_ATHR_NO /** Date De Reception !== 최종변경일시 ==! */
            , AAR.MGMT_RQST_TP_CD /** Code de classification de gestion ultérieure d'OEA !== 사후관리신청구분코드 ==! */
            , AAC.ATHR_STTS_CD /** Code d'état d'agrément !== 공인상태코드 ==! */
            FROM TB_AEOI_AFFC_RQST AAR /** AEOI_DEMANDE ULTÉRIEURE !== AEOI_사후신청 ==! */
            , TB_AEOI_ATHR_CO AAC /** AEOI_OPÉRATEURS AGRÉÉS !== AEOI_공인업체 ==! */
            WHERE AAR.DEL_YN = 'N'
            AND AAC.AEO_ATHR_NO = AAR.AEO_ATHR_NO
            <if test='srchTodoYn != null and srchTodoYn.equals("Y")'>
                <if test='(srchRoleId != null and "AEO001".equals(srchRoleId))'>
                    AND AAR.DTL_PRCS_STTS_CD IN ('U01')
                </if>
                <if test='(srchRoleId != null and "AEO002".equals(srchRoleId))'>
                    AND AAR.DTL_PRCS_STTS_CD IN ( 'U60', 'U46')
                </if>
                <if test='(srchRoleId != null and "AEO004".equals(srchRoleId))'>
                    AND AAR.DTL_PRCS_STTS_CD IN ('U35', 'U33', 'U71')
                </if>
                <if test='(srchRoleId != null and "AEO006".equals(srchRoleId))'>
                    AND AAR.DTL_PRCS_STTS_CD IN ('U44', 'U80')
                </if>
                <if test='(srchRoleId != null and "AEO003".equals(srchRoleId))'>
                    AND ( AAR.DTL_PRCS_STTS_CD IN ('U12')
                    OR
                    ( AAR.PRCS_STTS_CD ='D29' AND AAR.DTL_PRCS_STTS_CD IN ('U32') )
                    )
                </if>
                <if test='(srchRoleId != null and "AEO011".equals(srchRoleId))'>
                    AND ( AAR.DTL_PRCS_STTS_CD IN ('U70')
                    OR
                    ( AAR.PRCS_STTS_CD ='D29' AND AAR.DTL_PRCS_STTS_CD IN ('U32') )
                    )
                </if>
            </if>
            <if test='(srchStrtDt != null and !"".equals(srchStrtDt)) and (srchEndDt != null and !"".equals(srchEndDt))'>
                AND TO_CHAR(AAR.RQST_DTTM, 'YYYYMMDD') BETWEEN TO_CHAR(TO_DATE(REPLACE(#{srchStrtDt}, '/', ''),
                'DDMMYYYY'), 'YYYYMMDD') AND TO_CHAR(TO_DATE(REPLACE(#{srchEndDt}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD')
            </if>
            <if test='srchPrcsSttsCd != null and !"".equals(srchPrcsSttsCd)'>
                AND AAR.PRCS_STTS_CD = #{srchPrcsSttsCd} /** Code De Statut De Traitement !== 처리상태코드 ==! */
            </if>
            <if test='srchCoCd != null and !"".equals(srchCoCd)'>
                AND AAC.NIF = #{srchCoCd}
            </if>
            ) TB
            WHERE TB.ACAP_CSTM_CD IS NOT NULL
            <choose>
                <when test='srchCnfcAudtYn != null and srchCnfcAudtYn.equals("Y")'>
                    <if test='(srchRoleId != null and "AEO004".equals(srchRoleId))'>
                        AND EXISTS ( SELECT 'X'
                        FROM TB_POTI_EMP D
                        , VW_POTI_ROLE_UNFC E
                        , TB_AEOI_ATHR_AUDT_ORGN F
                        , TB_AEOI_RQST_CO_POBS G
                        WHERE D.DEL_YN = 'N'
                        AND D.PBSR_NO = #{srchLoginId}
                        AND E.PBSR_NO = D.PBSR_NO
                        AND E.ROLE_ID = #{srchRoleId}
                        AND F.DEL_YN = 'N'
                        AND F.AUDT_ORGN_MGMT_CD = D.ORGN_MGMT_CD
                        AND G.DEL_YN = 'N'
                        AND G.JRSD_CSTM_CD = F.DRD_ORGN_MGMT_CD
                        AND G.AEO_ATHR_RQST_NO = TB.ATHR_MGMT_NO
                        AND G.MNDA_CN IS NOT NULL
                        )
                    </if>
                    <if test='(srchRoleId != null and "AEO003".equals(srchRoleId))'>
                        AND EXISTS ( SELECT 'X'
                        FROM TB_AEOI_ADOR G
                        WHERE G.DEL_YN ='N'
                        AND G.AEO_RQST_NO = TB.ATHR_MGMT_NO
                        AND G.ADOR_ID = #{srchLoginId}
                        AND G.ADOR_TP_CD ='CAO'
                        )
                    </if>
                    <if test='(srchRoleId != null and "AEO011".equals(srchRoleId))'>
                        AND EXISTS ( SELECT 'X'
                        FROM TB_POTI_EMP D
                        , VW_POTI_ROLE_UNFC E
                        , TB_AEOI_ATHR_AUDT_ORGN F
                        , TB_AEOI_RQST_CO_POBS G
                        WHERE D.DEL_YN = 'N'
                        AND D.PBSR_NO = #{srchLoginId}
                        AND E.PBSR_NO = D.PBSR_NO
                        AND E.ROLE_ID = #{srchRoleId}
                        AND F.DEL_YN = 'N'
                        AND F.AUDT_ORGN_MGMT_CD = (SELECT H.UPR_ORGN_MGMT_CD FROM TB_POTI_ORGN H WHERE H.ORGN_MGMT_CD =
                        D.ORGN_MGMT_CD )
                        AND G.DEL_YN = 'N'
                        AND G.JRSD_CSTM_CD = F.DRD_ORGN_MGMT_CD
                        AND G.AEO_ATHR_RQST_NO = TB.ATHR_MGMT_NO
                        AND G.MNDA_CN IS NOT NULL
                        )
                    </if>
                </when>
                <otherwise>
                    <if test='(srchRoleId != null and "AEO001".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                        AND TB.ACAP_CSTM_CD IN (
                        SELECT A.ORGN_MGMT_CD
                        FROM TB_POTI_EMP A
                        , VW_POTI_ROLE_UNFC B
                        WHERE A.DEL_YN = 'N'
                        AND A.PBSR_NO = #{srchLoginId} /** 로그인 ID */
                        AND B.PBSR_NO = A.PBSR_NO
                        AND B.ROLE_ID = #{srchRoleId}
                        )
                    </if>
                    <if test='(srchRoleId != null and "AEO002".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                        AND TB.UPR_ORGN_MGMT_CD IN (
                        SELECT A.ORGN_MGMT_CD
                        FROM TB_POTI_EMP A
                        , VW_POTI_ROLE_UNFC B
                        WHERE A.DEL_YN = 'N'
                        AND A.PBSR_NO = #{srchLoginId} /** 로그인 ID */
                        AND B.PBSR_NO = A.PBSR_NO
                        AND B.ROLE_ID = #{srchRoleId}
                        )
                    </if>
                    <if test='(srchRoleId != null and "AEO003".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                        AND EXISTS (
                        SELECT 'X'
                        FROM TB_AEOI_ADOR G
                        WHERE G.DEL_YN ='N'
                        AND G.AEO_RQST_NO = TB.AEO_ATHR_RQST_NO
                        AND G.ADOR_ID = #{srchLoginId} /** 로그인 ID */
                        )
                    </if>
                    <if test='(srchRoleId != null and "AEO004".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                        AND EXISTS (
                        SELECT 'X'
                        FROM TB_POTI_EMP D
                        , VW_POTI_ROLE_UNFC E
                        , TB_AEOI_ATHR_AUDT_ORGN F
                        WHERE D.DEL_YN = 'N'
                        AND D.PBSR_NO = #{srchLoginId}
                        AND E.PBSR_NO = D.PBSR_NO
                        AND E.ROLE_ID = #{srchRoleId}
                        AND F.DEL_YN = 'N'
                        AND F.AUDT_ORGN_MGMT_CD = D.ORGN_MGMT_CD
                        AND F.DRD_ORGN_MGMT_CD IN ( SELECT G.UPR_ORGN_MGMT_CD
                        FROM TB_POTI_ORGN G
                        WHERE G.DEL_YN ='N'
                        AND G.ORGN_MGMT_CD = TB.ACAP_CSTM_CD
                        )
                        )
                    </if>
                    <if test='(srchRoleId != null and "AEO011".equals(srchRoleId)) and (srchLoginId != null and !"".equals(srchLoginId))'>
                        AND EXISTS (
                        SELECT 'X'
                        FROM TB_POTI_EMP D
                        , VW_POTI_ROLE_UNFC E
                        , TB_AEOI_ATHR_AUDT_ORGN F
                        WHERE D.DEL_YN = 'N'
                        AND D.PBSR_NO = #{srchLoginId}
                        AND E.PBSR_NO = D.PBSR_NO
                        AND E.ROLE_ID = #{srchRoleId}
                        AND F.DEL_YN = 'N'
                        AND F.AUDT_ORGN_MGMT_CD = D.CSTM_MGMT_CD
                        AND F.DRD_ORGN_MGMT_CD IN ( SELECT G.UPR_ORGN_MGMT_CD
                        FROM TB_POTI_ORGN G
                        WHERE G.DEL_YN ='N'
                        AND G.ORGN_MGMT_CD = TB.ACAP_CSTM_CD
                        )
                        )
                    </if>
                </otherwise>
            </choose>
        </if>
        ) T
        ORDER BY T.LAST_CHG_DTTM DESC
        <include refid="pagination.footer"/>
    </select>

    <!--
    [OEA commun] Détails de la demande d'agrément - Consulter les informations sur l'opérateur !==[AEO 공통] 공인신청서 상세 - 업체정보 조회==!
    -->
    <select id="selectAeoComAthrApfmCoInfo"
            parameterType="alpass.ipt.aeo.com.vo.AeoiAthrRqstVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComAthrApfmCoInfo */
        SELECT 'ARQ' AS ATHR_RQST_TP_CD /** Code de type de demande d'agrément !== 공인신청구분코드 ==! */
        , A.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , A.AUDT_PT_CD /** Code De Type De Contrôle !== 심사유형코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0002', A.AUDT_PT_CD, #{langCd}) AS AUDT_PT_NM
        , A.AEO_QLFC_CD /** Code du titre OEA !== AEO자격코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0003', A.AEO_QLFC_CD, #{langCd}) AS AEO_QLFC_NM
        , A.PRCS_STTS_CD /** Code De Statut De Traitement !== 처리상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0015', A.PRCS_STTS_CD, #{langCd}) AS PRCS_STTS_NM /** Code De Statut De Traitement !==
        처리상태코드 ==! */
        , A.DTL_PRCS_STTS_CD /** Code d'état détaillé du traitement !== 상세처리상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0017', A.DTL_PRCS_STTS_CD, #{langCd}) AS DTL_PRCS_STTS_NM /** Code d'état détaillé du
        traitement !== 상세처리상태코드 ==! */
        , A.CO_CD /** Code De La Compagnie !== 업체코드 ==! */
        , A.CO_NM /** Nom De L'Entreprise !== 업체명 ==! */
        , TO_CHAR(TO_DATE(A.ESTB_DT), 'DD/MM/YYYY') AS ESTB_DT /** Date de constitution !== 설립일자 ==! */
        , A.ESTB_PLC_NM /** Lieu de constitution !== 설립장소명 ==! */
        , A.RPRS_TLPH_NO /** N° De Téléphone Principale !== 대표전화번호 ==! */
        , A.RPRS_FAX_NO /** N° De Fax Principal !== 대표팩스번호 ==! */
        , A.RPRS_EML /** Email Principal !== 대표이메일 ==! */
        , A.NIF /** NIF !== 납세번호 ==! */
        , A.LAW_QLFC_NM || ' | ' || FN_GET_CD_VDVAL_NM('POT_0075', A.LAW_QLFC_NM, #{langCd}) AS LAW_QLFC_NM /** Statut
        juridique !== 법자격명 ==! */
        , A.LAW_QLFC_NM AS LAW_QLFC_NM_CD /** Statut juridique !== 법자격명 ==! */
        , A.HOFC_ADDR /** Adresse du siège social !== 본사주소 ==! */
        , A.ACAP_CSTM_CD /** Code douanier de réception !== 접수세관코드 ==! */
        , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.ACAP_CSTM_CD)) AS ACAP_CSTM_NM /** Code
        douanier de réception !== 접수세관코드 ==! */
        , A.CAPL_AMT /** Montant du capital !== 자본금액 ==! */
        , A.SUMR_CN /** Résumé !== 요약내용 ==! */
        , TO_CHAR(A.RQST_DTTM, 'DD/MM/YYYY') AS rqstDttm /** Date Et Heure De La Demande !== 신청일시 ==! */
        , TO_CHAR(A.ACAP_DTTM, 'DD/MM/YYYY') AS acapDttm /** Date De Réception !== 접수일시 ==! */
        , TO_CHAR(A.ISS_DTTM, 'DD/MM/YYYY') AS issDttm /** Date de délivrance !== 발급일시 ==! */
        , A.ISS_CSTM_CD /** Code du bureau de douane de délivrance !== 발급세관코드 ==! */
        , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.ISS_CSTM_CD)) AS ISS_CSTM_NM /** Code du bureau
        de douane de délivrance !== 발급세관코드 ==! */
        , A.AEO_ATHR_NO /** Numéro d'OEA !== AEO공인번호 ==! */
        , A.PLN_AUDT_DEPT_CD /** Service des contrôles a posteriori !== 계획심사부서 ==! */
        , (SELECT ORGN_NM
        FROM TB_POTI_ORGN
        WHERE ORGN_MGMT_CD = (SELECT AUDT_ORGN_MGMT_CD
        FROM TB_AEOI_ATHR_AUDT_ORGN
        WHERE DEL_YN = 'N'
        AND DRD_ORGN_MGMT_CD = (SELECT UPR_ORGN_MGMT_CD
        FROM TB_POTI_ORGN
        WHERE DEL_YN = 'N'
        AND ORGN_MGMT_CD = A.ACAP_CSTM_CD))) AS PLN_AUDT_DEPT_NM /** Service des contrôles a posteriori !== 계획심사부서 ==!
        */
        , A.ATHR_BASE_EV_MEAN_CD /** Code de type d'évaluation des critères d'agrément !== 공인기준평가방법코드 ==! */
        , A.FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , A.FRST_RGSR_DTTM /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
        , A.LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , A.LAST_CHG_DTTM /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'CRC' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS CRC_ATCH_FILE_ID /** Copy of commercial register !== 상업등기부등본 사본 ==! */
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'NIC' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS NIC_ATCH_FILE_ID
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'EAC' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS EAC_ATCH_FILE_ID
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'QFS' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS QFS_ATCH_FILE_ID
        , (SELECT AA.UPR_ORGN_MGMT_CD FROM ALPASSINT.TB_POTI_ORGN AA WHERE AA.DEL_YN ='N' AND AA.ORGN_MGMT_CD=
        A.ACAP_CSTM_CD) AS SCTR_MGMT_CD /** Code Du Secteur !== 섹터관리코드 ==! */
        , (SELECT AO.AUDT_ORGN_MGMT_CD FROM TB_AEOI_ATHR_AUDT_ORGN AO WHERE AO.DEL_YN = 'N' AND AO.DRD_ORGN_MGMT_CD =
        (SELECT PO.UPR_ORGN_MGMT_CD FROM TB_POTI_ORGN PO WHERE PO.DEL_YN ='N' AND PO.ORGN_MGMT_CD= A.ACAP_CSTM_CD)) AS
        AUDT_ORGN_MGMT_CD /** Code de gestion de l'organigramme du service chargé d'audit !== 심사조직관리코드 ==! */
        , NVL(B.AEO_ATHR_GD_CD, '') AS AEO_ATHR_GD_CD /** Code de classement d'OEA !== AEO공인등급코드 ==! */
        , NVL(FN_GET_CD_VDVAL_NM('AEO_0005', B.AEO_ATHR_GD_CD, #{langCd}), '') AS AEO_ATHR_GD_NM /** Code de classement
        d'OEA !== AEO공인등급코드 ==! */
        , NVL(TO_CHAR(TO_DATE(B.ATHR_STRT_DT, 'YYYYMMDD'), 'DD/MM/YYYY'), '') AS ATHR_STRT_DT /** Date de commencement
        d'agrément !== 공인시작일자 ==! */
        , NVL(TO_CHAR(TO_DATE(B.ATHR_END_DT, 'YYYYMMDD'), 'DD/MM/YYYY'), '') AS ATHR_END_DT /** Date de fermeture
        d'agrément !== 공인종료일자 ==! */
        , NVL(B.ATHR_STTS_CD, '') AS ATHR_STTS_CD /** Code d'état d'agrément !== 공인상태코드 ==! */
        , NVL(FN_GET_CD_VDVAL_NM('AEO_0006', B.ATHR_STTS_CD, #{langCd}), '') AS ATHR_STTS_NM /** Code d'état d'agrément
        !== 공인상태코드 ==! */
        FROM TB_AEOI_ATHR_RQST A /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        , TB_AEOI_ATHR_CO B /** AEOI_OPÉRATEURS AGRÉÉS !== AEOI_공인업체 ==! */
        WHERE
        A.AEO_ATHR_NO = B.AEO_ATHR_NO(+)
        AND A.DEL_YN = 'N' /** Suppression ON !== 삭제여부 ==! */
        AND A.AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
    </select>

    <!--
    [OEA commun] Détails de la demande d'agrément - Consulter les informations sur l'opérateur !==[AEO 공통] 공인신청서 상세 - 업체정보 조회==!
    -->
    <select id="selectAeoComCoInfo"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComCoInfo */
        SELECT CASE
        WHEN (SELECT COUNT(*) FROM TB_AEOI_AFFC_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO) > 0 THEN 'PSM'
        ELSE 'ARQ'
        END AS ATHR_RQST_TP_CD /** Code de type de demande d'agrément !== 공인신청구분코드 ==! */
        , (SELECT AEO_ATHR_RQST_NO FROM TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO) AS AEO_ATHR_RQST_NO /**
        Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , (SELECT AEO_QLFC_CD FROM TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO) AS AEO_QLFC_CD /** Code du titre
        OEA !== AEO자격코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0003', (SELECT AEO_QLFC_CD FROM TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO),
        #{langCd}) AS AEO_QLFC_NM
        , A.CO_CD /** Code De La Compagnie !== 업체코드 ==! */
        , NVL(D.CO_NM, C.CO_NM) AS CO_NM /** Nom De L'Entreprise !== 업체명 ==! */
        , NVL(TO_CHAR(TO_DATE(C.CO_ESTB_DT, 'DDMMYYYY'), 'DD/MM/YYYY'), TO_CHAR(TO_DATE((SELECT ESTB_DT FROM
        TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO)), 'DD/MM/YYYY')) AS ESTB_DT /** Date de constitution !==
        설립일자 ==! */
        , NVL(C.CO_ESTB_PLC_NM, (SELECT ESTB_PLC_NM FROM TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO)) AS
        ESTB_PLC_NM /** Lieu de constitution !== 설립장소명 ==! */
        , (SELECT RPRS_TLPH_NO FROM TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO) AS RPRS_TLPH_NO /** N° De
        Téléphone Principale !== 대표전화번호 ==! */
        , (SELECT RPRS_FAX_NO FROM TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO) AS RPRS_FAX_NO /** N° De Fax
        Principal !== 대표팩스번호 ==! */
        , (SELECT RPRS_EML FROM TB_AEOI_ATHR_RQST WHERE AEO_ATHR_NO = A.AEO_ATHR_NO) AS RPRS_EML /** Email Principal !==
        대표이메일 ==! */
        , A.NIF /** NIF !== 납세번호 ==! */
        , (SELECT LAW_QLFC_NM || ' | ' || FN_GET_CD_VDVAL_NM('POT_0075', LAW_QLFC_NM, #{langCd}) FROM TB_AEOI_ATHR_RQST
        WHERE AEO_ATHR_NO = A.AEO_ATHR_NO) AS LAW_QLFC_NM /** Statut juridique !== 법자격명 ==! */
        , NVL(D.CO_DTL_ADDR, C.CO_ADDR) AS HOFC_ADDR /** Adresse du siège social !== 본사주소 ==! */
        , A.JRSD_CSTM_CD AS ACAP_CSTM_CD /** Code douanier de réception !== 접수세관코드 ==! */
        , NVL((SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.JRSD_CSTM_CD)), '') AS ACAP_CSTM_NM /**
        Code douanier de réception !== 접수세관코드 ==! */
        , A.AEO_ATHR_NO /** Numéro d'OEA !== AEO공인번호 ==! */
        , A.FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS FRST_RGSR_DTTM /** Date Et Heure De Premier
        Enregistrement !== 최초등록일시 ==! */
        , A.LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS LAST_CHG_DTTM /** Date Et Heure De Modification Finale
        !== 최종변경일시 ==! */
        , (SELECT AA.UPR_ORGN_MGMT_CD FROM ALPASSINT.TB_POTI_ORGN AA WHERE AA.DEL_YN ='N' AND AA.ORGN_MGMT_CD=
        A.JRSD_CSTM_CD) AS SCTR_MGMT_CD /** Code Du Secteur !== 섹터관리코드 ==! */
        , (SELECT AO.AUDT_ORGN_MGMT_CD FROM TB_AEOI_ATHR_AUDT_ORGN AO WHERE AO.DEL_YN = 'N' AND AO.DRD_ORGN_MGMT_CD =
        (SELECT PO.UPR_ORGN_MGMT_CD FROM TB_POTI_ORGN PO WHERE PO.DEL_YN ='N' AND PO.ORGN_MGMT_CD= A.JRSD_CSTM_CD)) AS
        AUDT_ORGN_MGMT_CD /** Code de gestion de l'organigramme du service chargé d'audit !== 심사조직관리코드 ==! */
        , NVL(A.AEO_ATHR_GD_CD, '') AS AEO_ATHR_GD_CD /** Code de classement d'OEA !== AEO공인등급코드 ==! */
        , NVL(FN_GET_CD_VDVAL_NM('AEO_0005', A.AEO_ATHR_GD_CD, #{langCd}), '') AS AEO_ATHR_GD_NM /** Code de classement
        d'OEA !== AEO공인등급코드 ==! */
        , NVL(TO_CHAR(TO_DATE(A.ATHR_STRT_DT, 'YYYYMMDD'), 'DD/MM/YYYY'), '') AS ATHR_STRT_DT /** Date de commencement
        d'agrément !== 공인시작일자 ==! */
        , NVL(TO_CHAR(TO_DATE(A.ATHR_END_DT, 'YYYYMMDD'), 'DD/MM/YYYY'), '') AS ATHR_END_DT /** Date de fermeture
        d'agrément !== 공인종료일자 ==! */
        , NVL(A.ATHR_STTS_CD, '') AS ATHR_STTS_CD /** Code d'état d'agrément !== 공인상태코드 ==! */
        , NVL(FN_GET_CD_VDVAL_NM('AEO_0006', A.ATHR_STTS_CD, #{langCd}), '') AS ATHR_STTS_NM /** Code d'état d'agrément
        !== 공인상태코드 ==! */
        FROM
        ALPASSINT.TB_AEOI_ATHR_CO A /** AEOI_OPÉRATEURS AGRÉÉS !== AEOI_공인업체 ==! */
        , ALPASSINT.TB_COM_CO C /** COM_ENTREPRISE !== COM_업체 ==! */
        , ALPASSEXT.TB_POTE_NIF D /** POTE_NIF !== POTE_NIF ==! */
        WHERE A.NIF = C.NIF(+)
        AND A.NIF = D.NIF(+)
        AND C.DEL_YN(+) = 'N' /** Suppression On !== 삭제여부 ==! */
        AND D.DEL_YN(+) = 'N' /** Suppression On !== 삭제여부 ==! */
        AND A.NIF = #{nif} /** NIF !== 납세번호 ==! */
        <if test='aeoAthrNo != null and !"".equals(aeoAthrNo)'>
            AND A.AEO_ATHR_NO = #{aeoAthrNo} /** Numéro d'OEA !== AEO공인번호 ==! */
        </if>
    </select>
    <!--
    [OEA commun] Détails de la demande d'agrément - consulter l'historique des demandes ultérieures  !==[AEO 공통] 공인신청서 상세 - 사후내역 조회==!
    -->
    <select id="selectAeoComAffcBrkd"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComAffcBrkd */
        SELECT A.AEO_AFFC_MGMT_RQST_NO /** Numéro de demande de gestion ultérieure d'OEA !== AEO사후관리신청번호 ==! */
        , A.MGMT_RQST_TP_CD /** Code de classification de gestion ultérieure d'OEA !== 사후관리신청구분코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0007', A.MGMT_RQST_TP_CD, #{langCd}) AS MGMT_RQST_TP_NM /** Code de classification de
        gestion ultérieure d'OEA !== 사후관리신청구분코드 ==! */
        , TO_CHAR(A.RQST_DTTM, 'DD/MM/YYYY') AS rqstDttm /** Date Et Heure De La Demande !== 신청일시 ==! */
        , A.AFFC_MGMT_RQST_RSN_CN /** Motif de demande de gestion ultérieure d'OEA !== 사후관리신청사유내용 ==! */
        FROM TB_AEOI_AFFC_RQST A /** AEOI_DEMANDE ULTÉRIEURE !== AEOI_사후신청 ==! */
        WHERE A.AEO_AFFC_MGMT_RQST_NO = #{aeoAffcMgmtRqstNo}
    </select>

    <!--
    Consulter les détails des opérateurs agréés(TB_AEOI_ATHR_CO) !== 공인업체정보조회(TB_AEOI_ATHR_CO) ==!
    -->
    <select id="selectAeoComAthrCoInfo"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComAthrCoInfo */
        SELECT AEO_ATHR_NO /** Numéro d'OEA !== AEO공인번호 ==! */
        , NIF /** Numéro d’identification fiscale !== 납세식별번호 ==! */
        , CO_CD /** Code De La Compagnie !== 업체코드 ==! */
        , TO_CHAR(TO_DATE(ATHR_STRT_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_STRT_DT /** Date de commencement d'agrément
        !== 공인시작일자 ==! */
        , TO_CHAR(TO_DATE(ATHR_END_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_END_DT /** Date de fermeture d'agrément !==
        공인종료일자 ==! */
        , AEO_ATHR_GD_CD /** Code de classement d'OEA !== AEO공인등급코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0005', AEO_ATHR_GD_CD, #{langCd}) AS AEO_ATHR_GD_NM /** Code de classement d'OEA !==
        AEO공인등급코드 ==! */
        , ATHR_STTS_CD /** Code d'état d'agrément !== 공인상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0006', ATHR_STTS_CD, #{langCd}) AS ATHR_STTS_NM /** Code d'état d'agrément !== 공인상태코드
        ==! */
        FROM TB_AEOI_ATHR_CO /** AEOI_OPÉRATEURS AGRÉÉS !== AEOI_공인업체 ==! */
        WHERE AEO_ATHR_NO = #{aeoAthrNo}
        AND NIF = #{nif}
    </select>

    <!--
    Consulter les détails des opérateurs agréés(TB_COM_CO) !== 공인업체정보조회(TB_COM_CO) ==!
    -->
    <select id="selectAeoComAthrCoInfoCom"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComAthrCoInfoCom */
        SELECT
        NIF /** Numéro d’identification fiscale !== 납세식별번호 ==! */
        , CO_NM /** Nom De L'Entreprise !== 업체명 ==! */
        , RPRS_TLPH_NO /** N° De Téléphone Principale !== 대표전화번호 ==! */
        , RPRS_FAX_NO /** N° De Fax Principal !== 대표팩스번호 ==! */
        , RPRS_EML /** Email Principal !== 대표이메일 ==! */
        , CO_ADDR AS HOFC_ADDR /** Adresse De L'Entreprise !== 업체주소 ==! */
        FROM TB_COM_CO /** COM_ENTREPRISE !== COM_업체 ==! */
        WHERE DEL_YN = 'N'
        AND NIF = #{nif}
    </select>

    <!--
    Consulter les détails des opérateurs agréés(TB_POTE_NIF) !== 공인업체정보조회(TB_POTE_NIF) ==!
    -->
    <select id="selectAeoComAthrCoInfoPot"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComAthrCoInfoPot */
        SELECT
        NIF /** Numéro d’identification fiscale !== 납세식별번호 ==! */
        , CONM AS CO_NM /** Nom De L'Entreprise !== 상호 ==! */
        , CO_DTL_ADDR AS HOFC_ADDR /** Adresse détaillée de l'entreprise !== 업체상세주소 ==! */
        FROM ALPASSEXT.TB_POTE_NIF /** POTE_NIF !== POTE_NIF ==! */
        WHERE DEL_YN = 'N'
        AND NIF = #{nif}
    </select>

    <!--
    [OEA commun] Détails de la demande d'agrément (gestion ultérieure) - Consulter les informations sur l'opérateur !==[AEO 공통] 공인신청서 상세 - 업체정보 조회(사후관리)==!
    -->
    <select id="selectAeoComPsmgtAthrCoInfo"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComPsmgtAthrCoInfo */
        SELECT 'PSM' AS ATHR_RQST_TP_CD /** Code de type de demande d'agrément !== 공인신청구분코드 ==! */
        , A.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , A.AUDT_PT_CD /** Code De Type De Contrôle !== 심사유형코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0002', A.AUDT_PT_CD, #{langCd}) AS AUDT_PT_NM
        , A.AEO_QLFC_CD /** Code du titre OEA !== AEO자격코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0003', A.AEO_QLFC_CD, #{langCd}) AS AEO_QLFC_NM
        , C.PRCS_STTS_CD /** Code De Statut De Traitement !== 처리상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0016', C.PRCS_STTS_CD, #{langCd}) AS PRCS_STTS_NM /** Code De Statut De Traitement !==
        처리상태코드 ==! */
        , C.DTL_PRCS_STTS_CD /** Code d'état détaillé du traitement !== 상세처리상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0018', C.DTL_PRCS_STTS_CD, #{langCd}) AS DTL_PRCS_STTS_NM /** Code d'état détaillé du
        traitement !== 상세처리상태코드 ==! */
        , A.CO_CD /** Code De La Compagnie !== 업체코드 ==! */
        , A.CO_NM /** Nom De L'Entreprise !== 업체명 ==! */
        , TO_CHAR(TO_DATE(A.ESTB_DT), 'DD/MM/YYYY') AS ESTB_DT /** Date de constitution !== 설립일자 ==! */
        , A.ESTB_PLC_NM /** Lieu de constitution !== 설립장소명 ==! */
        , A.RPRS_TLPH_NO /** N° De Téléphone Principale !== 대표전화번호 ==! */
        , A.RPRS_FAX_NO /** N° De Fax Principal !== 대표팩스번호 ==! */
        , A.RPRS_EML /** Email Principal !== 대표이메일 ==! */
        , A.NIF /** NIF !== 납세번호 ==! */
        , A.LAW_QLFC_NM /** Statut juridique !== 법자격명 ==! */
        , A.HOFC_ADDR /** Adresse du siège social !== 본사주소 ==! */
        , A.ACAP_CSTM_CD /** Code douanier de réception !== 접수세관코드 ==! */
        , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.ACAP_CSTM_CD)) AS ACAP_CSTM_NM /** Code
        douanier de réception !== 접수세관코드 ==! */
        , A.CAPL_AMT /** Montant du capital !== 자본금액 ==! */
        , A.SUMR_CN /** Résumé !== 요약내용 ==! */
        , TO_CHAR(C.RQST_DTTM, 'DD/MM/YYYY') AS rqstDttm /** Date Et Heure De La Demande !== 신청일시 ==! */
        , TO_CHAR(A.ACAP_DTTM, 'DD/MM/YYYY') AS acapDttm /** Date De Réception !== 접수일시 ==! */
        , TO_CHAR(A.ISS_DTTM, 'DD/MM/YYYY') AS issDttm /** Date de délivrance !== 발급일시 ==! */
        , A.ISS_CSTM_CD /** Code du bureau de douane de délivrance !== 발급세관코드 ==! */
        , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.ISS_CSTM_CD)) AS ISS_CSTM_NM /** Code du bureau
        de douane de délivrance !== 발급세관코드 ==! */
        , A.AEO_ATHR_NO /** Numéro d'OEA !== AEO공인번호 ==! */
        , A.PLN_AUDT_DEPT_CD /** Service des contrôles a posteriori !== 계획심사부서 ==! */
        , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.PLN_AUDT_DEPT_CD)) AS PLN_AUDT_DEPT_NM /**
        Service des contrôles a posteriori !== 계획심사부서 ==! */
        , A.ATHR_BASE_EV_MEAN_CD /** Code de type d'évaluation des critères d'agrément !== 공인기준평가방법코드 ==! */
        , A.FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , A.FRST_RGSR_DTTM /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
        , A.LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , A.LAST_CHG_DTTM /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'CRC' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS CRC_ATCH_FILE_ID /** Copy of commercial register !== 상업등기부등본 사본 ==! */
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'NIC' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS NIC_ATCH_FILE_ID
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'EAC' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS EAC_ATCH_FILE_ID
        , (SELECT ATCH_FILE_ID FROM ALPASSINT.TB_AEOI_RQST_FLFL_ISTM WHERE DEL_YN = 'N' AND FLFL_ISTM_CD = 'QFS' AND
        AEO_ATHR_RQST_NO = A.AEO_ATHR_RQST_NO) AS QFS_ATCH_FILE_ID
        , (SELECT AA.UPR_ORGN_MGMT_CD FROM ALPASSINT.TB_POTI_ORGN AA WHERE AA.DEL_YN ='N' AND AA.ORGN_MGMT_CD=
        A.ACAP_CSTM_CD) AS SCTR_MGMT_CD /** Code Du Secteur !== 섹터관리코드 ==! */
        , C.AEO_AFFC_MGMT_RQST_NO /** Numéro de demande de gestion ultérieure d'OEA !== AEO사후관리신청번호 ==! */
        , C.MGMT_RQST_TP_CD /** Code de classification de gestion ultérieure d'OEA !== 사후관리신청구분코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0007', C.MGMT_RQST_TP_CD, #{langCd}) AS MGMT_RQST_TP_NM /** Code de classification de
        gestion ultérieure d'OEA !== 사후관리신청구분코드 ==! */
        , C.AFFC_MGMT_RQST_RSN_CN /** Motif de demande de gestion ultérieure d'OEA !== 사후관리신청사유내용 ==! */
        , B.AEO_ATHR_GD_CD /** Code de classement d'OEA !== AEO공인등급코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0005', B.AEO_ATHR_GD_CD, #{langCd}) AS AEO_ATHR_GD_NM /** Code de classement d'OEA !==
        AEO공인등급코드 ==! */
        , TO_CHAR(TO_DATE(B.ATHR_STRT_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_STRT_DT /** Date de commencement d'agrément
        !== 공인시작일자 ==! */
        , TO_CHAR(TO_DATE(B.ATHR_END_DT, 'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_END_DT /** Date de fermeture d'agrément !==
        공인종료일자 ==! */
        , B.ATHR_STTS_CD /** Code d'état d'agrément !== 공인상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0006', B.ATHR_STTS_CD, #{langCd}) AS ATHR_STTS_NM /** Code d'état d'agrément !==
        공인상태코드 ==! */
        FROM TB_AEOI_ATHR_RQST A /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        , TB_AEOI_ATHR_CO B /** AEOI_OPÉRATEURS AGRÉÉS !== AEOI_공인업체 ==! */
        , TB_AEOI_AFFC_RQST C /** AEOI_DEMANDE ULTÉRIEURE !== AEOI_사후신청 ==! */
        WHERE
        A.AEO_ATHR_NO = B.AEO_ATHR_NO
        AND B.AEO_ATHR_NO = C.AEO_ATHR_NO
        AND A.DEL_YN = 'N' /** Suppression ON !== 삭제여부 ==! */
        AND C.DEL_YN = 'N' /** Suppression ON !== 삭제여부 ==! */
        <if test='aeoAffcMgmtRqstNo != null and !"".equals(aeoAffcMgmtRqstNo)'>
            AND C.AEO_AFFC_MGMT_RQST_NO = #{aeoAffcMgmtRqstNo} /** Numéro de demande de gestion ultérieure d'OEA !==
            AEO사후관리신청번호 ==! */
        </if>
        <if test='aeoAthrRqstNo != null and !"".equals(aeoAthrRqstNo)'>
            AND A.AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        </if>
    </select>

    <!--
    [Modifier] demandes d'agrément !==공인신청서를 수정한다.==!
    -->
    <update id="updateAeoComAthrApfm"
            parameterType="alpass.ipt.aeo.com.vo.AeoiAthrRqstVo">
        /* updateAeoComAthrApfm */
        UPDATE TB_AEOI_ATHR_RQST /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        SET
        LAST_CHPR_ID = #{lastChprId} /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , LAST_CHG_DTTM = SYSTIMESTAMP /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        <if test='audtPtCd != null and !"".equals(audtPtCd)'>
            , AUDT_PT_CD = #{audtPtCd} /** Code De Type De Contrôle !== 심사유형코드 ==! */
        </if>
        <if test='aeoQlfcCd != null and !"".equals(aeoQlfcCd)'>
            , AEO_QLFC_CD = #{aeoQlfcCd} /** Code du titre OEA !== AEO자격코드 ==! */
        </if>
        <if test='prcsSttsCd != null and !"".equals(prcsSttsCd)'>
            , PRCS_STTS_CD = #{prcsSttsCd} /** Code De Statut De Traitement !== 처리상태코드 ==! */
        </if>
        <if test='dtlPrcsSttsCd != null and !"".equals(dtlPrcsSttsCd)'>
            , DTL_PRCS_STTS_CD = #{dtlPrcsSttsCd} /** Code d'état détaillé du traitement !== 상세처리상태코드 ==! */
        </if>
        <if test='coCd != null and !"".equals(coCd)'>
            , CO_CD = #{coCd} /** Code De La Compagnie !== 업체코드 ==! */
        </if>
        <if test='coNm != null and !"".equals(coNm)'>
            , CO_NM = #{coNm} /** Nom De L'Entreprise !== 업체명 ==! */
        </if>
        <if test='estbDt != null and !"".equals(estbDt)'>
            , ESTB_DT = TO_CHAR(TO_DATE(REPLACE(#{estbDt}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD') /** Date de constitution
            !== 설립일자 ==! */
        </if>
        <if test='estbPlcNm != null and !"".equals(estbPlcNm)'>
            , ESTB_PLC_NM = #{estbPlcNm} /** Lieu de constitution !== 설립장소명 ==! */
        </if>
        <if test='rprsTlphNo != null and !"".equals(rprsTlphNo)'>
            , RPRS_TLPH_NO = #{rprsTlphNo} /** N° De Téléphone Principale !== 대표전화번호 ==! */
        </if>
        <if test='rprsFaxNo != null and !"".equals(rprsFaxNo)'>
            , RPRS_FAX_NO = #{rprsFaxNo} /** N° De Fax Principal !== 대표팩스번호 ==! */
        </if>
        <if test='rprsEml != null and !"".equals(rprsEml)'>
            , RPRS_EML = #{rprsEml} /** Email Principal !== 대표이메일 ==! */
        </if>
        <if test='nif != null and !"".equals(nif)'>
            , NIF = #{nif} /** NIF !== 납세번호 ==! */
        </if>
        <if test='lawQlfcNm != null and !"".equals(lawQlfcNm)'>
            , LAW_QLFC_NM = #{lawQlfcNm} /** Statut juridique !== 법자격명 ==! */
        </if>
        <if test='hofcAddr != null and !"".equals(hofcAddr)'>
            , HOFC_ADDR = #{hofcAddr} /** Adresse du siège social !== 본사주소 ==! */
        </if>
        <if test='acapCstmCd != null and !"".equals(acapCstmCd)'>
            , ACAP_CSTM_CD = #{acapCstmCd} /** Code douanier de réception !== 접수세관코드 ==! */
        </if>
        <if test='caplAmt != null and !"".equals(caplAmt)'>
            , CAPL_AMT = #{caplAmt} /** Montant du capital !== 자본금액 ==! */
        </if>
        <if test='sumrCn != null and !"".equals(sumrCn)'>
            , SUMR_CN = #{sumrCn} /** Résumé !== 요약내용 ==! */
        </if>
        <if test='rqstDttm != null and !"".equals(rqstDttm)'>
            , RQST_DTTM = SYSTIMESTAMP /** Date Et Heure De La Demande !== 신청일시 ==! */
        </if>
        <if test='acapDttm != null and !"".equals(acapDttm)'>
            , ACAP_DTTM = SYSTIMESTAMP /** Date De Réception !== 접수일시 ==! */
        </if>
        <if test='issDttm != null and !"".equals(issDttm)'>
            , ISS_DTTM = SYSTIMESTAMP /** Date de délivrance !== 발급일시 ==! */
        </if>
        <if test='issCstmCd != null and !"".equals(issCstmCd)'>
            , ISS_CSTM_CD = #{issCstmCd} /** Code du bureau de douane de délivrance !== 발급세관코드 ==! */
        </if>
        <if test='aeoAthrNo != null and !"".equals(aeoAthrNo)'>
            , AEO_ATHR_NO = #{aeoAthrNo} /** Numéro d'OEA !== AEO공인번호 ==! */
        </if>
        <if test='plnAudtDeptCd != null and !"".equals(plnAudtDeptCd)'>
            , PLN_AUDT_DEPT_CD = #{plnAudtDeptCd} /** Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        </if>
        <if test='audtDt != null and !"".equals(audtDt)'>
            , AUDT_DT = TO_CHAR(TO_DATE(REPLACE(#{audtDt}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD') /** Date De Contrôle !==
            심사일자 ==! */
        </if>
        WHERE
        DEL_YN = 'N' /** Suppression ON !== 삭제여부 ==! */
        AND AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
    </update>

    <!--
    [Demande d'agrément] Modifier le statut !==[공인신청] 처리상태 수정==!
    -->
    <update id="updateAeoComAthrApfmPrcsStts"
            parameterType="alpass.ipt.aeo.com.vo.AeoiAthrRqstVo">
        /* updateAeoComAthrApfmPrcsStts */
        UPDATE TB_AEOI_ATHR_RQST /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        SET
        LAST_CHPR_ID = #{lastChprId} /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , LAST_CHG_DTTM = SYSTIMESTAMP /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        , PRCS_STTS_CD = #{prcsSttsCd} /** Code De Statut De Traitement !== 처리상태코드 ==! */
        , DTL_PRCS_STTS_CD = #{dtlPrcsSttsCd} /** Code d'état détaillé du traitement !== 상세처리상태코드 ==! */
        <if test='acapDttm != null and "Y".equals(acapDttm)'>
            , ACAP_DTTM = SYSTIMESTAMP /** Date De Réception !== 접수일시 ==! */
        </if>
        <if test='issDttm != null and "Y".equals(issDttm)'>
            , ISS_DTTM = SYSTIMESTAMP /** Date de délivrance !== 발급일시 ==! */
        </if>
        <if test='issCstmCd != null and !"".equals(issCstmCd)'>
            , ISS_CSTM_CD = #{issCstmCd} /** Code du bureau de douane de délivrance !== 발급세관코드 ==! */
        </if>
        <if test='aeoAthrNo != null and !"".equals(aeoAthrNo)'>
            , AEO_ATHR_NO = #{aeoAthrNo} /** Numéro d'OEA !== AEO공인번호 ==! */
        </if>
        <if test='audtDt != null and !"".equals(audtDt)'>
            , AUDT_DT = TO_CHAR(TO_DATE(REPLACE(#{audtDt}, '/', ''), 'DDMMYYYY'), 'YYYYMMDD') /** Date De Contrôle !==
            심사일자 ==! */
        </if>
        WHERE
        DEL_YN = 'N' /** Suppression ON !== 삭제여부 ==! */
        AND AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
    </update>

    <!--
    [OEA commun] Détails de la demande d'agrément - Consulter la liste des lieux des activités !==[AEO 공통] 공인신청서 상세 - 사업장소재지 목록 조회==!
    -->
    <select id="selectAeoComCoPobsList"
            parameterType="alpass.ipt.aeo.com.vo.AeoComCoPobsVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComCoPobsVo">
        /* selectAeoComCoPobsList */
        SELECT
        A.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , A.POBS_SRNO /** Numéro de série des lieux d’activité !== 사업장일련번호 ==! */
        , A.POBS_ADDR /** Adresse de local !== 사업장주소 ==! */
        , A.JRSD_CSTM_CD /** Code de bureau compétent !== 관할세관코드 ==! */
        , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.JRSD_CSTM_CD)) AS JRSD_CSTM_NM /** Code de
        bureau compétent !== 관할세관코드 ==! */
        , A.PLN_AUDT_DEPT_CD /** Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        , (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_MGMT_CD = UPPER(A.PLN_AUDT_DEPT_CD)) AS PLN_AUDT_DEPT_NM /**
        Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        , A.DEL_YN /** Suppression On !== 삭제여부 ==! */
        , A.FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM
        , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS frstRgsrDttm /** Date Et Heure De Premier Enregistrement
        !== 최초등록일시 ==! */
        , A.LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM /** Id Du Modificateur Final
        !== 최종변경자ID ==! */
        , TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS lastChgDttm /** Date Et Heure De Modification Finale !==
        최종변경일시 ==! */
        FROM
        TB_AEOI_RQST_CO_POBS A /** AEOI_LIEUX D’ACTIVITÉ D'OPÉRATEUR DEMANDEUR D'AGRÉMENT !== AEOI_공인신청업체사업장 ==! */
        WHERE
        A.DEL_YN = 'N' /** Suppression On !== 삭제여부 ==! */
        AND A.AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        <if test='pobsSrno != null and !"".equals(pobsSrno)'>
            AND A.POBS_SRNO = #{pobsSrno} /** Numéro de série des lieux d’activité !== 사업장일련번호 ==! */
        </if>
    </select>

    <!--
    [Enregistrer] Lieu d'activité !==사업장소재지를 저장한다.==!
    -->
    <insert id="insertAeoComCoPobs"
            parameterType="alpass.ipt.aeo.com.vo.AeoiRqstCoPobsVo">
        /* insertAeoComCoPobs */
        WITH UPSERT AS (
        UPDATE TB_AEOI_RQST_CO_POBS /** AEOI_LIEUX D’ACTIVITÉ D'OPÉRATEUR DEMANDEUR D'AGRÉMENT !== AEOI_공인신청업체사업장 ==! */
        SET
        LAST_CHPR_ID = #{lastChprId} /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , LAST_CHG_DTTM = SYSTIMESTAMP /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        <if test='pobsAddr != null and !"".equals(pobsAddr)'>
            , POBS_ADDR = #{pobsAddr} /** Adresse de local !== 사업장주소 ==! */
        </if>
        <if test='jrsdCstmCd != null and !"".equals(jrsdCstmCd)'>
            , JRSD_CSTM_CD = #{jrsdCstmCd} /** Code de bureau compétent !== 관할세관코드 ==! */
        </if>
        <if test='plnAudtDeptCd != null and !"".equals(plnAudtDeptCd)'>
            , PLN_AUDT_DEPT_CD = #{plnAudtDeptCd} /** Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        </if>
        WHERE
        DEL_YN = 'N'
        AND AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        AND POBS_SRNO = #{pobsSrno} /** Numéro de série du programme d'audit !== 심사계획일련번호 ==! */
        RETURNING *
        )
        INSERT INTO TB_AEOI_RQST_CO_POBS ( /** AEOI_LIEUX D’ACTIVITÉ D'OPÉRATEUR DEMANDEUR D'AGRÉMENT !== AEOI_공인신청업체사업장
        ==! */
        AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , POBS_SRNO /** Numéro de série des lieux d’activité !== 사업장일련번호 ==! */
        , POBS_ADDR /** Adresse de local !== 사업장주소 ==! */
        , JRSD_CSTM_CD /** Code de bureau compétent !== 관할세관코드 ==! */
        , PLN_AUDT_DEPT_CD /** Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        , DEL_YN /** Suppression On !== 삭제여부 ==! */
        , FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , FRST_RGSR_DTTM /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
        , LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , LAST_CHG_DTTM /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        )
        SELECT
        #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , #{pobsSrno} /** Numéro de série des lieux d’activité !== 사업장일련번호 ==! */
        , #{pobsAddr} /** Adresse de local !== 사업장주소 ==! */
        , #{jrsdCstmCd} /** Code de bureau compétent !== 관할세관코드 ==! */
        , #{plnAudtDeptCd} /** Service des contrôles a posteriori !== 계획심사부서코드 ==! */
        , 'N' /** Suppression On !== 삭제여부 ==! */
        , #{frstRegstId} /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , CURRENT_TIMESTAMP /** Date Et Heure De Premier Enregistrement !== 최초등록일시 ==! */
        , #{lastChprId} /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , CURRENT_TIMESTAMP /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        WHERE NOT EXISTS (SELECT * FROM UPSERT)
    </insert>

    <!--
    [Auditeur] Consulter la liste !== [심사자] 목록조회 ==!
    -->
    <select id="selectAeoComAdorList"
            parameterType="alpass.ipt.aeo.com.vo.AeoiAthrRqstVo"
            resultType="alpass.ipt.aeo.com.vo.AeoiAdorVo">
        /* selectAeoComAdorList */
        SELECT
        A.AEO_RQST_NO /** Numéro de demande du statut OEA !== AEO신청번호 ==! */
        , A.ADOR_TP_CD /** Code de classification d'auditeur !== 심사자구분코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0008', A.ADOR_TP_CD, #{langCd}) AS ADOR_TP_CD_NM /** Code de classification d'auditeur
        !== 심사자구분코드 ==! */
        , A.ADOR_ID /** Id De L'Inspecteur !== 심사자ID ==! */
        , A.ADOR_NM /** Nom de l'inspecteur !== 심사자명 ==! */
        , A.CSTM_CD /** Code Du Bureau !== 세관코드 ==! */
        , A.CSTM_NM /** Nom Du Bureau !== 세관명 ==! */
        , A.SCTR_MGMT_CD /** Code Du Secteur !== 섹터관리코드 ==! */
        , A.SCTR_CD_NM /** Nom Du Code De Secteur !== 섹터코드명 ==! */
        , A.DEPT_CD /** Code de service !== 부서코드 ==! */
        , A.DEPT_NM /** Nom Du Bureau !== 부서명 ==! */
        , A.HNOT_RSN_CD /** Code motif de répartition !== 배부사유코드 ==! */
        , A.HNOT_CN /** Contenu de diffusion !== 배부내용 ==! */
        , A.DEL_YN /** Suppression On !== 삭제여부 ==! */
        , A.FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM
        , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS frstRgsrDttm /** Date Et Heure De Premier Enregistrement
        !== 최초등록일시 ==! */
        , A.LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM /** Id Du Modificateur Final
        !== 최종변경자ID ==! */
        , TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS lastChgDttm /** Date Et Heure De Modification Finale !==
        최종변경일시 ==! */
        , (SELECT DECODE(COUNT(ADOR_ID), 0, 'N', 'Y')
        FROM TB_AEOI_ADOR
        WHERE AEO_RQST_NO = #{aeoAthrRqstNo}
        AND ADOR_TP_CD = 'CAO'
        AND DEL_YN = 'N') AS CNFC_AUDT_YN /** Objet d'audit en collaboration ou non !== 협의심사여부 ==! */
        , (SELECT DECODE(COUNT(ADOR_ID), 0, 'N', 'Y')
        FROM TB_AEOI_ADOR
        WHERE AEO_RQST_NO = #{aeoAthrRqstNo}
        AND ADOR_TP_CD = 'CAO'
        AND ADOR_ID = #{lastChprId}
        AND DEL_YN = 'N') AS CNFC_ADOR_YN /** Présence d'auditeur en collaboration ou non !== 협의심사자여부 ==! */
        FROM
        TB_AEOI_ADOR A /** AEOI_AUDITEUR !== AEOI_심사자 ==! */
        WHERE
        A.DEL_YN = 'N' /** Suppression On !== 삭제여부 ==! */
        <choose>
            <when test='(aeoRqstNo != null and !"".equals(aeoRqstNo))'>
                AND A.AEO_RQST_NO = #{aeoRqstNo} /** Numéro de demande du statut OEA !== AEO신청번호 ==! */
            </when>
            <when test='(aeoAthrRqstNo != null and !"".equals(aeoAthrRqstNo))'>
                AND A.AEO_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO신청번호 ==! */
            </when>
        </choose>
    </select>

    <!--
    [Plan d'audit ] Consulter la liste !== [심사계획] 목록조회 ==!
    -->
    <select id="selectAeoComAudtPlnList"
            parameterType="alpass.ipt.aeo.com.vo.AeoiAthrRqstVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAudtPlnVo">
        /* selectAeoComAudtPlnList */
        SELECT
        A.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , A.AUDT_PLN_NO /** Numéro de série du programme d'audit !== 심사계획일련번호 ==! */
        , TO_CHAR(TO_DATE(A.AUDT_STRT_DT, 'yyyyMMdd'), 'DD/MM/YYYY') AS AUDT_STRT_DT /** Début Du Contrôle !== 심사시작일자
        ==! */
        , TO_CHAR(TO_DATE(A.AUDT_END_DT, 'yyyyMMdd'), 'DD/MM/YYYY') AS AUDT_END_DT /** Date de fermeture d'audit !==
        심사종료일자 ==! */
        , A.AUDT_PLN_CN /** Contenu du programme d'audit !== 심사계획내용 ==! */
        , A.PRID_XTNS_YN /** Prolongation du délai O/N !== 기간연장여부 ==! */
        , A.ATCH_FILE_ID /** Id Du Fichier Joint !== 첨부파일ID ==! */
        , A.DEL_YN /** Suppression On !== 삭제여부 ==! */
        , A.FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM
        , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS frstRgsrDttm /** Date Et Heure De Premier Enregistrement
        !== 최초등록일시 ==! */
        , A.LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM
        , TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS lastChgDttm /** Date Et Heure De Modification Finale !==
        최종변경일시 ==! */
        , TO_CHAR(TO_DATE(A.AUDT_STRT_DT, 'yyyyMMdd'), 'DD/MM/YYYY') || ' ~ ' || TO_CHAR(TO_DATE(A.AUDT_END_DT,
        'yyyyMMdd'), 'DD/MM/YYYY') AS AUDT_PRID /** Période de contrôle !== 심사기간 ==! */
        FROM
        TB_AEOI_AUDT_PLN A /** AEOI_PROGRAMME D'AUDIT !== AEOI_심사계획 ==! */
        WHERE
        A.DEL_YN = 'N' /** Suppression On !== 삭제여부 ==! */
        AND A.AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
    </select>

    <!--
    [Déléguer l’opération d’audit à un expert] Consulter la liste !== [전문가심사위임요청] 목록조회 ==!
    -->
    <select id="selectAeoComXtrnSpltList"
            parameterType="alpass.ipt.aeo.com.vo.AeoiAthrRqstVo"
            resultType="alpass.ipt.aeo.com.vo.AeoiXtrnSpltVo">
        /* selectAeoComXtrnSpltList */
        SELECT
        A.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , A.XPRT_NIF /** Numéro d’identification fiscale De L'Expert !== 전문가납세식별번호 ==! */
        , A.XPRT_NM /** Nom de l'expert !== 전문가명 ==! */
        , A.BLNG_ITT_CD /** Code D'Organisme !== 소속기관코드 ==! */
        , A.BLNG_ITT_NM /** Nom du groupe d'appartenance !== 소속기관명 ==! */
        , A.MNDA_CN /** Delegation !== 위임내용 ==! */
        , A.DEL_YN /** Suppression On !== 삭제여부 ==! */
        , A.FRST_REGST_ID /** Id Du Premier Enregistrant !== 최초등록자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.FRST_REGST_ID) AS FRST_REGST_NM
        , TO_CHAR(A.FRST_RGSR_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS frstRgsrDttm /** Date Et Heure De Premier Enregistrement
        !== 최초등록일시 ==! */
        , A.LAST_CHPR_ID /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , (SELECT EMP_NM FROM TB_POTI_EMP WHERE PBSR_NO = A.LAST_CHPR_ID) AS LAST_CHPR_NM
        , TO_CHAR(A.LAST_CHG_DTTM, 'DD/MM/YYYY hh24:mi:ss') AS lastChgDttm /** Date Et Heure De Modification Finale !==
        최종변경일시 ==! */
        FROM
        TB_AEOI_XTRN_SPLT A /** AEOI_EXPERT EXTÉRIEUR !== AEOI_외부전문관 ==! */
        WHERE
        A.DEL_YN = 'N' /** Suppression On !== 삭제여부 ==! */
        AND A.AEO_ATHR_RQST_NO = #{aeoAthrRqstNo} /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
    </select>

    <!--
    [l'onglet.Nbr] Consulter !== [탭.건수] 조회 ==!
    -->
    <select id="selectAeoComTabCnt"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo">
        /* selectAeoComTabCnt */
        SELECT
        SUM(T.WRIOP_CNT) AS WRIOP_CNT /** Nombre d'avis !== 의견서 건수 ==! */
        , SUM(T.SPLM_DMDC_CNT) AS SPLM_DMDC_CNT /** Nombre de demandes de complément !== 보완요구서 건수 ==! */
        , SUM(T.AUDT_RSLT_CNT) AS AUDT_RSLT_CNT /** Nombre de résultats d'audit !== 심사결과 건수 ==! */
        , SUM(T.OBJT_RQST_CNT) AS OBJT_RQST_CNT /** Nombre de demande de recours !== 이의신청 건수 ==! */
        , SUM(T.INVG_BRKD_CNT) AS INVG_BRKD_CNT /** Nombre d'enquêtes !== 조사내역 건수 ==! */
        FROM (
        SELECT
        A.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , (SELECT COUNT(TAW.WRIOP_NO) FROM TB_AEOI_WRIOP TAW WHERE TAW.DEL_YN = 'N' AND A.AEO_ATHR_RQST_NO =
        TAW.AEO_RQST_NO) AS WRIOP_CNT
        , (SELECT COUNT(TASQD.SPLM_QRY_NO) FROM TB_AEOI_SPLM_QRT_DOC TASQD WHERE TASQD.DEL_YN = 'N' AND
        A.AEO_ATHR_RQST_NO = TASQD.AEO_ATHR_RQST_NO) AS SPLM_DMDC_CNT
        , (SELECT COUNT(TAAR.AUDT_RSLT_NO) FROM TB_AEOI_AUDT_RSLT TAAR WHERE TAAR.DEL_YN = 'N' AND A.AEO_ATHR_RQST_NO =
        TAAR.AEO_RQST_NO) AS AUDT_RSLT_CNT
        , (SELECT COUNT(TAOR.OBJT_RQST_ACAP_NO) FROM TB_AEOI_OBJT_RQST TAOR WHERE TAOR.DEL_YN = 'N' AND
        A.AEO_ATHR_RQST_NO = TAOR.AEO_ATHR_RQST_NO) AS OBJT_RQST_CNT
        , (SELECT COUNT(TAIB.INVG_MGMT_NO) FROM TB_AEOI_INVG_BRKD TAIB WHERE TAIB.DEL_YN = 'N' AND A.AEO_ATHR_RQST_NO =
        TAIB.AEO_RQST_NO) AS INVG_BRKD_CNT
        FROM
        TB_AEOI_ATHR_RQST A /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        WHERE
        A.DEL_YN = 'N' /** Suppression ON !== 삭제여부 ==! */
        <choose>
            <when test="aeoRqstNoList.size != 0">
                AND A.AEO_ATHR_RQST_NO IN /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
                <foreach collection="aeoRqstNoList" item="item" index="index" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </when>
        </choose>

        UNION ALL

        SELECT
        B.AEO_AFFC_MGMT_RQST_NO AS AEO_RQST_NO /** Motif de demande de gestion ultérieure d'OEA !== 사후관리신청사유내용 ==! */
        , (SELECT COUNT(TAW.WRIOP_NO) FROM TB_AEOI_WRIOP TAW WHERE TAW.DEL_YN = 'N' AND B.AEO_AFFC_MGMT_RQST_NO =
        TAW.AEO_RQST_NO) AS WRIOP_CNT
        , (SELECT COUNT(TASQD.SPLM_QRY_NO) FROM TB_AEOI_SPLM_QRT_DOC TASQD WHERE TASQD.DEL_YN = 'N' AND
        B.AEO_AFFC_MGMT_RQST_NO = TASQD.AEO_ATHR_RQST_NO) AS SPLM_DMDC_CNT
        , (SELECT COUNT(TAAR.AUDT_RSLT_NO) FROM TB_AEOI_AUDT_RSLT TAAR WHERE TAAR.DEL_YN = 'N' AND
        B.AEO_AFFC_MGMT_RQST_NO = TAAR.AEO_RQST_NO) AS AUDT_RSLT_CNT
        , (SELECT COUNT(TAOR.OBJT_RQST_ACAP_NO) FROM TB_AEOI_OBJT_RQST TAOR WHERE TAOR.DEL_YN = 'N' AND
        B.AEO_AFFC_MGMT_RQST_NO = TAOR.AEO_ATHR_RQST_NO) AS OBJT_RQST_CNT
        , (SELECT COUNT(TAIB.INVG_MGMT_NO) FROM TB_AEOI_INVG_BRKD TAIB WHERE TAIB.DEL_YN = 'N' AND
        B.AEO_AFFC_MGMT_RQST_NO = TAIB.AEO_RQST_NO) AS INVG_BRKD_CNT
        FROM
        TB_AEOI_AFFC_RQST B /** AEOI_DEMANDE ULTÉRIEURE !== AEOI_사후신청 ==! */
        WHERE
        B.DEL_YN = 'N' /** Suppression ON !== 삭제여부 ==! */
        <choose>
            <when test="aeoRqstNoList.size != 0">
                AND B.AEO_AFFC_MGMT_RQST_NO IN /** Motif de demande de gestion ultérieure d'OEA !== 사후관리신청사유내용 ==! */
                <foreach collection="aeoRqstNoList" item="item" index="index" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </when>
        </choose>
        ) T
    </select>

    <!--
    [OEA commun] Consulter le nombre de documents traités !==[AEO 공통] 문서처리정보 건수 조회==!
    -->
    <select id="selectDocPrcsInfoCnt"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmVo"
            resultType="int">
        /* selectDocPrcsInfoCnt */
        SELECT COUNT(1)
        FROM TB_AEOI_DOC_PRCS_INFO A /** AEOI_INFORMATIONS SUR LES STATUTS DES DOSSIERS !== AEOI_문서처리정보 ==! */
        WHERE A.DEL_YN = 'N'
        AND A.ATHR_RQST_TP_CD = #{athrRqstTpCd}
        AND A.PRCS_STTS_CD = #{prcsSttsCd}
        AND A.DTL_PRCS_STTS_CD = #{dtlPrcsSttsCd}
        AND A.ATHR_DOC_TP_CD = #{athrDocTpCd}
        <choose>
            <when test="roleList.size != 0">
                AND A.ROLE_ID IN
                <foreach collection="roleList" item="item" index="index" separator="," open="(" close=")">
                    #{item}
                </foreach>
            </when>
        </choose>

    </select>

    <!--
    [Demande d'agrément] Demander une enquête !==[공인신청] 조사의뢰==!
    -->
    <update id="updateAeoComApfmInvgReqst"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmCoInfoVo">
        /* updateAeoComApfmInvgReqst */
        UPDATE TB_AEOI_ATHR_RQST /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        SET PRCS_STTS_CD = 'D29'
        , DTL_PRCS_STTS_CD = 'U79'
        , LAST_CHPR_ID = #{lastChprId} /** Id Du Modificateur Final !== 최종변경자ID ==! */
        , LAST_CHG_DTTM = CURRENT_TIMESTAMP /** Date Et Heure De Modification Finale !== 최종변경일시 ==! */
        WHERE DEL_YN = 'N'
        AND AEO_ATHR_RQST_NO = #{aeoAthrRqstNo}
    </update>

    <!--
    [OEA commun] Historique des enquêtes autorisées FR pop-up !==[AEO 공통] 공인이력팝업조회 ==!
    -->
    <select id="selectAeoAthrHistPpupList"
            parameterType="alpass.ipt.aeo.com.vo.AeoComAthrApfmCoInfoVo"
            resultType="alpass.ipt.aeo.com.vo.AeoComAthrHistVo">
        /* selectAeoAthrHistPpupList */
        SELECT '' AS AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , '' AS AUDT_PT_CD /** Code De Type De Contrôle !== 심사유형코드 ==! */
        , '' AS AUDT_PT_NM /** Code De Type De Contrôle !== 심사유형코드 ==! */
        , NULL AS RQST_DTTM /** ate Et Heure De La Demande !== 신청일시 ==! */
        , AEO_ATHR_NO /** Numéro d'OEA !== AEO공인번호 ==! */
        , TO_CHAR(TO_DATE(ATHR_STRT_DT,'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_STRT_DT /** Date de commencement d'agrément
        !== 공인시작일자 ==! */
        , TO_CHAR(TO_DATE(ATHR_END_DT,'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_END_DT /** Date de fermeture d'agrément !==
        공인종료일자 ==! */
        , ATHR_STTS_CD /** Code d'état d'agrément !== 공인상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0006', ATHR_STTS_CD, #{langCd}) AS ATHR_STTS_NM /** Code d'état d'agrément !== 공인상태코드
        ==! */
        FROM TB_AEOI_ATHR_CO /** AEOI_OPÉRATEURS AGRÉÉS !== AEOI_공인업체 ==! */
        WHERE NIF = #{nif}
        AND NEW_SYS_YN = 'N'
        UNION
        SELECT B.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , B.AUDT_PT_CD /** Code De Type De Contrôle !== 심사유형코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0002', B.AUDT_PT_CD, #{langCd}) AS AUDT_PT_NM /** Code De Type De Contrôle !== 심사유형코드
        ==! */
        , TO_CHAR(B.RQST_DTTM, 'DD/MM/YYYY') AS RQST_DTTM /** ate Et Heure De La Demande !== 신청일시 ==! */
        , A.AEO_ATHR_NO /** Numéro d'OEA !== AEO공인번호 ==! */
        , TO_CHAR(TO_DATE(ATHR_STRT_DT,'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_STRT_DT /** Date de commencement d'agrément
        !== 공인시작일자 ==! */
        , TO_CHAR(TO_DATE(ATHR_END_DT,'YYYYMMDD'), 'DD/MM/YYYY') AS ATHR_END_DT /** Date de fermeture d'agrément !==
        공인종료일자 ==! */
        , A.ATHR_STTS_CD /** Code d'état d'agrément !== 공인상태코드 ==! */
        , FN_GET_CD_VDVAL_NM('AEO_0006', A.ATHR_STTS_CD, #{langCd}) AS ATHR_STTS_NM /** Code d'état d'agrément !==
        공인상태코드 ==! */
        FROM TB_AEOI_ATHR_CO A /** AEOI_OPÉRATEURS AGRÉÉS !== AEOI_공인업체 ==! */
        , TB_AEOI_ATHR_RQST B /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        WHERE A.NIF = #{nif}
        AND A.NEW_SYS_YN = 'Y'
        AND A.AEO_ATHR_NO = B.AEO_ATHR_NO(+)
    </select>


    <!--
    [OEA commun] Consulter la fenêtre pop-up de recherche d'employés de l'OEA !==[AEO 공통] AEO직원팝업조회 ==!
    -->
    <select id="selectAeoEmpInqtList" parameterType="alpass.ipt.aeo.com.vo.AeoEmpInfoVo"
            resultType="alpass.ipt.aeo.com.vo.AeoEmpInfoVo">
        /* selectAeoEmpInqtList */
        <include refid="pagination.header"/>
        SELECT
        A.PBSR_NO, /** Matricule Solde !== 공무원번호 ==! */
        A.ORGN_MGMT_CD, /** Code De Gestion De L'Organisation !== 조직관리코드 ==! */
        B.ORGN_CD, /** Code De L'Organisme !== 조직코드 ==! */
        (SELECT ORGN_NM FROM TB_POTI_ORGN WHERE ORGN_CD = B.ORGN_CD) ORGN_NM, /** Nom D'Organisme !== 조직명 ==! */
        A.EMP_NM, /** Nom De L'Employé !== 직원명 ==! */
        A.FONC_CD, /** code de fonction !== 직무코드 ==! */
        (SELECT FONC_CD_NM FROM TB_POTI_FONC_CD_LANG WHERE FONC_CD = A.FONC_CD AND LANG_CD = #{langCd} AND DEL_YN = 'N')
        AS FONC_NM, /** code de fonction !== 직무코드 ==! */
        TO_CHAR(TO_DATE(A.BRDY, 'YYYYMMDD'), 'DD/MM/YYYY') AS BRDY, /** Date De Naissance !== 생년월일 ==! */
        A.GNDR_CD, /** Code De Sexe !== 성별코드 ==! */
        FN_GET_CD_VDVAL_NM('COM_0027', A.GNDR_CD, #{langCd}) AS GNDR_NM /** Code De Sexe !== 성별코드 ==! */
        FROM TB_POTI_EMP A /** POTI_EMPLOYÉ !== POTI_직원 ==! */
        , VW_POTI_ROLE_UNFC B
        , (SELECT A.AEO_ATHR_RQST_NO /** Numéro de demande du statut OEA !== AEO공인신청번호 ==! */
        , A.ACAP_CSTM_CD /** Code douanier de réception !== 접수세관코드 ==! */
        , (SELECT AA.UPR_ORGN_MGMT_CD
        FROM TB_POTI_ORGN AA
        WHERE AA.DEL_YN = 'N'
        AND AA.ORGN_MGMT_CD = A.ACAP_CSTM_CD
        ) AS UPR_ORGN_MGMT_CD /** Code Du Service Supérieur !== 상위조직관리코드 ==! */
        FROM TB_AEOI_ATHR_RQST A /** AEOI_DEMANDE D'AGRÉMENT !== AEOI_공인신청 ==! */
        WHERE A.DEL_YN = 'N'
        AND A.AEO_ATHR_RQST_NO = #{srchAeoAthrRqstNo}
        ) C
        , TB_AEOI_ATHR_AUDT_ORGN D /** ENTITÉ QUI GÈRE LES INFORMATIONS SUR L'ORGANIGRAMME DU SERVICE CHARGÉ DE L'AUDIT
        OEA !== AEOI_공인심사조직 ==! */
        WHERE A.DEL_YN = 'N'
        AND B.PBSR_NO = A.PBSR_NO
        AND B.ROLE_ID IN ('AEO003','AEO011')
        AND D.DEL_YN = 'N'
        AND D.DRD_ORGN_MGMT_CD = C.UPR_ORGN_MGMT_CD
        AND A.CSTM_MGMT_CD = D.AUDT_ORGN_MGMT_CD
        <if test="pbsrNo != null and pbsrNo != ''">
            AND UPPER(A.PBSR_NO) LIKE '%' || UPPER(#{pbsrNo})||'%'
        </if>
        <if test="empNm != null and empNm != ''">
            AND UPPER(A.EMP_NM) LIKE '%' || UPPER(#{empNm})||'%'
        </if>
        ORDER BY A.EMP_NM
        <include refid="pagination.footer"/>
    </select>

</mapper>